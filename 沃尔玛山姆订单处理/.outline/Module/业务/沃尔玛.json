{
  "Md5CheckSum": "b054001647ef8f6b99470672dcdbd981",
  "RootNode": {
    "RefId": null,
    "Name": "Activity",
    "IsActivity": true,
    "SubItems": [
      {
        "RefId": "Flowchart_1",
        "Name": "Root",
        "IsActivity": true,
        "SubItems": [
          {
            "RefId": "ForEach`1_5",
            "Name": "循环操作  - 失败重试一次",
            "IsActivity": true,
            "SubItems": [
              {
                "RefId": "TryCatch_7",
                "Name": "错误捕获 主流程错误捕获",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": null,
                    "Name": "TryCatch.Try",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": "Sequence_56",
                        "Name": "序列",
                        "IsActivity": true,
                        "SubItems": [
                          {
                            "RefId": "Assign_45",
                            "Name": "赋值 - - processSuccess = false",
                            "IsActivity": true,
                            "SubItems": []
                          },
                          {
                            "RefId": "Flowchart_10",
                            "Name": "主流程",
                            "IsActivity": true,
                            "SubItems": [
                              {
                                "RefId": "Flowchart_11",
                                "Name": "流程图 - 初始化",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": "InvokeCSharpCodeActivity_16",
                                    "Name": "执行C#代码 - 流程初始化",
                                    "IsActivity": true,
                                    "SubItems": []
                                  },
                                  {
                                    "RefId": "If_27",
                                    "Name": "条件（If sqlConn 为空，才去配置文件读取）",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": null,
                                        "Name": "If.Then",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "OfficeExcelOpenOrCreateActivity_5",
                                            "Name": "打开 - 配置文件",
                                            "IsActivity": true,
                                            "SubItems": [
                                              {
                                                "RefId": "Sequence_65",
                                                "Name": "序列",
                                                "IsActivity": true,
                                                "SubItems": [
                                                  {
                                                    "RefId": "OfficeExcelReadRangeActivity_5",
                                                    "Name": "读取区域",
                                                    "IsActivity": true,
                                                    "SubItems": []
                                                  },
                                                  {
                                                    "RefId": "Assign_42",
                                                    "Name": "赋值 - sqlConn",
                                                    "IsActivity": true,
                                                    "SubItems": []
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "RefId": "DatabaseConnectActivity_8",
                                    "Name": "连接数据库",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_64",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "QueryTableActivity_27",
                                            "Name": "查询-rpa_accounts",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "QueryTableActivity_28",
                                            "Name": "查询- mail settings",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "QueryTableActivity_29",
                                            "Name": "查询 - excel_to_order_config",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "QueryTableActivity_30",
                                            "Name": "查询- 沃尔玛大仓 shipTo",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "QueryTableActivity_31",
                                            "Name": "查询语句 - 沃尔玛网站订单location",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "QueryTableActivity_32",
                                            "Name": "查询 - 散威化分配比例",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "QueryTableActivity_33",
                                            "Name": "查询语句 - 查询1：N雀巢码",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "InvokeCSharpCodeActivity_20",
                                            "Name": "执行C#代码: 执行CSharp代码-配置转化变量",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "If_29",
                                            "Name": "条件（If 存在错误信息）",
                                            "IsActivity": true,
                                            "SubItems": [
                                              {
                                                "RefId": null,
                                                "Name": "If.Then",
                                                "IsActivity": true,
                                                "SubItems": [
                                                  {
                                                    "RefId": "Throw_8",
                                                    "Name": "抛出异常",
                                                    "IsActivity": true,
                                                    "SubItems": []
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "RefId": "Assign_41",
                                            "Name": "赋值 - WMLocationsList",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "RefId": "FlowDecision_2",
                                "Name": "上传文件解压缩路径存在",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "FlowDecision.True",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Assign_46",
                                        "Name": "赋值 - allOrdersDT",
                                        "IsActivity": true,
                                        "SubItems": []
                                      },
                                      {
                                        "RefId": "Flowchart_13",
                                        "Name": "流程图 - 获取增量数据",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "InvokeCSharpCodeActivity_24",
                                            "Name": "执行C#代码 - 筛选当前location订单-沃尔玛.cs",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "InvokeWorkflow_72",
                                            "Name": "执行流程 : 输出增量订单",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      },
                                      {
                                        "RefId": "InvokeWorkflow_70",
                                        "Name": "调用子流程: 解析HTML文件提取order信息",
                                        "IsActivity": true,
                                        "SubItems": []
                                      },
                                      {
                                        "RefId": "InvokeWorkflow_73",
                                        "Name": "调用子流程: 订单数据表存入数据库",
                                        "IsActivity": true,
                                        "SubItems": []
                                      },
                                      {
                                        "RefId": "If_26",
                                        "Name": "条件（If 增量订单数据表 存在）",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": null,
                                            "Name": "If.Then",
                                            "IsActivity": true,
                                            "SubItems": [
                                              {
                                                "RefId": "Sequence_61",
                                                "Name": "序列",
                                                "IsActivity": true,
                                                "SubItems": [
                                                  {
                                                    "RefId": "Sequence_63",
                                                    "Name": "序列 - 输出到excel",
                                                    "IsActivity": true,
                                                    "SubItems": [
                                                      {
                                                        "RefId": "InvokeCSharpCodeActivity_18",
                                                        "Name": "执行C#代码 只有WM录单",
                                                        "IsActivity": true,
                                                        "SubItems": []
                                                      },
                                                      {
                                                        "RefId": "InvokeWorkflow_62",
                                                        "Name": "调用子流程: 异常订单判断-沃尔玛",
                                                        "IsActivity": true,
                                                        "SubItems": []
                                                      },
                                                      {
                                                        "RefId": "InvokeCSharpCodeActivity_19",
                                                        "Name": "执行C#代码 - 排除不录单订单 - 沃尔玛",
                                                        "IsActivity": true,
                                                        "SubItems": []
                                                      },
                                                      {
                                                        "RefId": "InvokeWorkflow_63",
                                                        "Name": "调用子流程: 输出EX2O模板 - 沃尔玛",
                                                        "IsActivity": true,
                                                        "SubItems": []
                                                      },
                                                      {
                                                        "RefId": "InvokeWorkflow_64",
                                                        "Name": "调用子流程: 订单报表入库",
                                                        "IsActivity": true,
                                                        "SubItems": []
                                                      },
                                                      {
                                                        "RefId": "InvokeWorkflow_65",
                                                        "Name": "执行流程 : 连接数据库_查询订单附件",
                                                        "IsActivity": true,
                                                        "SubItems": []
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "RefId": "InvokeCSharpCodeActivity_14",
                                        "Name": "执行C#代码 - 汇总沃尔玛报表文件",
                                        "IsActivity": true,
                                        "SubItems": []
                                      },
                                      {
                                        "RefId": "InvokeWorkflow_59",
                                        "Name": "执行流程 : 抓取失败订单通知",
                                        "IsActivity": true,
                                        "SubItems": []
                                      },
                                      {
                                        "RefId": "InvokeCSharpCodeActivity_15",
                                        "Name": "执行C#代码 -  汇总待更新exportedOrders",
                                        "IsActivity": true,
                                        "SubItems": []
                                      }
                                    ]
                                  },
                                  {
                                    "RefId": null,
                                    "Name": "FlowDecision.False",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_68",
                                        "Name": "序列 - 登录",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "TryCatch_8",
                                            "Name": "错误捕获 - 登录",
                                            "IsActivity": true,
                                            "SubItems": [
                                              {
                                                "RefId": null,
                                                "Name": "TryCatch.Try",
                                                "IsActivity": true,
                                                "SubItems": [
                                                  {
                                                    "RefId": "InvokeWorkflow_71",
                                                    "Name": "调用子流程: 登录沃尔玛",
                                                    "IsActivity": true,
                                                    "SubItems": []
                                                  }
                                                ]
                                              },
                                              {
                                                "RefId": null,
                                                "Name": "TryCatch.Catches",
                                                "IsActivity": true,
                                                "SubItems": [
                                                  {
                                                    "RefId": "If_34",
                                                    "Name": "条件（If 用户名ID或者密码不正确）",
                                                    "IsActivity": true,
                                                    "SubItems": [
                                                      {
                                                        "RefId": null,
                                                        "Name": "If.Then",
                                                        "IsActivity": true,
                                                        "SubItems": [
                                                          {
                                                            "RefId": "Sequence_69",
                                                            "Name": "序列",
                                                            "IsActivity": true,
                                                            "SubItems": [
                                                              {
                                                                "RefId": "Assign_47",
                                                                "Name": "赋值 - 全局异常信息",
                                                                "IsActivity": true,
                                                                "SubItems": []
                                                              },
                                                              {
                                                                "RefId": "Break_2",
                                                                "Name": "终止循环",
                                                                "IsActivity": true,
                                                                "SubItems": []
                                                              }
                                                            ]
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "RefId": "If_33",
                                            "Name": "条件（If 登录不成功，则抛出异常，结束流程）",
                                            "IsActivity": true,
                                            "SubItems": [
                                              {
                                                "RefId": null,
                                                "Name": "If.Then",
                                                "IsActivity": true,
                                                "SubItems": [
                                                  {
                                                    "RefId": "Throw_10",
                                                    "Name": "抛出异常-沃尔玛登录失败",
                                                    "IsActivity": true,
                                                    "SubItems": []
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "RefId": "InvokeWorkflow_69",
                                        "Name": "执行流程 : 导出订单_读取订单数据",
                                        "IsActivity": true,
                                        "SubItems": []
                                      },
                                      {
                                        "RefId": "Flowchart_12",
                                        "Name": "流程图 - 获取增量数据",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "InvokeCSharpCodeActivity_17",
                                            "Name": "执行C#代码 - 筛选当前location订单-沃尔玛.cs",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "InvokeWorkflow_61",
                                            "Name": "执行流程 : 输出增量订单",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      },
                                      {
                                        "RefId": "InvokeWorkflow_56",
                                        "Name": "调用子流程: 抓取订单并入库",
                                        "IsActivity": true,
                                        "SubItems": []
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "RefId": "DatabaseConnectActivity_7",
                                "Name": "连接数据库 - 测试用",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": "Sequence_62",
                                    "Name": "序列",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "QueryTableActivity_26",
                                        "Name": "查询语句 - 增量订单数据",
                                        "IsActivity": true,
                                        "SubItems": []
                                      },
                                      {
                                        "RefId": "Assign_40",
                                        "Name": "赋值",
                                        "IsActivity": true,
                                        "SubItems": []
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "RefId": "Assign_38",
                            "Name": "赋值 - processSuccess = true",
                            "IsActivity": true,
                            "SubItems": []
                          },
                          {
                            "RefId": "Assign_49",
                            "Name": "赋值 - 全局异常信息",
                            "IsActivity": true,
                            "SubItems": []
                          },
                          {
                            "RefId": "Break_1",
                            "Name": "终止循环",
                            "IsActivity": true,
                            "SubItems": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "RefId": null,
                    "Name": "TryCatch.Catches",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": "Sequence_59",
                        "Name": "序列 - 全局异常",
                        "IsActivity": true,
                        "SubItems": [
                          {
                            "RefId": "Assign_43",
                            "Name": "赋值 - 全局异常信息",
                            "IsActivity": true,
                            "SubItems": []
                          },
                          {
                            "RefId": "LogActivity_5",
                            "Name": "写入日志 - 沃尔玛流程处理异常 ",
                            "IsActivity": true,
                            "SubItems": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "RefId": null,
                    "Name": "TryCatch.Finally",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": "Sequence_58",
                        "Name": "序列 - 文件清理",
                        "IsActivity": true,
                        "SubItems": [
                          {
                            "RefId": "InvokeWorkflow_54",
                            "Name": "调用子流程: 文件清理 - 订单pdf文件夹保留30天",
                            "IsActivity": true,
                            "SubItems": []
                          },
                          {
                            "RefId": "InvokeWorkflow_55",
                            "Name": "调用子流程: 文件清理 - 报表结果文件夹保留30天",
                            "IsActivity": true,
                            "SubItems": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "RefId": "FlowDecision_1",
            "Name": "processSuccess 为假",
            "IsActivity": true,
            "SubItems": [
              {
                "RefId": null,
                "Name": "FlowDecision.True",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": "If_30",
                    "Name": "条件（If 不是控制台上传文件）",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": null,
                        "Name": "If.Then",
                        "IsActivity": true,
                        "SubItems": [
                          {
                            "RefId": "InvokeWorkflow_66",
                            "Name": "调用子流程: 当前网页截屏",
                            "IsActivity": true,
                            "SubItems": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "RefId": "InvokeWorkflow_53",
                    "Name": "调用子流程 - 发送邮件 - 沃尔玛",
                    "IsActivity": true,
                    "SubItems": []
                  }
                ]
              },
              {
                "RefId": null,
                "Name": "FlowDecision.False",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": "LogActivity_6",
                    "Name": "写入日志 - 沃尔玛处理成功",
                    "IsActivity": true,
                    "SubItems": []
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}