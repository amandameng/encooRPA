{
  "Md5CheckSum": "74db5644bddcc67b19a040013dc94992",
  "RootNode": {
    "RefId": null,
    "Name": "Activity",
    "IsActivity": true,
    "SubItems": [
      {
        "RefId": "Flowchart_11",
        "Name": "流程图 - 增量订单",
        "IsActivity": true,
        "SubItems": [
          {
            "RefId": "CommentActivity_1",
            "Name": "注释掉",
            "IsActivity": true,
            "SubItems": [
              {
                "RefId": "OfficeExcelOpenOrCreateActivity_2",
                "Name": "打开 excelFile",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": "Sequence_4",
                    "Name": "序列",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": "OfficeExcelGetAllSheetsActivity_1",
                        "Name": "获取所有工作表名",
                        "IsActivity": true,
                        "SubItems": []
                      },
                      {
                        "RefId": "OfficeExcelGetLastRowIndexActivity_1",
                        "Name": "获取末行号 - File Name列",
                        "IsActivity": true,
                        "SubItems": []
                      },
                      {
                        "RefId": "OfficeExcelGetLastColIndexActivity_1",
                        "Name": "获取末列号",
                        "IsActivity": true,
                        "SubItems": []
                      },
                      {
                        "RefId": "OfficeExcelReadRangeActivity_1",
                        "Name": "读取区域 - validOrdersDT",
                        "IsActivity": true,
                        "SubItems": []
                      },
                      {
                        "RefId": "Assign_4",
                        "Name": "赋值 - curOrdersDT 去除document link 和 file name",
                        "IsActivity": true,
                        "SubItems": []
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "RefId": "InvokeWorkflow_48",
            "Name": "调用子流程: 根据数据表拼接数据库SQL语句",
            "IsActivity": true,
            "SubItems": []
          },
          {
            "RefId": "If_29",
            "Name": "条件 If str_SQL 不为空",
            "IsActivity": true,
            "SubItems": [
              {
                "RefId": null,
                "Name": "If.Then",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": "DatabaseConnectActivity_1",
                    "Name": "连接数据库",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": "ExecuteTransactionActivity_1",
                        "Name": "执行事务",
                        "IsActivity": true,
                        "SubItems": [
                          {
                            "RefId": "Sequence_1",
                            "Name": "序列",
                            "IsActivity": true,
                            "SubItems": [
                              {
                                "RefId": "QueryTableActivity_1",
                                "Name": "查询语句 - total exportedCount",
                                "IsActivity": true,
                                "SubItems": []
                              },
                              {
                                "RefId": "Assign_1",
                                "Name": "赋值 - existingCount",
                                "IsActivity": true,
                                "SubItems": []
                              },
                              {
                                "RefId": "If_30",
                                "Name": "条件（If existingCount == 0）",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "If.Then",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_2",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "ExecuteSqlActivity_1",
                                            "Name": "执行语句 - 插入初始订单",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "RefId": null,
                                    "Name": "If.Else",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_3",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "Assign_3",
                                            "Name": "赋值 - tmp_str_SQL",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "ExecuteSqlActivity_2",
                                            "Name": "执行语句 - 清空临时导出表",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "ExecuteSqlActivity_3",
                                            "Name": "执行语句 - 插入全部订单进Tmp表",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "RefId": "Assign_2",
                                "Name": "赋值 - newOrdersSql",
                                "IsActivity": true,
                                "SubItems": []
                              },
                              {
                                "RefId": "LogActivity_1",
                                "Name": "写入日志 - newOrdersSql",
                                "IsActivity": true,
                                "SubItems": []
                              },
                              {
                                "RefId": "QueryTableActivity_2",
                                "Name": "查询语句 - exported Orders增量订单数据",
                                "IsActivity": true,
                                "SubItems": []
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "RefId": "DataTableSaveToCSVActivity_1",
            "Name": "保存为CSV文件",
            "IsActivity": true,
            "SubItems": []
          }
        ]
      }
    ]
  }
}