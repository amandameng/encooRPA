{
  "Md5CheckSum": "67e645e5aa0a116544b162f9aa78591a",
  "RootNode": {
    "RefId": null,
    "Name": "Activity",
    "IsActivity": true,
    "SubItems": [
      {
        "RefId": "Flowchart_1",
        "Name": "Root",
        "IsActivity": true,
        "SubItems": [
          {
            "RefId": "InvokeWorkflow_6",
            "Name": "调用子流程: 初始化环境",
            "IsActivity": true,
            "SubItems": []
          },
          {
            "RefId": "InvokeCSharpCodeActivity_3",
            "Name": "执行C#代码 - 参数有效性判断",
            "IsActivity": true,
            "SubItems": []
          },
          {
            "RefId": "TryCatch_1",
            "Name": "错误捕获 - 控制台获取数据库连接",
            "IsActivity": true,
            "SubItems": [
              {
                "RefId": null,
                "Name": "TryCatch.Try",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": "Sequence_41",
                    "Name": "序列",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": "AcquireAssetsActivity_1",
                        "Name": "获取资产 - sqlConn",
                        "IsActivity": true,
                        "SubItems": []
                      }
                    ]
                  }
                ]
              },
              {
                "RefId": null,
                "Name": "TryCatch.Catches",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": "Sequence_28",
                    "Name": "序列",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": "Assign_1",
                        "Name": "赋值 sqlConn = \"\"",
                        "IsActivity": true,
                        "SubItems": []
                      },
                      {
                        "RefId": "If_29",
                        "Name": "条件（If sqlConn 为空，才去配置文件读取）",
                        "IsActivity": true,
                        "SubItems": [
                          {
                            "RefId": null,
                            "Name": "If.Then",
                            "IsActivity": true,
                            "SubItems": [
                              {
                                "RefId": "OfficeExcelOpenOrCreateActivity_2",
                                "Name": "打开 - 配置文件",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": "Sequence_30",
                                    "Name": "序列",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "OfficeExcelReadRangeActivity_2",
                                        "Name": "读取区域",
                                        "IsActivity": true,
                                        "SubItems": []
                                      },
                                      {
                                        "RefId": "Assign_9",
                                        "Name": "赋值 - sqlConn",
                                        "IsActivity": true,
                                        "SubItems": []
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "RefId": "TryCatch_4",
            "Name": "错误捕获 - 校验上传文件有效性",
            "IsActivity": true,
            "SubItems": [
              {
                "RefId": null,
                "Name": "TryCatch.Try",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": "If_38",
                    "Name": "条件（If 上传的文件存在）",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": null,
                        "Name": "If.Then",
                        "IsActivity": true,
                        "SubItems": [
                          {
                            "RefId": "Sequence_45",
                            "Name": "序列",
                            "IsActivity": true,
                            "SubItems": [
                              {
                                "RefId": "If_39",
                                "Name": "条件（If 文件来自本地）",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "If.Then",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Assign_13",
                                        "Name": "赋值 - 待处理文件路径",
                                        "IsActivity": true,
                                        "SubItems": []
                                      }
                                    ]
                                  },
                                  {
                                    "RefId": null,
                                    "Name": "If.Else",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "FileDownloadActivity_2",
                                        "Name": "下载文件",
                                        "IsActivity": true,
                                        "SubItems": []
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "RefId": "Assign_12",
                                "Name": "赋值 - 上传文件解压缩路径",
                                "IsActivity": true,
                                "SubItems": []
                              },
                              {
                                "RefId": "If_40",
                                "Name": "条件（If 上传的文件为zip）",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "If.Then",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_46",
                                        "Name": "序列 - 解压+文件类型校验",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "DeCompresseFileActivity_2",
                                            "Name": "解压缩文件",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "InvokeWorkflow_40",
                                            "Name": "调用子流程: 校验上传文件",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "RefId": null,
                                    "Name": "If.Else",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Throw_4",
                                        "Name": "抛出异常 - 非zip文件",
                                        "IsActivity": true,
                                        "SubItems": []
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "RefId": null,
                "Name": "TryCatch.Catches",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": "Sequence_47",
                    "Name": "序列",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": "InvokeWorkflow_41",
                        "Name": "调用子流程: 发送邮件 - to developer",
                        "IsActivity": true,
                        "SubItems": []
                      },
                      {
                        "RefId": "Rethrow_1",
                        "Name": "重新抛出异常",
                        "IsActivity": true,
                        "SubItems": []
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "RefId": "ForEach`1_2",
            "Name": "循环操作 待运行模块",
            "IsActivity": true,
            "SubItems": [
              {
                "RefId": "Sequence_23",
                "Name": "序列",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": "InvokeWorkflow_31",
                    "Name": "调用子流程: 指定模块的流程",
                    "IsActivity": true,
                    "SubItems": []
                  },
                  {
                    "RefId": "BrowserAttach_1",
                    "Name": "绑定浏览器",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": "BrowserNavigate_1",
                        "Name": "当前页跳转 - 登出连接",
                        "IsActivity": true,
                        "SubItems": []
                      }
                    ]
                  },
                  {
                    "RefId": "BrowserClose_3",
                    "Name": "关闭浏览器",
                    "IsActivity": true,
                    "SubItems": []
                  },
                  {
                    "RefId": "AddToCollectionActivity_1",
                    "Name": "添加对象",
                    "IsActivity": true,
                    "SubItems": []
                  }
                ]
              }
            ]
          },
          {
            "RefId": "If_17",
            "Name": "条件（If 沃尔玛山姆报表字典 存在数据）",
            "IsActivity": true,
            "SubItems": [
              {
                "RefId": null,
                "Name": "If.Then",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": "Sequence_22",
                    "Name": "序列",
                    "IsActivity": true,
                    "SubItems": [
                      {
                        "RefId": "Flowchart_3",
                        "Name": "邮件发送报表",
                        "IsActivity": true,
                        "SubItems": [
                          {
                            "RefId": "InvokeCSharpCodeActivity_6",
                            "Name": "执行C#代码 - 整理邮件报表",
                            "IsActivity": true,
                            "SubItems": []
                          },
                          {
                            "RefId": "Sequence_13",
                            "Name": "序列 - 压缩订单pdf附件",
                            "IsActivity": true,
                            "SubItems": [
                              {
                                "RefId": "If_18",
                                "Name": "条件（If 沃尔玛订单附件文件夹 存在，压缩）",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "If.Then",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_25",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "InvokeWorkflow_27",
                                            "Name": "调用子流程: 执行c#-列表去重 - 沃尔玛",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "CompresseFileActivity_7",
                                            "Name": "压缩文件/文件夹",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "RefId": "If_19",
                                "Name": "条件（If 山姆订单附件文件夹 存在，压缩）",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "If.Then",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_26",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "InvokeWorkflow_28",
                                            "Name": "调用子流程: 执行c#-列表去重 - 山姆",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "CompresseFileActivity_8",
                                            "Name": "压缩文件/文件夹",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "RefId": "If_20",
                                "Name": "条件（If 山姆水订单附件文件夹 存在，压缩）",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "If.Then",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_27",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "InvokeWorkflow_29",
                                            "Name": "调用子流程: 执行c#-列表去重-山姆水",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "CompresseFileActivity_9",
                                            "Name": "压缩文件/文件夹",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "RefId": "Sequence_15",
                            "Name": "序列 - 邮件标题，正文模板",
                            "IsActivity": true,
                            "SubItems": [
                              {
                                "RefId": "Assign_5",
                                "Name": "赋值 - 邮件标题",
                                "IsActivity": true,
                                "SubItems": []
                              },
                              {
                                "RefId": "Assign_6",
                                "Name": "赋值 - 邮件正文模板无数据",
                                "IsActivity": true,
                                "SubItems": []
                              },
                              {
                                "RefId": "Assign_7",
                                "Name": "赋值 - 邮件正文模板有数据",
                                "IsActivity": true,
                                "SubItems": []
                              }
                            ]
                          },
                          {
                            "RefId": "Sequence_14",
                            "Name": "序列 - EX2O",
                            "IsActivity": true,
                            "SubItems": [
                              {
                                "RefId": "If_21",
                                "Name": "条件（If EX2O 存在）",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "If.Then",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "InvokeWorkflow_19",
                                        "Name": "调用子流程: 发送邮件 - ex2o有数据",
                                        "IsActivity": true,
                                        "SubItems": []
                                      }
                                    ]
                                  },
                                  {
                                    "RefId": null,
                                    "Name": "If.Else",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "InvokeWorkflow_20",
                                        "Name": "调用子流程: 发送邮件 - ex2o无数据",
                                        "IsActivity": true,
                                        "SubItems": []
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "RefId": "If_33",
                                "Name": "条件（If orderJobHistoryDT）",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "If.Then",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_40",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "InvokeWorkflow_38",
                                            "Name": "调用子流程: 根据数据表拼接数据库SQL语句",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "DatabaseConnectActivity_2",
                                            "Name": "连接数据库",
                                            "IsActivity": true,
                                            "SubItems": [
                                              {
                                                "RefId": "ExecuteSqlActivity_1",
                                                "Name": "执行语句",
                                                "IsActivity": true,
                                                "SubItems": []
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "RefId": "Sequence_16",
                            "Name": "序列 clean Exception",
                            "IsActivity": true,
                            "SubItems": [
                              {
                                "RefId": "If_22",
                                "Name": "条件（If Clean + Exception Order文件存在）",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "If.Then",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_19",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "InvokeWorkflow_23",
                                            "Name": "调用子流程: 发送邮件 - clean + exception order 有数据",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "RefId": null,
                                    "Name": "If.Else",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "InvokeWorkflow_21",
                                        "Name": "调用子流程: 发送邮件 - Clean + Exception order 无数据",
                                        "IsActivity": true,
                                        "SubItems": []
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "RefId": "Sequence_18",
                            "Name": "序列 - 订单附件",
                            "IsActivity": true,
                            "SubItems": [
                              {
                                "RefId": "If_24",
                                "Name": "条件（If  订单pdf附件列表 文件存在）",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "If.Then",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_21",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "InvokeWorkflow_25",
                                            "Name": "调用子流程: 发送邮件 -  订单pdf附件列表",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "RefId": "Flowchart_4",
                            "Name": "分仓明细表报表邮件",
                            "IsActivity": true,
                            "SubItems": [
                              {
                                "RefId": "TryCatch_3",
                                "Name": "错误捕获 - 连接数据库查询分仓明细",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "TryCatch.Try",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_37",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "Retry_1",
                                            "Name": "重试 - 查询分仓明细数据 ",
                                            "IsActivity": true,
                                            "SubItems": [
                                              {
                                                "RefId": "DatabaseConnectActivity_1",
                                                "Name": "连接数据库 - 查询分仓明细数据",
                                                "IsActivity": true,
                                                "SubItems": [
                                                  {
                                                    "RefId": "Sequence_32",
                                                    "Name": "序列",
                                                    "IsActivity": true,
                                                    "SubItems": [
                                                      {
                                                        "RefId": "LogActivity_3",
                                                        "Name": "写入日志",
                                                        "IsActivity": true,
                                                        "SubItems": []
                                                      },
                                                      {
                                                        "RefId": "QueryTableActivity_1",
                                                        "Name": "查询语句",
                                                        "IsActivity": true,
                                                        "SubItems": []
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "RefId": null,
                                    "Name": "TryCatch.Catches",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_38",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "LogActivity_2",
                                            "Name": "写入日志 - 分仓明细表查询失败",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "Throw_2",
                                            "Name": "抛出异常",
                                            "IsActivity": true,
                                            "SubItems": []
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "RefId": "If_31",
                                "Name": "条件（If 上月1号至今的分仓数据存在）",
                                "IsActivity": true,
                                "SubItems": [
                                  {
                                    "RefId": null,
                                    "Name": "If.Then",
                                    "IsActivity": true,
                                    "SubItems": [
                                      {
                                        "RefId": "Sequence_33",
                                        "Name": "序列",
                                        "IsActivity": true,
                                        "SubItems": [
                                          {
                                            "RefId": "FileCopyMoveActivity_2",
                                            "Name": "复制文件-分仓明细表文件",
                                            "IsActivity": true,
                                            "SubItems": []
                                          },
                                          {
                                            "RefId": "ForEach`1_4",
                                            "Name": "循环操作 - 重试打开分仓明细表",
                                            "IsActivity": true,
                                            "SubItems": [
                                              {
                                                "RefId": "TryCatch_2",
                                                "Name": "错误捕获 - 打开写入分仓明细表数据",
                                                "IsActivity": true,
                                                "SubItems": [
                                                  {
                                                    "RefId": null,
                                                    "Name": "TryCatch.Try",
                                                    "IsActivity": true,
                                                    "SubItems": [
                                                      {
                                                        "RefId": "Sequence_34",
                                                        "Name": "序列",
                                                        "IsActivity": true,
                                                        "SubItems": [
                                                          {
                                                            "RefId": "OfficeExcelOpenOrCreateActivity_4",
                                                            "Name": "打开 - 分仓明细表文件",
                                                            "IsActivity": true,
                                                            "SubItems": [
                                                              {
                                                                "RefId": "OfficeExcelSetRangeActivity_2",
                                                                "Name": "写入区域 - 上月至今分仓明细数据表",
                                                                "IsActivity": true,
                                                                "SubItems": []
                                                              }
                                                            ]
                                                          },
                                                          {
                                                            "RefId": "Break_1",
                                                            "Name": "终止循环",
                                                            "IsActivity": true,
                                                            "SubItems": []
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "RefId": null,
                                                    "Name": "TryCatch.Catches",
                                                    "IsActivity": true,
                                                    "SubItems": [
                                                      {
                                                        "RefId": "Sequence_39",
                                                        "Name": "序列",
                                                        "IsActivity": true,
                                                        "SubItems": [
                                                          {
                                                            "RefId": "LogActivity_1",
                                                            "Name": "写入日志 - 打开分仓明细表失败信息",
                                                            "IsActivity": true,
                                                            "SubItems": []
                                                          },
                                                          {
                                                            "RefId": "InvokeWorkflow_36",
                                                            "Name": "调用子流程: 初始化环境",
                                                            "IsActivity": true,
                                                            "SubItems": []
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "RefId": "Sequence_35",
                                            "Name": "序列 - 分仓明细表文件",
                                            "IsActivity": true,
                                            "SubItems": [
                                              {
                                                "RefId": "If_32",
                                                "Name": "条件（If 分仓明细表文件 文件存在）",
                                                "IsActivity": true,
                                                "SubItems": [
                                                  {
                                                    "RefId": null,
                                                    "Name": "If.Then",
                                                    "IsActivity": true,
                                                    "SubItems": [
                                                      {
                                                        "RefId": "Sequence_36",
                                                        "Name": "序列",
                                                        "IsActivity": true,
                                                        "SubItems": [
                                                          {
                                                            "RefId": "InvokeWorkflow_35",
                                                            "Name": "调用子流程: 发送邮件 -  分仓明细表文件有数据",
                                                            "IsActivity": true,
                                                            "SubItems": []
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "RefId": null,
                                                    "Name": "If.Else",
                                                    "IsActivity": true,
                                                    "SubItems": [
                                                      {
                                                        "RefId": "InvokeWorkflow_34",
                                                        "Name": "调用子流程: 发送邮件 - 分仓明细表文件无数据",
                                                        "IsActivity": true,
                                                        "SubItems": []
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "RefId": "InvokeWorkflow_26",
                        "Name": "调用子流程: 更新exported_Order",
                        "IsActivity": true,
                        "SubItems": []
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "RefId": "If_27",
            "Name": "条件（If 有运行失败的模块）",
            "IsActivity": true,
            "SubItems": [
              {
                "RefId": null,
                "Name": "If.Then",
                "IsActivity": true,
                "SubItems": [
                  {
                    "RefId": "Throw_1",
                    "Name": "抛出异常 - 流程有运行失败的模块",
                    "IsActivity": true,
                    "SubItems": []
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}