<Activity x:Class="Main" sap2010:ExpressionActivityEditor.ExpressionActivityEditor="C#" sap:VirtualizedContainerService.HintSize="778,716" sap2010:WorkflowViewState.IdRef="RehostedWorkflowDesigner.Workflow_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:baac="clr-namespace:BotTime.ActivityLibrary.Activities.CodeTool;assembly=BotTime.ActivityLibrary" xmlns:baasf="clr-namespace:BotTime.ActivityLibrary.Activities.System.File;assembly=BotTime.ActivityLibrary" xmlns:baast="clr-namespace:BotTime.ActivityLibrary.Activities.System.Tool;assembly=BotTime.ActivityLibrary" xmlns:bda="clr-namespace:BotTime.DataTableActivity.Activities;assembly=BotTime.DataTableActivity" xmlns:bdam="clr-namespace:BotTime.DataTableActivity.ActivityDesigners.Models;assembly=BotTime.DataTableActivity" xmlns:bfa="clr-namespace:BotTime.Flow.Activities;assembly=BotTime.Flow.Activities" xmlns:boa="clr-namespace:BotTime.Office.Activity;assembly=BotTime.Office.Activity" xmlns:eb="clr-namespace:Encootech.BotTimeAI;assembly=Encootech.BotTimeAI" xmlns:mca="clr-namespace:Microsoft.CSharp.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="32">
      <x:String>System</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>BotTime.ActivityLibrary.Activities.System.File</x:String>
      <x:String>Microsoft.CSharp.Activities</x:String>
      <x:String>ZipTool</x:String>
      <x:String>System.IO</x:String>
      <x:String>BotTime.ActivityLibrary.Activities.CodeTool</x:String>
      <x:String>BotTime.Flow.Activities</x:String>
      <x:String>System.Data</x:String>
      <x:String>BotTime.DataTableActivity.Activities</x:String>
      <x:String>BotTime.DataTableActivity.ActivityDesigners.Models</x:String>
      <x:String>Encootech.BotTimeAI</x:String>
      <x:String>BotTime.ActivityLibrary.Activities.System.Tool</x:String>
      <x:String>Newtonsoft.Json</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>BotTime.Office.Activity</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>BotTime.ActivityLibrary</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>ZipTool</AssemblyReference>
      <AssemblyReference>BotTime.Flow.Activities</AssemblyReference>
      <AssemblyReference>BotTime.DataTableActivity</AssemblyReference>
      <AssemblyReference>Encootech.BotTimeAI</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>BotTime.Office.Activity</AssemblyReference>
      <AssemblyReference>System.Globalization.Extensions</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>netstandard</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldExpandAll">True</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <Flowchart DisplayName="MainFlow" sap:VirtualizedContainerService.HintSize="738,636" sap2010:WorkflowViewState.IdRef="Flowchart_1">
    <Flowchart.Variables>
      <Variable x:TypeArguments="x:String" Name="发票工作目录" />
      <Variable x:TypeArguments="s:String[]" Name="zipFiles" />
      <Variable x:TypeArguments="x:String" Name="待处理发票文件夹" />
      <Variable x:TypeArguments="scg:List(x:String)" Name="invoiceImages">
        <Variable.Default>
          <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_1">new List&lt;String&gt;{}</mca:CSharpValue>
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="sd:DataTable" Name="invoiceDT" />
      <Variable x:TypeArguments="x:String" Name="APP_KEY" />
      <Variable x:TypeArguments="x:String" Name="logDir" />
      <Variable x:TypeArguments="x:String" Name="logFile" />
      <Variable x:TypeArguments="x:String" Name="机动车购置发票类型" />
      <Variable x:TypeArguments="x:String" Name="二手车发票类型" />
      <Variable x:TypeArguments="x:String" Name="appkeyValidResult" />
      <Variable x:TypeArguments="x:Int32" Name="totalRound" />
      <Variable x:TypeArguments="x:Int32" Default="0" Name="imageIndex" />
      <Variable x:TypeArguments="x:Int32" Default="0" Name="roundIndex" />
      <Variable x:TypeArguments="x:Int32" Name="totalImageCount" />
      <Variable x:TypeArguments="x:Int32" Name="perRoundCount" />
      <Variable x:TypeArguments="x:Int32" Name="LastRoundCount" />
      <Variable x:TypeArguments="x:String" Name="发票结果临时文件" />
      <Variable x:TypeArguments="x:Boolean" Default="False" Name="endWholeProcess" />
      <Variable x:TypeArguments="x:String" Name="result" />
      <Variable x:TypeArguments="x:Boolean" Name="monthDirExist" />
      <Variable x:TypeArguments="x:String" Name="发票已处理" />
      <Variable x:TypeArguments="s:String[]" Name="invoiceFiles" />
      <Variable x:TypeArguments="s:String[]" Name="folderList" />
      <Variable x:TypeArguments="x:String" Name="续处理excel" />
      <Variable x:TypeArguments="x:Object" Name="lastRowIndexObj" />
      <Variable x:TypeArguments="x:String" Name="发票识别结果1" />
    </Flowchart.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
        <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
        <av:Size x:Key="ShapeSize">60,75</av:Size>
        <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,143.5</av:PointCollection>
        <x:Double x:Key="Width">723.5</x:Double>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart.StartNode>
      <x:Reference>__ReferenceID80</x:Reference>
    </Flowchart.StartNode>
    <FlowStep x:Name="__ReferenceID80" sap2010:WorkflowViewState.IdRef="FlowStep_129">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">200,143.5</av:Point>
          <av:Size x:Key="ShapeSize">200,78</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">300,221.5 300,274.38</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Flowchart sap2010:Annotation.AnnotationText="变量初始化 +杀excel" DisplayName="初始化" sap:VirtualizedContainerService.HintSize="200,78" sap2010:WorkflowViewState.IdRef="Flowchart_19">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
            <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
            <av:Size x:Key="ShapeSize">60,75</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,138.5</av:PointCollection>
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Flowchart.StartNode>
          <x:Reference>__ReferenceID2</x:Reference>
        </Flowchart.StartNode>
        <FlowStep x:Name="__ReferenceID0" sap2010:WorkflowViewState.IdRef="FlowStep_127">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">200,263.5</av:Point>
              <av:Size x:Key="ShapeSize">200,53</av:Size>
              <av:PointCollection x:Key="ConnectorLocation">300,316.5 300,366.5</av:PointCollection>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName=" 调用流程 创建日志文件" sap:VirtualizedContainerService.HintSize="349,96" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_3" IsIgnore="False" WorkflowPath="日志文件.xaml">
            <bfa:InvokeWorkflow.Arguments>
              <InArgument x:TypeArguments="x:String" x:Key="logDir">
                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_2">logDir</mca:CSharpValue>
              </InArgument>
              <OutArgument x:TypeArguments="x:String" x:Key="logFile">
                <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_1">logFile</mca:CSharpReference>
              </OutArgument>
            </bfa:InvokeWorkflow.Arguments>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </bfa:InvokeWorkflow>
          <FlowStep.Next>
            <FlowStep x:Name="__ReferenceID1" sap2010:WorkflowViewState.IdRef="FlowStep_126">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">200,366.5</av:Point>
                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <baast:ExecuteCmd Output="{x:Null}" WorkingDirectory="{x:Null}" CommandLine="taskkill /im EXCEL.exe /f" ContinueOnError="Yes" DelayAfter="0" DelayBefore="0" DisplayName="执行命令行" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="ExecuteCmd_1">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </baast:ExecuteCmd>
            </FlowStep>
          </FlowStep.Next>
        </FlowStep>
        <FlowStep x:Name="__ReferenceID2" sap2010:WorkflowViewState.IdRef="FlowStep_128">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">200,138.5</av:Point>
              <av:Size x:Key="ShapeSize">200,83</av:Size>
              <av:PointCollection x:Key="ConnectorLocation">300,221.5 300,263.5</av:PointCollection>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <baac:InvokeCSharpCodeNoVariableActivity sap2010:Annotation.AnnotationText="设置工作目录以及其他常量," CSharpCode="cwB0AHIAaQBuAGcAIADRU2h55WeMmjtg7nZVXyAAPQAgAEAAIgBDADoAXABwZVdbWFTlXVwA0VNoeeVnjJoiADsADQAKAHMAdAByAGkAbgBnACAAeQBlAGEAcgBNAG8AbgB0AGgAIAA9ACAARABhAHQAZQBUAGkAbQBlAC4ATgBvAHcALgBBAGQAZABNAG8AbgB0AGgAcwAoAC0AMQApAC4AVABvAFMAdAByAGkAbgBnACgAIgB5AHkAeQB5AC0ATQBNACIAKQA7AA0ACgDRU2h55V1cT+52VV8gAD0AIABQAGEAdABoAC4AQwBvAG0AYgBpAG4AZQAoANFTaHnlZ4yaO2DudlVfLAAgAHkAZQBhAHIATQBvAG4AdABoACkAOwANAAoAhV8EWQZ00VNoeYdl9k45WSAAPQAgAFAAYQB0AGgALgBDAG8AbQBiAGkAbgBlACgA0VNoeeVdXE/udlVfLAAgACIAhV8EWQZ00VNoeSIAKQA7AA0ACgANAAoAQQBQAFAAXwBLAEUAWQAgAD0AIAAiADkANwA1ADUAMABjAGMAZgAtADcANgA2ADQALQA0ADEAOAA1AC0AOAA1AGIAMgAtADEANQBkADMAZAAzADEANABlAGIAYwBjACIAOwAgAC8ALwAgAFSACFT2lEyI44k+Ze+NL2VMiCAAE04odQ0ACgANAAoAbABvAGcARABpAHIAIAA9ACAAUABhAHQAaAAuAEMAbwBtAGIAaQBuAGUAKADRU2h55V1cT+52VV8sACAAIgBsAG8AZwBzAC8AIgApADsADQAKANFTaHnyXQRZBnQgAD0AIABQAGEAdABoAC4AQwBvAG0AYgBpAG4AZQAoANFTaHnlXVxP7nZVXywAIAAiAPJdBFkGdNFTaHkvACIAKQA7AA0ACgA6Z6hSZo8tjW5/0VNoeXt8i1cgAD0AIAAiADEAMAAxADAANAAiADsADQAKAIxOS2Jmj9FTaHl7fItXIAA9ACAAIgAxADAAMQAwADUAIgA7ACAADQAKAHAAZQByAFIAbwB1AG4AZABDAG8AdQBuAHQAIAA9ACAANQAwADsAIAAvAC8AIADPawBObo/Qj0yI/lZHcnBlz5ENAAoA7X4EWQZ0ZQB4AGMAZQBsACAAPQAgAFAAYQB0AGgALgBDAG8AbQBiAGkAbgBlACgA0VNoeeVdXE/udlVfLAAgACIA7X4EWQZ0LgB4AGwAcwAiACkAOwANAAoA0VNoedN+nGc0TvZlh2X2TiAAPQAgAFAAYQB0AGgALgBDAG8AbQBiAGkAbgBlACgA0VNoeeVdXE/udlVfLAAgACIA0VNoeflblF7Tfpxnh2X2Ti4AeABsAHMAeAAiACkAOwA=" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码" sap:VirtualizedContainerService.HintSize="200,83" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_17">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </baac:InvokeCSharpCodeNoVariableActivity>
          <FlowStep.Next>
            <x:Reference>__ReferenceID0</x:Reference>
          </FlowStep.Next>
        </FlowStep>
        <x:Reference>__ReferenceID1</x:Reference>
      </Flowchart>
      <FlowStep.Next>
        <FlowStep x:Name="__ReferenceID79" sap2010:WorkflowViewState.IdRef="FlowStep_188">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">200,274.38</av:Point>
              <av:Size x:Key="ShapeSize">200,95</av:Size>
              <av:PointCollection x:Key="ConnectorLocation">300,369.38 300,424.5</av:PointCollection>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Flowchart sap2010:Annotation.AnnotationText="文件夹内excel-图片判断，待处理文件夹准备" DisplayName="文件夹内excel-图片判断" sap:VirtualizedContainerService.HintSize="1069,1694" sap2010:WorkflowViewState.IdRef="Flowchart_28">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                <av:Size x:Key="ShapeSize">60,75</av:Size>
                <x:Double x:Key="Width">1055</x:Double>
                <x:Double x:Key="Height">1632.76</x:Double>
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,123.5</av:PointCollection>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Flowchart.StartNode>
              <x:Reference>__ReferenceID27</x:Reference>
            </Flowchart.StartNode>
            <FlowStep x:Name="__ReferenceID6" sap2010:WorkflowViewState.IdRef="FlowStep_174">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">190,1563.5</av:Point>
                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">398.5,1632.76 398.5,1678.76</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Flowchart DisplayName="已处理发票文件夹准备" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="Flowchart_26">
                <Flowchart.Variables>
                  <Variable x:TypeArguments="x:Boolean" Name="dirExist" />
                </Flowchart.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                    <av:Size x:Key="ShapeSize">60,75</av:Size>
                    <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,127.5</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Flowchart.StartNode>
                  <x:Reference>__ReferenceID5</x:Reference>
                </Flowchart.StartNode>
                <FlowStep x:Name="__ReferenceID5" sap2010:WorkflowViewState.IdRef="FlowStep_173">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">200,127.5</av:Point>
                      <av:Size x:Key="ShapeSize">200,53</av:Size>
                      <av:PointCollection x:Key="ConnectorLocation">300,180.5 300,230.5</av:PointCollection>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <baasf:PathExistsActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="发票已处理文件夹是否存在" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="PathExistsActivity_6" InputType="Folder">
                    <baasf:PathExistsActivity.Exists>
                      <OutArgument x:TypeArguments="x:Boolean">
                        <mca:CSharpReference x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpReference`1_62">dirExist</mca:CSharpReference>
                      </OutArgument>
                    </baasf:PathExistsActivity.Exists>
                    <baasf:PathExistsActivity.InputPath>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_200">发票已处理</mca:CSharpValue>
                      </InArgument>
                    </baasf:PathExistsActivity.InputPath>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </baasf:PathExistsActivity>
                  <FlowStep.Next>
                    <FlowDecision x:Name="__ReferenceID3" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_51">
                      <FlowDecision.Condition>
                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_201">dirExist</mca:CSharpValue>
                      </FlowDecision.Condition>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <av:Point x:Key="ShapeLocation">265,230.5</av:Point>
                          <av:Size x:Key="ShapeSize">70,87</av:Size>
                          <av:PointCollection x:Key="FalseConnector">335,274 410,274 410,373.5</av:PointCollection>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <FlowDecision.False>
                        <FlowStep x:Name="__ReferenceID4" sap2010:WorkflowViewState.IdRef="FlowStep_172">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">310,373.5</av:Point>
                              <av:Size x:Key="ShapeSize">200,53</av:Size>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <baasf:CreateActivity ContinueOnError="No" CreationType="Folder" DelayAfter="0" DelayBefore="0" DisplayName="新建 已处理发票 文件夹" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="CreateActivity_3">
                            <baasf:CreateActivity.CreationPath>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_202">发票已处理</mca:CSharpValue>
                              </InArgument>
                            </baasf:CreateActivity.CreationPath>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </baasf:CreateActivity>
                        </FlowStep>
                      </FlowDecision.False>
                    </FlowDecision>
                  </FlowStep.Next>
                </FlowStep>
                <x:Reference>__ReferenceID3</x:Reference>
                <x:Reference>__ReferenceID4</x:Reference>
              </Flowchart>
            </FlowStep>
            <FlowStep x:Name="__ReferenceID25" sap2010:WorkflowViewState.IdRef="FlowStep_175">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">190,1453.5</av:Point>
                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">290,1506.5 290,1563.5</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <boa:OfficeExcelOpenOrCreateActivity OfficeVersion="{x:Null}" Password="{x:Null}" SaveAs="{x:Null}" AutoSave="True" ContinueOnError="No" CreateNewFile="True" DelayAfter="0" DelayBefore="0" DisplayName="新建 发票结果临时文件" EnableMacro="False" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="OfficeExcelOpenOrCreateActivity_8" ReadOnly="False" Visible="False" needRestoreKey="False">
                <boa:OfficeExcelOpenOrCreateActivity.Body>
                  <ActivityAction x:TypeArguments="x:Object">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="x:Object" Name="XlWorkbook" />
                    </ActivityAction.Argument>
                  </ActivityAction>
                </boa:OfficeExcelOpenOrCreateActivity.Body>
                <boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_203">发票结果临时文件</mca:CSharpValue>
                  </InArgument>
                </boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </boa:OfficeExcelOpenOrCreateActivity>
              <FlowStep.Next>
                <x:Reference>__ReferenceID6</x:Reference>
              </FlowStep.Next>
            </FlowStep>
            <FlowStep x:Name="__ReferenceID7" sap2010:WorkflowViewState.IdRef="FlowStep_177">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">190,1263.5</av:Point>
                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">290,1316.5 290,1346.5 420,1346.5 420,1590 390,1590</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <bda:BuildDataTableActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="搭建数据表，存发票临时数据" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="BuildDataTableActivity_4" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;d8c9ac18-8320-4503-9996-110c6539789c&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;d8c9ac18-8320-4503-9996-110c6539789c&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;序号&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;发票代码&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;发票号码&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;开票日期&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;开票金额&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;状态&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;购买者&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;购买者身份证号&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;发票图片&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;">
                <bda:BuildDataTableActivity.Columns>
                  <bdam:DataTableBuildColumn DefaultValue="{x:Null}" x:Key="序号" AllowDBNull="True" AutoIncrement="False" ColumnName="序号" DataType="x:String" MaxLength="0" Unique="False" />
                  <bdam:DataTableBuildColumn DefaultValue="{x:Null}" x:Key="发票代码" AllowDBNull="True" AutoIncrement="False" ColumnName="发票代码" DataType="x:String" MaxLength="0" Unique="False" />
                  <bdam:DataTableBuildColumn DefaultValue="{x:Null}" x:Key="发票号码" AllowDBNull="True" AutoIncrement="False" ColumnName="发票号码" DataType="x:String" MaxLength="0" Unique="False" />
                  <bdam:DataTableBuildColumn DefaultValue="{x:Null}" x:Key="开票日期" AllowDBNull="True" AutoIncrement="False" ColumnName="开票日期" DataType="x:String" MaxLength="0" Unique="False" />
                  <bdam:DataTableBuildColumn DefaultValue="{x:Null}" x:Key="开票金额" AllowDBNull="True" AutoIncrement="False" ColumnName="开票金额" DataType="x:String" MaxLength="0" Unique="False" />
                  <bdam:DataTableBuildColumn DefaultValue="{x:Null}" x:Key="状态" AllowDBNull="True" AutoIncrement="False" ColumnName="状态" DataType="x:String" MaxLength="0" Unique="False" />
                  <bdam:DataTableBuildColumn DefaultValue="{x:Null}" x:Key="购买者" AllowDBNull="True" AutoIncrement="False" ColumnName="购买者" DataType="x:String" MaxLength="0" Unique="False" />
                  <bdam:DataTableBuildColumn DefaultValue="{x:Null}" x:Key="购买者身份证号" AllowDBNull="True" AutoIncrement="False" ColumnName="购买者身份证号" DataType="x:String" MaxLength="0" Unique="False" />
                  <bdam:DataTableBuildColumn DefaultValue="{x:Null}" x:Key="发票图片" AllowDBNull="True" AutoIncrement="False" ColumnName="发票图片" DataType="x:String" MaxLength="0" Unique="False" />
                </bda:BuildDataTableActivity.Columns>
                <bda:BuildDataTableActivity.DataTable>
                  <OutArgument x:TypeArguments="sd:DataTable">
                    <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_63">invoiceDT</mca:CSharpReference>
                  </OutArgument>
                </bda:BuildDataTableActivity.DataTable>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </bda:BuildDataTableActivity>
              <FlowStep.Next>
                <x:Reference>__ReferenceID6</x:Reference>
              </FlowStep.Next>
            </FlowStep>
            <FlowStep x:Name="__ReferenceID8" sap2010:WorkflowViewState.IdRef="FlowStep_178">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">490,1131</av:Point>
                  <av:Size x:Key="ShapeSize">200,78</av:Size>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <baasf:WriteTextFile sap2010:Annotation.AnnotationText="文件夹内里面没有图片" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志文件" sap:VirtualizedContainerService.HintSize="200,78" sap2010:WorkflowViewState.IdRef="WriteTextFile_36" WriteOptions="AppendLine">
                <baasf:WriteTextFile.ContentToWrite>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_206">DateTime.Now.ToString() + "---待处理文件夹里面没有图片：" + 待处理发票文件夹</mca:CSharpValue>
                  </InArgument>
                </baasf:WriteTextFile.ContentToWrite>
                <baasf:WriteTextFile.FilePath>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_205">logFile</mca:CSharpValue>
                  </InArgument>
                </baasf:WriteTextFile.FilePath>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </baasf:WriteTextFile>
            </FlowStep>
            <FlowDecision x:Name="__ReferenceID9" DisplayName="文件夹内存在图片文件" sap:VirtualizedContainerService.HintSize="124,87" sap2010:WorkflowViewState.IdRef="FlowDecision_52">
              <FlowDecision.Condition>
                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_207">totalImageCount &gt; 0</mca:CSharpValue>
              </FlowDecision.Condition>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <av:Point x:Key="ShapeLocation">218,1126.5</av:Point>
                  <av:Size x:Key="ShapeSize">124,87</av:Size>
                  <av:PointCollection x:Key="TrueConnector">218,1170 188,1170 188,1290 190,1290</av:PointCollection>
                  <av:PointCollection x:Key="FalseConnector">342,1170 490,1170</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <FlowDecision.True>
                <x:Reference>__ReferenceID7</x:Reference>
              </FlowDecision.True>
              <FlowDecision.False>
                <x:Reference>__ReferenceID8</x:Reference>
              </FlowDecision.False>
            </FlowDecision>
            <FlowStep x:Name="__ReferenceID10" sap2010:WorkflowViewState.IdRef="FlowStep_179">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">118.5,992.5</av:Point>
                  <av:Size x:Key="ShapeSize">323,55</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">280,1047.5 280,1126.5</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_66" IsIgnore="False">
                <bfa:Assign.To>
                  <OutArgument x:TypeArguments="x:Int32">
                    <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_64">totalRound</mca:CSharpReference>
                  </OutArgument>
                </bfa:Assign.To>
                <bfa:Assign.Value>
                  <InArgument x:TypeArguments="x:Int32">
                    <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_208">(totalImageCount / perRoundCount) + 1</mca:CSharpValue>
                  </InArgument>
                </bfa:Assign.Value>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </bfa:Assign>
              <FlowStep.Next>
                <x:Reference>__ReferenceID9</x:Reference>
              </FlowStep.Next>
            </FlowStep>
            <FlowStep x:Name="__ReferenceID13" sap2010:WorkflowViewState.IdRef="FlowStep_180">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">118.5,902.5</av:Point>
                  <av:Size x:Key="ShapeSize">323,55</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">280,957.5 280,992.5</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_67" IsIgnore="False">
                <bfa:Assign.To>
                  <OutArgument x:TypeArguments="x:Int32">
                    <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_65">totalImageCount</mca:CSharpReference>
                  </OutArgument>
                </bfa:Assign.To>
                <bfa:Assign.Value>
                  <InArgument x:TypeArguments="x:Int32">
                    <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_209">invoiceImages.Count</mca:CSharpValue>
                  </InArgument>
                </bfa:Assign.Value>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </bfa:Assign>
              <FlowStep.Next>
                <x:Reference>__ReferenceID10</x:Reference>
              </FlowStep.Next>
            </FlowStep>
            <FlowStep x:Name="__ReferenceID14" sap2010:WorkflowViewState.IdRef="FlowStep_183">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">180,753.5</av:Point>
                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">280,806.5 280,902.5</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Flowchart DisplayName="获取所有图片类型文件" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="Flowchart_27">
                <Flowchart.Variables>
                  <Variable x:TypeArguments="s:String[]" Name="imgList" />
                  <Variable x:TypeArguments="s:String[]" Name="imageTypes" />
                </Flowchart.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                    <av:Size x:Key="ShapeSize">60,75</av:Size>
                    <x:Double x:Key="Height">766.5</x:Double>
                    <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,142.5</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Flowchart.StartNode>
                  <x:Reference>__ReferenceID12</x:Reference>
                </Flowchart.StartNode>
                <FlowStep x:Name="__ReferenceID12" sap2010:WorkflowViewState.IdRef="FlowStep_182">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">138.5,142.5</av:Point>
                      <av:Size x:Key="ShapeSize">323,55</av:Size>
                      <av:PointCollection x:Key="ConnectorLocation">300,197.5 300,243.5</av:PointCollection>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_68" IsIgnore="False">
                    <bfa:Assign.To>
                      <OutArgument x:TypeArguments="s:String[]">
                        <mca:CSharpReference x:TypeArguments="s:String[]" sap2010:WorkflowViewState.IdRef="CSharpReference`1_66">imageTypes</mca:CSharpReference>
                      </OutArgument>
                    </bfa:Assign.To>
                    <bfa:Assign.Value>
                      <InArgument x:TypeArguments="s:String[]">
                        <mca:CSharpValue x:TypeArguments="s:String[]" sap2010:WorkflowViewState.IdRef="CSharpValue`1_210">new String[]{ "jpg", "jpeg", "png"}</mca:CSharpValue>
                      </InArgument>
                    </bfa:Assign.Value>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </bfa:Assign>
                  <FlowStep.Next>
                    <FlowStep x:Name="__ReferenceID11" sap2010:WorkflowViewState.IdRef="FlowStep_181">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">200,243.5</av:Point>
                          <av:Size x:Key="ShapeSize">200,53</av:Size>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <bfa:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="循环操作 合并所有类型图片" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="ForEach`1_12" IsIgnore="False">
                        <bfa:ForEach.Values>
                          <InArgument x:TypeArguments="s:String[]">
                            <mca:CSharpValue x:TypeArguments="s:String[]" sap2010:WorkflowViewState.IdRef="CSharpValue`1_213">imageTypes</mca:CSharpValue>
                          </InArgument>
                        </bfa:ForEach.Values>
                        <ActivityAction x:TypeArguments="x:String">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="x:String" Name="item" />
                          </ActivityAction.Argument>
                          <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,307" sap2010:WorkflowViewState.IdRef="Sequence_47">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <baasf:GetFileListActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="获取 jpg列表" sap:VirtualizedContainerService.HintSize="349,85" sap2010:WorkflowViewState.IdRef="GetFileListActivity_9" InputType="File">
                              <baasf:GetFileListActivity.GetFileListFilter>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_212">"*." + item</mca:CSharpValue>
                                </InArgument>
                              </baasf:GetFileListActivity.GetFileListFilter>
                              <baasf:GetFileListActivity.InputPath>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_211">待处理发票文件夹</mca:CSharpValue>
                                </InArgument>
                              </baasf:GetFileListActivity.InputPath>
                              <baasf:GetFileListActivity.Result>
                                <OutArgument x:TypeArguments="s:String[]">
                                  <mca:CSharpReference x:TypeArguments="s:String[]" sap2010:WorkflowViewState.IdRef="CSharpReference`1_67">imgList</mca:CSharpReference>
                                </OutArgument>
                              </baasf:GetFileListActivity.Result>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </baasf:GetFileListActivity>
                            <baac:InvokeCSharpCodeNoVariableActivity CSharpCode="aQBuAHYAbwBpAGMAZQBJAG0AYQBnAGUAcwAgAD0AIABpAG4AdgBvAGkAYwBlAEkAbQBhAGcAZQBzAC4AQwBvAG4AYwBhAHQAKABpAG0AZwBMAGkAcwB0ACkALgBUAG8ATABpAHMAdAAoACkAOwA=" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码- concat imgStrArr" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_24" />
                          </Sequence>
                        </ActivityAction>
                      </bfa:ForEach>
                    </FlowStep>
                  </FlowStep.Next>
                </FlowStep>
                <x:Reference>__ReferenceID11</x:Reference>
              </Flowchart>
              <FlowStep.Next>
                <x:Reference>__ReferenceID13</x:Reference>
              </FlowStep.Next>
            </FlowStep>
            <FlowStep x:Name="__ReferenceID15" sap2010:WorkflowViewState.IdRef="FlowStep_184">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">460,613.5</av:Point>
                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">660,640 750,640</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <baast:ConfirmMessageBox ConfirmResult="{x:Null}" Description="{x:Null}" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="确认框" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="ConfirmMessageBox_6">
                <baast:ConfirmMessageBox.Title>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_214">待处理发票文件夹 + " 内不存在excel文件， 请将excel文件跟发票放在同一级目录。"</mca:CSharpValue>
                  </InArgument>
                </baast:ConfirmMessageBox.Title>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </baast:ConfirmMessageBox>
              <FlowStep.Next>
                <FlowStep x:Name="__ReferenceID24" sap2010:WorkflowViewState.IdRef="FlowStep_189">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">750,601</av:Point>
                      <av:Size x:Key="ShapeSize">200,78</av:Size>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <baasf:WriteTextFile sap2010:Annotation.AnnotationText="压缩包里面没有excel文件" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志文件" sap:VirtualizedContainerService.HintSize="200,78" sap2010:WorkflowViewState.IdRef="WriteTextFile_37" WriteOptions="AppendLine">
                    <baasf:WriteTextFile.ContentToWrite>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_221">DateTime.Now.ToString() + "---" + 待处理发票文件夹 + " 内不存在excel文件"</mca:CSharpValue>
                      </InArgument>
                    </baasf:WriteTextFile.ContentToWrite>
                    <baasf:WriteTextFile.FilePath>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_220">logFile</mca:CSharpValue>
                      </InArgument>
                    </baasf:WriteTextFile.FilePath>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </baasf:WriteTextFile>
                </FlowStep>
              </FlowStep.Next>
            </FlowStep>
            <FlowDecision x:Name="__ReferenceID19" DisplayName="excel文件存在" sap:VirtualizedContainerService.HintSize="81,87" sap2010:WorkflowViewState.IdRef="FlowDecision_53">
              <FlowDecision.Condition>
                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_215">invoiceFiles.Length &gt; 0</mca:CSharpValue>
              </FlowDecision.Condition>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <av:Point x:Key="ShapeLocation">249.5,596.5</av:Point>
                  <av:Size x:Key="ShapeSize">81,87</av:Size>
                  <av:PointCollection x:Key="TrueConnector">249.5,640 150,640 150,780 180,780</av:PointCollection>
                  <av:PointCollection x:Key="FalseConnector">330.5,640 460,640</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <FlowDecision.True>
                <x:Reference>__ReferenceID14</x:Reference>
              </FlowDecision.True>
              <FlowDecision.False>
                <x:Reference>__ReferenceID15</x:Reference>
              </FlowDecision.False>
            </FlowDecision>
            <FlowStep x:Name="__ReferenceID27" sap2010:WorkflowViewState.IdRef="FlowStep_187">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">200,123.5</av:Point>
                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">300,176.5 300,246.5</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <baasf:PathExistsActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="月文件夹是否存在" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="PathExistsActivity_7" InputType="Folder">
                <baasf:PathExistsActivity.Exists>
                  <OutArgument x:TypeArguments="x:Boolean">
                    <mca:CSharpReference x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpReference`1_68">monthDirExist</mca:CSharpReference>
                  </OutArgument>
                </baasf:PathExistsActivity.Exists>
                <baasf:PathExistsActivity.InputPath>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_216">发票工作目录</mca:CSharpValue>
                  </InArgument>
                </baasf:PathExistsActivity.InputPath>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </baasf:PathExistsActivity>
              <FlowStep.Next>
                <FlowDecision x:Name="__ReferenceID20" DisplayName="月数据文件夹存在否" sap:VirtualizedContainerService.HintSize="112,87" sap2010:WorkflowViewState.IdRef="FlowDecision_54">
                  <FlowDecision.Condition>
                    <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_217">monthDirExist</mca:CSharpValue>
                  </FlowDecision.Condition>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      <av:Point x:Key="ShapeLocation">244,246.5</av:Point>
                      <av:Size x:Key="ShapeSize">112,87</av:Size>
                      <av:PointCollection x:Key="TrueConnector">244,290 160,290 160,420 190,420</av:PointCollection>
                      <av:PointCollection x:Key="FalseConnector">356,290 460,290</av:PointCollection>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <FlowDecision.True>
                    <FlowStep x:Name="__ReferenceID26" sap2010:WorkflowViewState.IdRef="FlowStep_244">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">190,393.5</av:Point>
                          <av:Size x:Key="ShapeSize">200,53</av:Size>
                          <av:PointCollection x:Key="ConnectorLocation">290,446.5 290,473.5</av:PointCollection>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Flowchart sap:VirtualizedContainerService.HintSize="614,636" sap2010:WorkflowViewState.IdRef="Flowchart_36">
                        <Flowchart.Variables>
                          <Variable x:TypeArguments="x:Boolean" Name="dirExist" />
                        </Flowchart.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                            <av:Size x:Key="ShapeSize">60,75</av:Size>
                            <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,113.5</av:PointCollection>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Flowchart.StartNode>
                          <x:Reference>__ReferenceID18</x:Reference>
                        </Flowchart.StartNode>
                        <FlowStep x:Name="__ReferenceID18" sap2010:WorkflowViewState.IdRef="FlowStep_243">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">200,113.5</av:Point>
                              <av:Size x:Key="ShapeSize">200,53</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">300,166.5 300,216.5</av:PointCollection>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <baasf:PathExistsActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="文件/文件夹是否存在" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="PathExistsActivity_10" InputType="Folder">
                            <baasf:PathExistsActivity.Exists>
                              <OutArgument x:TypeArguments="x:Boolean">
                                <mca:CSharpReference x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpReference`1_110">dirExist</mca:CSharpReference>
                              </OutArgument>
                            </baasf:PathExistsActivity.Exists>
                            <baasf:PathExistsActivity.InputPath>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_331">待处理发票文件夹</mca:CSharpValue>
                              </InArgument>
                            </baasf:PathExistsActivity.InputPath>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </baasf:PathExistsActivity>
                          <FlowStep.Next>
                            <FlowDecision x:Name="__ReferenceID16" DisplayName="dirExist" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_69">
                              <FlowDecision.Condition>
                                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_332">dirExist</mca:CSharpValue>
                              </FlowDecision.Condition>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  <av:Point x:Key="ShapeLocation">265,216.5</av:Point>
                                  <av:Size x:Key="ShapeSize">70,87</av:Size>
                                  <av:PointCollection x:Key="FalseConnector">335,260 365,260 365,260.88 385,260.88</av:PointCollection>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <FlowDecision.False>
                                <FlowStep x:Name="__ReferenceID17" sap2010:WorkflowViewState.IdRef="FlowStep_242">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">385,234.38</av:Point>
                                      <av:Size x:Key="ShapeSize">200,53</av:Size>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <baast:ConfirmMessageBox ConfirmResult="{x:Null}" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="确认框" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="ConfirmMessageBox_8" Title="待处理文件夹不存在">
                                    <baast:ConfirmMessageBox.Description>
                                      <InArgument x:TypeArguments="x:String">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_336">"请创建文件夹：" + 待处理发票文件夹 + "，并将发票excel和发票图片放进此文件夹"</mca:CSharpValue>
                                      </InArgument>
                                    </baast:ConfirmMessageBox.Description>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </baast:ConfirmMessageBox>
                                </FlowStep>
                              </FlowDecision.False>
                            </FlowDecision>
                          </FlowStep.Next>
                        </FlowStep>
                        <x:Reference>__ReferenceID16</x:Reference>
                        <x:Reference>__ReferenceID17</x:Reference>
                      </Flowchart>
                      <FlowStep.Next>
                        <FlowStep x:Name="__ReferenceID22" sap2010:WorkflowViewState.IdRef="FlowStep_185">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">190,473.5</av:Point>
                              <av:Size x:Key="ShapeSize">200,53</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">290,526.5 290,596.5</av:PointCollection>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <baasf:GetFileListActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="获取 excel 文件" GetFileListFilter="*.xls*" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="GetFileListActivity_10" InputType="File">
                            <baasf:GetFileListActivity.InputPath>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_218">待处理发票文件夹</mca:CSharpValue>
                              </InArgument>
                            </baasf:GetFileListActivity.InputPath>
                            <baasf:GetFileListActivity.Result>
                              <OutArgument x:TypeArguments="s:String[]">
                                <mca:CSharpReference x:TypeArguments="s:String[]" sap2010:WorkflowViewState.IdRef="CSharpReference`1_69">invoiceFiles</mca:CSharpReference>
                              </OutArgument>
                            </baasf:GetFileListActivity.Result>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </baasf:GetFileListActivity>
                          <FlowStep.Next>
                            <x:Reference>__ReferenceID19</x:Reference>
                          </FlowStep.Next>
                        </FlowStep>
                      </FlowStep.Next>
                    </FlowStep>
                  </FlowDecision.True>
                  <FlowDecision.False>
                    <FlowStep x:Name="__ReferenceID21" sap2010:WorkflowViewState.IdRef="FlowStep_186">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">460,263.5</av:Point>
                          <av:Size x:Key="ShapeSize">200,53</av:Size>
                          <av:PointCollection x:Key="ConnectorLocation">660,290 730,290</av:PointCollection>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <baast:ConfirmMessageBox ConfirmResult="{x:Null}" ContinueOnError="No" DelayAfter="0" DelayBefore="0" Description="发票zip压缩包需要放在上月文件夹内，文件夹格式为yyyy-mm, 比如这个月是2020年7月，上月文件夹为2020-06" DisplayName="确认框" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="ConfirmMessageBox_7">
                        <baast:ConfirmMessageBox.Title>
                          <InArgument x:TypeArguments="x:String">
                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_219">"上月文件夹" + 发票工作目录 + "内没有压缩包"</mca:CSharpValue>
                          </InArgument>
                        </baast:ConfirmMessageBox.Title>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </baast:ConfirmMessageBox>
                      <FlowStep.Next>
                        <FlowStep x:Name="__ReferenceID23" sap2010:WorkflowViewState.IdRef="FlowStep_190">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">730,251</av:Point>
                              <av:Size x:Key="ShapeSize">200,78</av:Size>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <baasf:WriteTextFile sap2010:Annotation.AnnotationText="月数据文件夹不存在" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志文件" sap:VirtualizedContainerService.HintSize="200,78" sap2010:WorkflowViewState.IdRef="WriteTextFile_38" WriteOptions="AppendLine">
                            <baasf:WriteTextFile.ContentToWrite>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_223" xml:space="preserve">DateTime.Now.ToString() + "---" + "月数据文件夹不存在， 目录为：" +  发票工作目录</mca:CSharpValue>
                              </InArgument>
                            </baasf:WriteTextFile.ContentToWrite>
                            <baasf:WriteTextFile.FilePath>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_222">logFile</mca:CSharpValue>
                              </InArgument>
                            </baasf:WriteTextFile.FilePath>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </baasf:WriteTextFile>
                        </FlowStep>
                      </FlowStep.Next>
                    </FlowStep>
                  </FlowDecision.False>
                </FlowDecision>
              </FlowStep.Next>
            </FlowStep>
            <x:Reference>__ReferenceID20</x:Reference>
            <x:Reference>__ReferenceID21</x:Reference>
            <x:Reference>__ReferenceID22</x:Reference>
            <x:Reference>__ReferenceID23</x:Reference>
            <x:Reference>__ReferenceID24</x:Reference>
            <FlowStep sap2010:WorkflowViewState.IdRef="FlowStep_191">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">190,1354.5</av:Point>
                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">290,1407.5 290,1453.5</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <baasf:FileCopyMoveActivity ActionType="Move" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="复制文件" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="FileCopyMoveActivity_3" Overwrite="True">
                <baasf:FileCopyMoveActivity.DestinationPath>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_225">发票结果临时文件 + DateTime.Now.ToFileTime()</mca:CSharpValue>
                  </InArgument>
                </baasf:FileCopyMoveActivity.DestinationPath>
                <baasf:FileCopyMoveActivity.OriginPath>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_224">发票结果临时文件</mca:CSharpValue>
                  </InArgument>
                </baasf:FileCopyMoveActivity.OriginPath>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </baasf:FileCopyMoveActivity>
              <FlowStep.Next>
                <x:Reference>__ReferenceID25</x:Reference>
              </FlowStep.Next>
            </FlowStep>
            <x:Reference>__ReferenceID26</x:Reference>
          </Flowchart>
          <FlowStep.Next>
            <FlowStep x:Name="__ReferenceID78" sap2010:WorkflowViewState.IdRef="FlowStep_171">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">200,424.5</av:Point>
                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Flowchart DisplayName="主流程-发票处理" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="Flowchart_25">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <av:Point x:Key="ShapeLocation">380,2.5</av:Point>
                    <av:Size x:Key="ShapeSize">60,75</av:Size>
                    <x:Double x:Key="Width">850.14988187168228</x:Double>
                    <av:PointCollection x:Key="ConnectorLocation">410,77.5 410,153.5</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Flowchart.StartNode>
                  <x:Reference>__ReferenceID77</x:Reference>
                </Flowchart.StartNode>
                <FlowStep sap2010:WorkflowViewState.IdRef="FlowStep_156">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">40,162.5</av:Point>
                      <av:Size x:Key="ShapeSize">200,95</av:Size>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <bfa:DoWhile sap2010:Annotation.AnnotationText="分批处理，一批+ perRoundCount + 张图" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="循环分批处理" sap:VirtualizedContainerService.HintSize="200,95" sap2010:WorkflowViewState.IdRef="DoWhile_2" IsIgnore="False">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <bfa:DoWhile.Condition>
                      <InArgument x:TypeArguments="x:Boolean">
                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_134">roundIndex &lt; totalRound</mca:CSharpValue>
                      </InArgument>
                    </bfa:DoWhile.Condition>
                    <Sequence sap:VirtualizedContainerService.HintSize="1346,4074" sap2010:WorkflowViewState.IdRef="Sequence_46">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="x:Int32" Default="0" Name="tmpIndex" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <bda:DataTableClearActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="清空数据表" sap:VirtualizedContainerService.HintSize="1324,22" sap2010:WorkflowViewState.IdRef="DataTableClearActivity_2">
                        <bda:DataTableClearActivity.DataTable>
                          <InArgument x:TypeArguments="sd:DataTable">
                            <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_135">invoiceDT</mca:CSharpValue>
                          </InArgument>
                        </bda:DataTableClearActivity.DataTable>
                      </bda:DataTableClearActivity>
                      <bfa:Assign sap2010:Annotation.AnnotationText="判断每一轮图片数量， 如果是最后一轮的话需要用总图片数 - 轮数 * 每轮默认图片" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="1324,97" sap2010:WorkflowViewState.IdRef="Assign_51" IsIgnore="False">
                        <bfa:Assign.To>
                          <OutArgument x:TypeArguments="x:Int32">
                            <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_45">LastRoundCount</mca:CSharpReference>
                          </OutArgument>
                        </bfa:Assign.To>
                        <bfa:Assign.Value>
                          <InArgument x:TypeArguments="x:Int32">
                            <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_136">roundIndex == totalRound - 1 ? totalImageCount - roundIndex * perRoundCount : perRoundCount</mca:CSharpValue>
                          </InArgument>
                        </bfa:Assign.Value>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </bfa:Assign>
                      <bfa:While ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="循环操作 处理每一轮图片" sap:VirtualizedContainerService.HintSize="1324,2945" sap2010:WorkflowViewState.IdRef="While_2" IsIgnore="False">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <bfa:While.Condition>
                          <InArgument x:TypeArguments="x:Boolean">
                            <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_137">tmpIndex &lt; LastRoundCount</mca:CSharpValue>
                          </InArgument>
                        </bfa:While.Condition>
                        <Sequence sap:VirtualizedContainerService.HintSize="1304,2836" sap2010:WorkflowViewState.IdRef="Sequence_44">
                          <Sequence.Variables>
                            <Variable x:TypeArguments="x:String" Name="item" />
                            <Variable x:TypeArguments="sd:DataRow" Name="invoiceRow" />
                          </Sequence.Variables>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="1282,55" sap2010:WorkflowViewState.IdRef="Assign_52" IsIgnore="False">
                            <bfa:Assign.To>
                              <OutArgument x:TypeArguments="x:String">
                                <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_46">item</mca:CSharpReference>
                              </OutArgument>
                            </bfa:Assign.To>
                            <bfa:Assign.Value>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_138">invoiceImages[imageIndex]</mca:CSharpValue>
                              </InArgument>
                            </bfa:Assign.Value>
                          </bfa:Assign>
                          <bfa:TryCatch ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="错误捕获（Try Catch）" sap:VirtualizedContainerService.HintSize="1282,2427" sap2010:WorkflowViewState.IdRef="TryCatch_18" IsIgnore="False">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <bfa:TryCatch.Try>
                              <Flowchart DisplayName="发票识别验真" sap:VirtualizedContainerService.HintSize="1264,1702" sap2010:WorkflowViewState.IdRef="Flowchart_24">
                                <Flowchart.Variables>
                                  <Variable x:TypeArguments="x:String" Name="发票识别结果" />
                                  <Variable x:TypeArguments="x:String" Name="发票类型" />
                                  <Variable x:TypeArguments="x:String" Name="识别错误信息" />
                                  <Variable x:TypeArguments="x:Boolean" Default="True" Name="识别结果正确" />
                                  <Variable x:TypeArguments="x:String" Name="ValdateStatus">
                                    <Variable.Default>
                                      <Literal x:TypeArguments="x:String" Value="" />
                                    </Variable.Default>
                                  </Variable>
                                  <Variable x:TypeArguments="x:Int32" Default="1" Name="tryTimes" />
                                </Flowchart.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                    <av:Size x:Key="ShapeSize">60,75</av:Size>
                                    <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,127.5</av:PointCollection>
                                    <x:Double x:Key="Width">1250</x:Double>
                                    <x:Double x:Key="Height">1666.5</x:Double>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Flowchart.StartNode>
                                  <x:Reference>__ReferenceID50</x:Reference>
                                </Flowchart.StartNode>
                                <FlowStep x:Name="__ReferenceID28" sap2010:WorkflowViewState.IdRef="FlowStep_146">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">200,223.5</av:Point>
                                      <av:Size x:Key="ShapeSize">200,53</av:Size>
                                      <av:PointCollection x:Key="ConnectorLocation">300,276.5 300,316.5</av:PointCollection>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <bfa:TryCatch ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="错误捕获 发票识别验真" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="TryCatch_16" IsIgnore="False">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <bfa:TryCatch.Try>
                                      <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="316,180" sap2010:WorkflowViewState.IdRef="Sequence_37">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <eb:InvoiceValidateRegActivity DisplayName="发票识别并验真" sap:VirtualizedContainerService.HintSize="294,56" sap2010:WorkflowViewState.IdRef="InvoiceValidateRegActivity_2">
                                          <eb:InvoiceValidateRegActivity.AppKey>
                                            <InArgument x:TypeArguments="x:String">
                                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_140">APP_KEY</mca:CSharpValue>
                                            </InArgument>
                                          </eb:InvoiceValidateRegActivity.AppKey>
                                          <eb:InvoiceValidateRegActivity.ImagePath>
                                            <InArgument x:TypeArguments="x:String">
                                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_139">item</mca:CSharpValue>
                                            </InArgument>
                                          </eb:InvoiceValidateRegActivity.ImagePath>
                                          <eb:InvoiceValidateRegActivity.RegResult>
                                            <OutArgument x:TypeArguments="x:String">
                                              <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_47">发票识别结果</mca:CSharpReference>
                                            </OutArgument>
                                          </eb:InvoiceValidateRegActivity.RegResult>
                                        </eb:InvoiceValidateRegActivity>
                                      </Sequence>
                                    </bfa:TryCatch.Try>
                                    <bfa:TryCatch.Catches>
                                      <bfa:Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="435,437" sap2010:WorkflowViewState.IdRef="Catch`1_16">
                                        <bfa:Catch.Action>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                            <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,366" sap2010:WorkflowViewState.IdRef="Sequence_38">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <baasf:WriteTextFile ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入文件" sap:VirtualizedContainerService.HintSize="349,85" sap2010:WorkflowViewState.IdRef="WriteTextFile_28" WriteOptions="AppendLine">
                                                <baasf:WriteTextFile.ContentToWrite>
                                                  <InArgument x:TypeArguments="x:String">
                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_142">"[出错] 发票识别验真组件," + DateTime.Now.ToString() + "---" + item + "，错误消息：" + exception.Message</mca:CSharpValue>
                                                  </InArgument>
                                                </baasf:WriteTextFile.ContentToWrite>
                                                <baasf:WriteTextFile.FilePath>
                                                  <InArgument x:TypeArguments="x:String">
                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_141">logFile</mca:CSharpValue>
                                                  </InArgument>
                                                </baasf:WriteTextFile.FilePath>
                                              </baasf:WriteTextFile>
                                              <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="349,55" sap2010:WorkflowViewState.IdRef="Assign_53" IsIgnore="False">
                                                <bfa:Assign.To>
                                                  <OutArgument x:TypeArguments="x:Boolean">
                                                    <mca:CSharpReference x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpReference`1_48">endWholeProcess</mca:CSharpReference>
                                                  </OutArgument>
                                                </bfa:Assign.To>
                                                <bfa:Assign.Value>
                                                  <InArgument x:TypeArguments="x:Boolean">
                                                    <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_143">true</mca:CSharpValue>
                                                  </InArgument>
                                                </bfa:Assign.Value>
                                              </bfa:Assign>
                                              <bfa:Break BreakAction="{x:Null}" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="终止循环" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="Break_6" IsIgnore="False" />
                                            </Sequence>
                                          </ActivityAction>
                                        </bfa:Catch.Action>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </bfa:Catch>
                                    </bfa:TryCatch.Catches>
                                  </bfa:TryCatch>
                                  <FlowStep.Next>
                                    <FlowDecision x:Name="__ReferenceID32" DisplayName="发票识别验真请求成功" sap:VirtualizedContainerService.HintSize="124,87" sap2010:WorkflowViewState.IdRef="FlowDecision_46">
                                      <FlowDecision.Condition>
                                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_144">!String.IsNullOrEmpty(发票识别结果)</mca:CSharpValue>
                                      </FlowDecision.Condition>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <av:Point x:Key="ShapeLocation">238,316.5</av:Point>
                                          <av:Size x:Key="ShapeSize">124,87</av:Size>
                                          <av:PointCollection x:Key="TrueConnector">238,360 160,360 160,500 190,500</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <FlowDecision.True>
                                        <FlowStep x:Name="__ReferenceID33" sap2010:WorkflowViewState.IdRef="FlowStep_145">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">190,471</av:Point>
                                              <av:Size x:Key="ShapeSize">200,58</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">290,529 290,576.5</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <baac:InvokeCSharpCodeNoVariableActivity CSharpCode="dAByAHkADQAKAHsADQAKAAkASgBPAGIAagBlAGMAdAAgAGoATwBiAGoAZQBjAHQAIAA9ACAAKABKAE8AYgBqAGUAYwB0ACkASgBzAG8AbgBDAG8AbgB2AGUAcgB0AC4ARABlAHMAZQByAGkAYQBsAGkAegBlAE8AYgBqAGUAYwB0ACgA0VNoecaLK1LTfpxnKQA7AA0ACgAJAEoAVgBhAGwAdQBlACAAcgBlAHMAdQBsAHQAVgBhAGwAdQBlACAAPQAgACgASgBWAGEAbAB1AGUAKQBqAE8AYgBqAGUAYwB0AFsAIgByAGUAcwB1AGwAdAAiAF0AOwANAAoACQBpAGYAKAByAGUAcwB1AGwAdABWAGEAbAB1AGUALgBWAGEAbAB1AGUALgBUAG8AUwB0AHIAaQBuAGcAKAApACAAPQA9ACAAIgAxACIAKQB7AA0ACgAJACAAIAAgACAASgBPAGIAagBlAGMAdAAgAGQAYQB0AGEAIAA9ACAAKABKAE8AYgBqAGUAYwB0ACkAagBPAGIAagBlAGMAdABbACIAcgBlAHMAcABvAG4AcwBlACIAXQBbACIAZABhAHQAYQAiAF0AOwANAAoACQAgACAAIAAgAEoAQQByAHIAYQB5ACAAaQBkAGUAbgB0AGkAZgB5AF8AcgBlAHMAdQBsAHQAcwAgACAAPQAgACgASgBBAHIAcgBhAHkAKQBkAGEAdABhAFsAIgBpAGQAZQBuAHQAaQBmAHkAXwByAGUAcwB1AGwAdABzACIAXQA7AA0ACgAJACAAIAAgACAATABpAHMAdAA8AEoAVABvAGsAZQBuAD4AIABpAHQAZQBtAHMAIAA9ACAAaQBkAGUAbgB0AGkAZgB5AF8AcgBlAHMAdQBsAHQAcwAuAEMAaABpAGwAZAByAGUAbgAoACkALgBUAG8ATABpAHMAdAAoACkAOwANAAoACQAgACAAIAAgAGkAZgAoAGkAdABlAG0AcwAuAEMAbwB1AG4AdAAgAD4AIAAwACkADQAKAAkAIAAgACAAIAB7AA0ACgAJAAkAIAAgACAAIABKAE8AYgBqAGUAYwB0ACAAZgBpAHIAcwB0AEkAdABlAG0AIAA9ACAAKABKAE8AYgBqAGUAYwB0ACkAaQB0AGUAbQBzAFsAMABdADsADQAKAAkACQAgACAAIAAgAEoAVgBhAGwAdQBlACAAaQBuAHYAbwBpAGMAZQBUAHkAcABlACAAPQAgACgASgBWAGEAbAB1AGUAKQBmAGkAcgBzAHQASQB0AGUAbQBbACIAdAB5AHAAZQAiAF0AOwANAAoACQAJACAAIAAgACAA0VNoeXt8i1cgAD0AIABpAG4AdgBvAGkAYwBlAFQAeQBwAGUALgBWAGEAbAB1AGUALgBUAG8AUwB0AHIAaQBuAGcAKAApADsADQAKAAkACQAgACAAIAAgAA0ACgAJAAkAIAAgACAAIABKAE8AYgBqAGUAYwB0ACAAdgBhAGwAaQBkAGEAdABpAG8AbgAgAD0AIAAoAEoATwBiAGoAZQBjAHQAKQBmAGkAcgBzAHQASQB0AGUAbQBbACIAdgBhAGwAaQBkAGEAdABpAG8AbgAiAF0AOwANAAoACQAgACAAIAAgACAAIAAgACAAZgBvAHIAZQBhAGMAaAAgACgASgBQAHIAbwBwAGUAcgB0AHkAIABqAHAAIABpAG4AIAAoAEoAVABvAGsAZQBuACkAdgBhAGwAaQBkAGEAdABpAG8AbgApAA0ACgAJACAAIAAgACAAIAAgACAAIAB7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHMAdAByAGkAbgBnACAAbgBhAG0AZQAgAD0AIABqAHAALgBOAGEAbQBlAC4AVABvAFMAdAByAGkAbgBnACgAKQA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHMAdAByAGkAbgBnACAAdgBhAGwAdQBlACAAPQAgAGoAcAAuAFYAYQBsAHUAZQAuAFQAbwBTAHQAcgBpAG4AZwAoACkAOwANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAGYAIAAoACIAYwBvAGQAZQAiAC4ARQBxAHUAYQBsAHMAKABuAGEAbQBlACkAKQANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAB7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAcwB3AGkAdABjAGgAIAAoAHYAYQBsAHUAZQApAA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAewANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAMQAwADAAMAAwACIAOgANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABWAGEAbABkAGEAdABlAFMAdABhAHQAdQBzACAAPQAgACIAY2s4XiIAOwANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAMQAwADAAMAAxACIAOgANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABWAGEAbABkAGEAdABlAFMAdABhAHQAdQBzACAAPQAgACIA5WfgZWRraHkiADsADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYgByAGUAYQBrADsADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGMAYQBzAGUAIAAiADEAMAAwADAAMgAiADoADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAVgBhAGwAZABhAHQAZQBTAHQAYQB0AHUAcwAgAD0AIAAiAOVnjJrhT29gDU4ATvSBIgA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAcgBlAGEAawA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABjAGEAcwBlACAAIgAxADAAMAAwADMAIgA6AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAFYAYQBsAGQAYQB0AGUAUwB0AGEAdAB1AHMAIAA9ACAAIgCMmh93IWtwZYWNx49QljZSDP8MVABOIF9oeQBOKVkAZxpZ71PlTuVnjJo1ACFrIgA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAcgBlAGEAawA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABjAGEAcwBlACAAIgAxADAAMAAwADQAIgA6AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAFYAYQBsAGQAYQB0AGUAUwB0AGEAdAB1AHMAIAA9ACAAIgANTi9lAWOMmh930VNoeXt8i1ciADsADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYgByAGUAYQBrADsADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGMAYQBzAGUAIAAiADEAMAAwADAANQAiADoADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAVgBhAGwAZABhAHQAZQBTAHQAYQB0AHUAcwAgAD0AIAAiAOBlSGXCU3BlIgA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAcgBlAGEAawA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABjAGEAcwBlACAAIgAxADAAMAAwADYAIgA6AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAFYAYQBsAGQAYQB0AGUAUwB0AGEAdAB1AHMAIAA9ACAAIgB2UYNbGZXviyIAOwANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAfQANAAoACQANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIABDAG8AbgBzAG8AbABlAC4AVwByAGkAdABlAEwAaQBuAGUAKABWAGEAbABkAGEAdABlAFMAdABhAHQAdQBzACkAOwANAAoACQAgACAAIAAgACAAIAAgACAAfQANAAoAIAAgACAAIAAgACAAIAAgAA0ACgAJAAkAIAAgACAAIABKAE8AYgBqAGUAYwB0ACAAZABlAHQAYQBpAGwAcwAgAD0AIAAoAEoATwBiAGoAZQBjAHQAKQBmAGkAcgBzAHQASQB0AGUAbQBbACIAZABlAHQAYQBpAGwAcwAiAF0AOwANAAoACQAJACAAIAAgACAAZgBvAHIAZQBhAGMAaAAgACgASgBQAHIAbwBwAGUAcgB0AHkAIABqAHAAIABpAG4AIAAoAEoAVABvAGsAZQBuACkAZABlAHQAYQBpAGwAcwApAA0ACgAJAAkAIAAgACAAIAAgACAAIAAgAHsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIABzAHQAcgBpAG4AZwAgAG4AYQBtAGUAIAA9ACAAagBwAC4ATgBhAG0AZQAuAFQAbwBTAHQAcgBpAG4AZwAoACkAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHMAdAByAGkAbgBnACAAdgBhAGwAdQBlACAAPQAgAGoAcAAuAFYAYQBsAHUAZQAuAFQAbwBTAHQAcgBpAG4AZwAoACkAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHMAdwBpAHQAYwBoACgAbgBhAG0AZQApAA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAewANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAYwBvAGQAZQAiADoADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAaQBuAHYAbwBpAGMAZQBSAG8AdwBbACIA0VNoeeNOAXgiAF0AIAA9ACAAdgBhAGwAdQBlADsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYgByAGUAYQBrADsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGMAYQBzAGUAIAAiAG4AdQBtAGIAZQByACIAOgANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAG4AdgBvAGkAYwBlAFIAbwB3AFsAIgDRU2h591MBeCIAXQAgAD0AIAB2AGEAbAB1AGUAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAZABhAHQAZQAiADoADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAARABhAHQAZQBUAGkAbQBlACAAdABtAHAARABhAHQAZQA7AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAbwBvAGwAIABpAHMARABhAHQAZQAgAD0AIABEAGEAdABlAFQAaQBtAGUALgBUAHIAeQBQAGEAcgBzAGUAKAB2AGEAbAB1AGUALAAgAG8AdQB0ACAAdABtAHAARABhAHQAZQApADsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAaQBmACAAKABpAHMARABhAHQAZQApAA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAG4AdgBvAGkAYwBlAFIAbwB3AFsAIgAAX2h55WUfZyIAXQAgAD0AIAB0AG0AcABEAGEAdABlAC4AVABvAFMAdAByAGkAbgBnACgAIgB5AHkAeQB5AC0ATQBNAC0AZABkACIAKQA7AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYgByAGUAYQBrADsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGMAYQBzAGUAIAAiAHAAcgBlAHQAYQB4AF8AYQBtAG8AdQBuAHQAIgA6AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAbgB2AG8AaQBjAGUAUgBvAHcAWwAiAABfaHnRkZ2YIgBdACAAPQAgAHYAYQBsAHUAZQA7AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAcgBlAGEAawA7AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABjAGEAcwBlACAAIgBiAHUAeQBlAHIAIgA6AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAbgB2AG8AaQBjAGUAUgBvAHcAWwAiAC2NcE4FgCIAXQAgAD0AIAB2AGEAbAB1AGUAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAYgB1AHkAZQByAF8AaQBkACIAOgANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAG4AdgBvAGkAYwBlAFIAbwB3AFsAIgAtjXBOBYCrjv1OwYv3UyIAXQAgAD0AIAB2AGEAbAB1AGUAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAaQBuAHYAYQBsAGkAZABfAG0AYQByAGsAIgA6AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAZgAoAHYAYQBsAHUAZQAgACEAPQAgACIAMAAiACkADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAewANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAVgBhAGwAZABhAHQAZQBTAHQAYQB0AHUAcwAgAD0AIAAiAFxPn14iADsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAfQANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ADQAKAAkACQAgACAAIAAgACAAIAAgACAAfQANAAoACQAgACAAIAAgAH0ADQAKAAkAfQANAAoACQBlAGwAcwBlAA0ACgAJAHsADQAKAAkAIAAgAMaLK1LTfpxnY2tueCAAIAA9ACAAZgBhAGwAcwBlADsADQAKAAkAIAAgAEoAVgBhAGwAdQBlACAAcgBlAHEAdQBlAHMAdABNAGUAcwBzAGEAZwBlACAAPQAgACgASgBWAGEAbAB1AGUAKQBqAE8AYgBqAGUAYwB0AFsAIgBtAGUAcwBzAGEAZwBlACIAXQA7AA0ACgAJACAAIADGiytSGZXvi+FPb2AgAD0AIAByAGUAcQB1AGUAcwB0AE0AZQBzAHMAYQBnAGUALgBWAGEAbAB1AGUALgBUAG8AUwB0AHIAaQBuAGcAKAApADsADQAKAAkAfQANAAoAfQANAAoAYwBhAHQAYwBoACgARQB4AGMAZQBwAHQAaQBvAG4AIABlACkADQAKAHsADQAKACAAIAAgACAAQwBvAG4AcwBvAGwAZQAuAFcAcgBpAHQAZQBMAGkAbgBlACgAIgBDACMAxH72ToVR6JAM/9FTaHnGiytSBFkGdPpRGZUa/yIAIAArACAAZQAuAE0AZQBzAHMAYQBnAGUAKQA7AA0ACgB9AA==" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 解析识别结果" sap:VirtualizedContainerService.HintSize="200,58" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_20">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </baac:InvokeCSharpCodeNoVariableActivity>
                                          <FlowStep.Next>
                                            <FlowDecision x:Name="__ReferenceID34" DisplayName="&quot;识别结果成功&quot;" sap:VirtualizedContainerService.HintSize="86,87" sap2010:WorkflowViewState.IdRef="FlowDecision_45">
                                              <FlowDecision.Condition>
                                                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_145">识别结果正确</mca:CSharpValue>
                                              </FlowDecision.Condition>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <av:Point x:Key="ShapeLocation">247,576.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">86,87</av:Size>
                                                  <av:PointCollection x:Key="FalseConnector">333,620 470,620</av:PointCollection>
                                                  <av:PointCollection x:Key="TrueConnector">247,620 220,620 220,826.5 430,826.5 430,856.5</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <FlowDecision.True>
                                                <FlowDecision x:Name="__ReferenceID48" DisplayName="其它错误" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_44">
                                                  <FlowDecision.Condition>
                                                    <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_146">ValdateStatus == "其它错误" &amp;&amp; tryTimes &lt;= 3</mca:CSharpValue>
                                                  </FlowDecision.Condition>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <av:Point x:Key="ShapeLocation">395,856.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                      <av:PointCollection x:Key="TrueConnector">395,900 331.5,900</av:PointCollection>
                                                      <av:PointCollection x:Key="FalseConnector">465,900 490,900 490,986.5 400,986.5 400,1016.5</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <FlowDecision.True>
                                                    <FlowStep x:Name="__ReferenceID49" sap2010:WorkflowViewState.IdRef="FlowStep_136">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">8.5,872.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">323,55</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">170,872.5 170,250 200,250</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 如果出现其他错误，则重试3次" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_54" IsIgnore="False">
                                                        <bfa:Assign.To>
                                                          <OutArgument x:TypeArguments="x:Int32">
                                                            <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_49">tryTimes</mca:CSharpReference>
                                                          </OutArgument>
                                                        </bfa:Assign.To>
                                                        <bfa:Assign.Value>
                                                          <InArgument x:TypeArguments="x:Int32">
                                                            <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_147">tryTimes + 1</mca:CSharpValue>
                                                          </InArgument>
                                                        </bfa:Assign.Value>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </bfa:Assign>
                                                      <FlowStep.Next>
                                                        <x:Reference>__ReferenceID28</x:Reference>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                  </FlowDecision.True>
                                                  <FlowDecision.False>
                                                    <FlowDecision x:Name="__ReferenceID36" DisplayName="是机动车购置发票" sap:VirtualizedContainerService.HintSize="100,87" sap2010:WorkflowViewState.IdRef="FlowDecision_43">
                                                      <FlowDecision.Condition>
                                                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_148">发票类型 == 机动车购置发票类型</mca:CSharpValue>
                                                      </FlowDecision.Condition>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <av:Point x:Key="ShapeLocation">350,1016.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">100,87</av:Size>
                                                          <av:PointCollection x:Key="FalseConnector">450,1060 740,1060 740,1076.5</av:PointCollection>
                                                          <av:PointCollection x:Key="TrueConnector">350,1060 238.5,1060 238.5,1190 268.5,1190</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <FlowDecision.True>
                                                        <FlowStep x:Name="__ReferenceID46" sap2010:WorkflowViewState.IdRef="FlowStep_141">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">268.5,1162.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">323,55</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">430,1217.5 430,1247.5 350,1247.5 350,1331</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_55" IsIgnore="False">
                                                            <bfa:Assign.To>
                                                              <OutArgument x:TypeArguments="x:Object">
                                                                <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_50">invoiceRow["状态"]</mca:CSharpReference>
                                                              </OutArgument>
                                                            </bfa:Assign.To>
                                                            <bfa:Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">
                                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_149">ValdateStatus</mca:CSharpValue>
                                                              </InArgument>
                                                            </bfa:Assign.Value>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </bfa:Assign>
                                                          <FlowStep.Next>
                                                            <FlowStep x:Name="__ReferenceID40" sap2010:WorkflowViewState.IdRef="FlowStep_140">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <av:Point x:Key="ShapeLocation">250,1331</av:Point>
                                                                  <av:Size x:Key="ShapeSize">200,78</av:Size>
                                                                  <av:PointCollection x:Key="ConnectorLocation">350,1409 350,1530 378.5,1530</av:PointCollection>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <Flowchart sap2010:Annotation.AnnotationText="必填值有一个没值" DisplayName="影像不清晰判断" sap:VirtualizedContainerService.HintSize="200,78" sap2010:WorkflowViewState.IdRef="Flowchart_22">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                                                    <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                                    <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,126.5</av:PointCollection>
                                                                    <x:Double x:Key="Width">611.5</x:Double>
                                                                    <x:Double x:Key="Height">797.5</x:Double>
                                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <Flowchart.StartNode>
                                                                  <x:Reference>__ReferenceID30</x:Reference>
                                                                </Flowchart.StartNode>
                                                                <FlowDecision x:Name="__ReferenceID30" DisplayName="4个必填值只要有一个没有值" sap:VirtualizedContainerService.HintSize="155,87" sap2010:WorkflowViewState.IdRef="FlowDecision_41">
                                                                  <FlowDecision.Condition>
                                                                    <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_150">String.IsNullOrEmpty(Convert.ToString(invoiceRow["发票代码"])) || String.IsNullOrEmpty(Convert.ToString(invoiceRow["发票号码"])) || String.IsNullOrEmpty(Convert.ToString(invoiceRow["开票日期"])) || String.IsNullOrEmpty(Convert.ToString(invoiceRow["开票金额"]))</mca:CSharpValue>
                                                                  </FlowDecision.Condition>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <av:Point x:Key="ShapeLocation">222.5,126.5</av:Point>
                                                                      <av:Size x:Key="ShapeSize">155,87</av:Size>
                                                                      <av:PointCollection x:Key="TrueConnector">222.5,170 190,170 190,282.5</av:PointCollection>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <FlowDecision.True>
                                                                    <FlowStep x:Name="__ReferenceID29" sap2010:WorkflowViewState.IdRef="FlowStep_137">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <av:Point x:Key="ShapeLocation">28.5,282.5</av:Point>
                                                                          <av:Size x:Key="ShapeSize">323,55</av:Size>
                                                                          <av:PointCollection x:Key="ConnectorLocation">450,797.5 450,847.5</av:PointCollection>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_56" IsIgnore="False">
                                                                        <bfa:Assign.To>
                                                                          <OutArgument x:TypeArguments="x:Object">
                                                                            <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_51">invoiceRow["状态"]</mca:CSharpReference>
                                                                          </OutArgument>
                                                                        </bfa:Assign.To>
                                                                        <bfa:Assign.Value>
                                                                          <InArgument x:TypeArguments="x:String">
                                                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_151">"影像不清晰"</mca:CSharpValue>
                                                                          </InArgument>
                                                                        </bfa:Assign.Value>
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                      </bfa:Assign>
                                                                    </FlowStep>
                                                                  </FlowDecision.True>
                                                                </FlowDecision>
                                                                <x:Reference>__ReferenceID29</x:Reference>
                                                              </Flowchart>
                                                              <FlowStep.Next>
                                                                <FlowStep x:Name="__ReferenceID31" sap2010:WorkflowViewState.IdRef="FlowStep_139">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <av:Point x:Key="ShapeLocation">378.5,1502.5</av:Point>
                                                                      <av:Size x:Key="ShapeSize">323,55</av:Size>
                                                                      <av:PointCollection x:Key="ConnectorLocation">540,1557.5 540,1613.5</av:PointCollection>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_57" IsIgnore="False">
                                                                    <bfa:Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Object">
                                                                        <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_52">invoiceRow["发票图片"]</mca:CSharpReference>
                                                                      </OutArgument>
                                                                    </bfa:Assign.To>
                                                                    <bfa:Assign.Value>
                                                                      <InArgument x:TypeArguments="x:String">
                                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_152">item</mca:CSharpValue>
                                                                      </InArgument>
                                                                    </bfa:Assign.Value>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </bfa:Assign>
                                                                  <FlowStep.Next>
                                                                    <FlowStep x:Name="__ReferenceID47" sap2010:WorkflowViewState.IdRef="FlowStep_138">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <av:Point x:Key="ShapeLocation">440,1613.5</av:Point>
                                                                          <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <baasf:FileCopyMoveActivity ActionType="Move" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="移动发票图片到已处理" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="FileCopyMoveActivity_2" Overwrite="True">
                                                                        <baasf:FileCopyMoveActivity.DestinationPath>
                                                                          <InArgument x:TypeArguments="x:String">
                                                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_154">发票已处理</mca:CSharpValue>
                                                                          </InArgument>
                                                                        </baasf:FileCopyMoveActivity.DestinationPath>
                                                                        <baasf:FileCopyMoveActivity.OriginPath>
                                                                          <InArgument x:TypeArguments="x:String">
                                                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_153">item</mca:CSharpValue>
                                                                          </InArgument>
                                                                        </baasf:FileCopyMoveActivity.OriginPath>
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                      </baasf:FileCopyMoveActivity>
                                                                    </FlowStep>
                                                                  </FlowStep.Next>
                                                                </FlowStep>
                                                              </FlowStep.Next>
                                                            </FlowStep>
                                                          </FlowStep.Next>
                                                        </FlowStep>
                                                      </FlowDecision.True>
                                                      <FlowDecision.False>
                                                        <FlowDecision x:Name="__ReferenceID37" DisplayName="二手车发票类型" sap:VirtualizedContainerService.HintSize="88,87" sap2010:WorkflowViewState.IdRef="FlowDecision_42">
                                                          <FlowDecision.Condition>
                                                            <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_155">发票类型 == 二手车发票类型</mca:CSharpValue>
                                                          </FlowDecision.Condition>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <av:Point x:Key="ShapeLocation">696,1076.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">88,87</av:Size>
                                                              <av:PointCollection x:Key="FalseConnector">784,1120 890,1120</av:PointCollection>
                                                              <av:PointCollection x:Key="TrueConnector">696,1120 628.5,1120 628.5,1300 658.5,1300</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <FlowDecision.True>
                                                            <FlowStep x:Name="__ReferenceID39" sap2010:WorkflowViewState.IdRef="FlowStep_142">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <av:Point x:Key="ShapeLocation">658.5,1272.5</av:Point>
                                                                  <av:Size x:Key="ShapeSize">323,55</av:Size>
                                                                  <av:PointCollection x:Key="ConnectorLocation">820,1327.5 820,1357.5 540,1357.5 540,1502.5</av:PointCollection>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_58" IsIgnore="False">
                                                                <bfa:Assign.To>
                                                                  <OutArgument x:TypeArguments="x:Object">
                                                                    <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_53">invoiceRow["状态"]</mca:CSharpReference>
                                                                  </OutArgument>
                                                                </bfa:Assign.To>
                                                                <bfa:Assign.Value>
                                                                  <InArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_156">"二手车"</mca:CSharpValue>
                                                                  </InArgument>
                                                                </bfa:Assign.Value>
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                              </bfa:Assign>
                                                              <FlowStep.Next>
                                                                <x:Reference>__ReferenceID31</x:Reference>
                                                              </FlowStep.Next>
                                                            </FlowStep>
                                                          </FlowDecision.True>
                                                          <FlowDecision.False>
                                                            <FlowStep x:Name="__ReferenceID38" sap2010:WorkflowViewState.IdRef="FlowStep_143">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <av:Point x:Key="ShapeLocation">890,1093.5</av:Point>
                                                                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <baasf:WriteTextFile ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入文件" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="WriteTextFile_29" WriteOptions="AppendLine">
                                                                <baasf:WriteTextFile.ContentToWrite>
                                                                  <InArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_158">"[出错]发票查验结果出错，" + DateTime.Now.ToString() + "---" + item + "，不是机动车或者二手车购车发票"</mca:CSharpValue>
                                                                  </InArgument>
                                                                </baasf:WriteTextFile.ContentToWrite>
                                                                <baasf:WriteTextFile.FilePath>
                                                                  <InArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_157">logFile</mca:CSharpValue>
                                                                  </InArgument>
                                                                </baasf:WriteTextFile.FilePath>
                                                              </baasf:WriteTextFile>
                                                            </FlowStep>
                                                          </FlowDecision.False>
                                                        </FlowDecision>
                                                      </FlowDecision.False>
                                                    </FlowDecision>
                                                  </FlowDecision.False>
                                                </FlowDecision>
                                              </FlowDecision.True>
                                              <FlowDecision.False>
                                                <FlowStep x:Name="__ReferenceID35" sap2010:WorkflowViewState.IdRef="FlowStep_144">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">470,593.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <baasf:WriteTextFile ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入文件" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="WriteTextFile_30" WriteOptions="AppendLine">
                                                    <baasf:WriteTextFile.ContentToWrite>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_160">"[出错]发票查验结果出错，" + DateTime.Now.ToString() + "---" + item + "，错误消息：" + 识别错误信息</mca:CSharpValue>
                                                      </InArgument>
                                                    </baasf:WriteTextFile.ContentToWrite>
                                                    <baasf:WriteTextFile.FilePath>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_159">logFile</mca:CSharpValue>
                                                      </InArgument>
                                                    </baasf:WriteTextFile.FilePath>
                                                  </baasf:WriteTextFile>
                                                </FlowStep>
                                              </FlowDecision.False>
                                            </FlowDecision>
                                          </FlowStep.Next>
                                        </FlowStep>
                                      </FlowDecision.True>
                                    </FlowDecision>
                                  </FlowStep.Next>
                                </FlowStep>
                                <x:Reference>__ReferenceID32</x:Reference>
                                <x:Reference>__ReferenceID33</x:Reference>
                                <x:Reference>__ReferenceID34</x:Reference>
                                <x:Reference>__ReferenceID35</x:Reference>
                                <x:Reference>__ReferenceID36</x:Reference>
                                <x:Reference>__ReferenceID37</x:Reference>
                                <x:Reference>__ReferenceID38</x:Reference>
                                <x:Reference>__ReferenceID39</x:Reference>
                                <x:Reference>__ReferenceID40</x:Reference>
                                <FlowStep sap2010:WorkflowViewState.IdRef="FlowStep_153">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">780,1483.5</av:Point>
                                      <av:Size x:Key="ShapeSize">200,53</av:Size>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Flowchart DisplayName="发票检验" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="Flowchart_23">
                                    <Flowchart.Variables>
                                      <Variable x:TypeArguments="x:String" Name="发票查验结果" />
                                    </Flowchart.Variables>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                        <av:Size x:Key="ShapeSize">60,75</av:Size>
                                        <x:Double x:Key="Height">1011</x:Double>
                                        <x:Double x:Key="Width">650</x:Double>
                                        <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,107.5 360,107.5 360,193.5 290,193.5 290,223.5</av:PointCollection>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Flowchart.StartNode>
                                      <x:Reference>__ReferenceID44</x:Reference>
                                    </Flowchart.StartNode>
                                    <FlowStep x:Name="__ReferenceID44" sap2010:WorkflowViewState.IdRef="FlowStep_149">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">190,223.5</av:Point>
                                          <av:Size x:Key="ShapeSize">200,53</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">290,276.5 290,316.5</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <bfa:TryCatch ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="错误捕获 发送发票查检请求" sap:VirtualizedContainerService.HintSize="1131,1253" sap2010:WorkflowViewState.IdRef="TryCatch_17" IsIgnore="False">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <bfa:TryCatch.Try>
                                          <Sequence sap:VirtualizedContainerService.HintSize="371,244" sap2010:WorkflowViewState.IdRef="Sequence_39">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <baast:LogActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_10" Level="Info">
                                              <baast:LogActivity.LogContent>
                                                <InArgument x:TypeArguments="x:String">
                                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_161">"金额：" + invoiceRow["开票金额"].ToString() + " ---- 发票代码：" + invoiceRow["发票代码"].ToString() + " ---- 发票号码：" + invoiceRow["发票号码"].ToString() + " ---- 开票日期：" + invoiceRow["开票日期"].ToString()</mca:CSharpValue>
                                                </InArgument>
                                              </baast:LogActivity.LogContent>
                                            </baast:LogActivity>
                                            <eb:CheckInvoiceActivity CheckCode="{x:Null}" DisplayName="发票查检" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="CheckInvoiceActivity_8">
                                              <eb:CheckInvoiceActivity.AppKey>
                                                <InArgument x:TypeArguments="x:String">
                                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_166">APP_KEY</mca:CSharpValue>
                                                </InArgument>
                                              </eb:CheckInvoiceActivity.AppKey>
                                              <eb:CheckInvoiceActivity.BillingDate>
                                                <InArgument x:TypeArguments="x:String">
                                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_164">invoiceRow["开票日期"].ToString()</mca:CSharpValue>
                                                </InArgument>
                                              </eb:CheckInvoiceActivity.BillingDate>
                                              <eb:CheckInvoiceActivity.InvoiceCode>
                                                <InArgument x:TypeArguments="x:String">
                                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_162">invoiceRow["发票代码"].ToString()</mca:CSharpValue>
                                                </InArgument>
                                              </eb:CheckInvoiceActivity.InvoiceCode>
                                              <eb:CheckInvoiceActivity.InvoiceNumber>
                                                <InArgument x:TypeArguments="x:String">
                                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_163">invoiceRow["发票号码"].ToString()</mca:CSharpValue>
                                                </InArgument>
                                              </eb:CheckInvoiceActivity.InvoiceNumber>
                                              <eb:CheckInvoiceActivity.Result>
                                                <OutArgument x:TypeArguments="x:String">
                                                  <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_54">发票查验结果</mca:CSharpReference>
                                                </OutArgument>
                                              </eb:CheckInvoiceActivity.Result>
                                              <eb:CheckInvoiceActivity.TotalAmount>
                                                <InArgument x:TypeArguments="x:String">
                                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_165">invoiceRow["开票金额"].ToString()</mca:CSharpValue>
                                                </InArgument>
                                              </eb:CheckInvoiceActivity.TotalAmount>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </eb:CheckInvoiceActivity>
                                          </Sequence>
                                        </bfa:TryCatch.Try>
                                        <bfa:TryCatch.Catches>
                                          <bfa:Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1117,691" sap2010:WorkflowViewState.IdRef="Catch`1_17">
                                            <bfa:Catch.Action>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                </ActivityAction.Argument>
                                                <bfa:If ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If）判断错误消息，查无此票还是不一致。如果是其他异常则终止整个流程" sap:VirtualizedContainerService.HintSize="1111,620" sap2010:WorkflowViewState.IdRef="If_19" IsIgnore="False">
                                                  <bfa:If.Condition>
                                                    <InArgument x:TypeArguments="x:Boolean">
                                                      <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_167">exception.Message.Contains("不存在")</mca:CSharpValue>
                                                    </InArgument>
                                                  </bfa:If.Condition>
                                                  <bfa:If.Then>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="345,179" sap2010:WorkflowViewState.IdRef="Sequence_40">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_59" IsIgnore="False">
                                                        <bfa:Assign.To>
                                                          <OutArgument x:TypeArguments="x:Object">
                                                            <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_55">invoiceRow["状态"]</mca:CSharpReference>
                                                          </OutArgument>
                                                        </bfa:Assign.To>
                                                        <bfa:Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">
                                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_168">"查无此票"</mca:CSharpValue>
                                                          </InArgument>
                                                        </bfa:Assign.Value>
                                                      </bfa:Assign>
                                                    </Sequence>
                                                  </bfa:If.Then>
                                                  <bfa:If.Else>
                                                    <bfa:If ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If）" sap:VirtualizedContainerService.HintSize="741,493" sap2010:WorkflowViewState.IdRef="If_18" IsIgnore="False">
                                                      <bfa:If.Condition>
                                                        <InArgument x:TypeArguments="x:Boolean">
                                                          <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_169">exception.Message.Contains("不一致")</mca:CSharpValue>
                                                        </InArgument>
                                                      </bfa:If.Condition>
                                                      <bfa:If.Then>
                                                        <Sequence sap:VirtualizedContainerService.HintSize="345,179" sap2010:WorkflowViewState.IdRef="Sequence_41">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_60" IsIgnore="False">
                                                            <bfa:Assign.To>
                                                              <OutArgument x:TypeArguments="x:Object">
                                                                <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_56">invoiceRow["状态"]</mca:CSharpReference>
                                                              </OutArgument>
                                                            </bfa:Assign.To>
                                                            <bfa:Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">
                                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_170">"不一致"</mca:CSharpValue>
                                                              </InArgument>
                                                            </bfa:Assign.Value>
                                                          </bfa:Assign>
                                                        </Sequence>
                                                      </bfa:If.Then>
                                                      <bfa:If.Else>
                                                        <Sequence sap:VirtualizedContainerService.HintSize="371,366" sap2010:WorkflowViewState.IdRef="Sequence_42">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="349,55" sap2010:WorkflowViewState.IdRef="Assign_61" IsIgnore="False">
                                                            <bfa:Assign.To>
                                                              <OutArgument x:TypeArguments="x:Boolean">
                                                                <mca:CSharpReference x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpReference`1_57">endWholeProcess</mca:CSharpReference>
                                                              </OutArgument>
                                                            </bfa:Assign.To>
                                                            <bfa:Assign.Value>
                                                              <InArgument x:TypeArguments="x:Boolean">
                                                                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_171">true</mca:CSharpValue>
                                                              </InArgument>
                                                            </bfa:Assign.Value>
                                                          </bfa:Assign>
                                                          <baasf:WriteTextFile ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入文件" sap:VirtualizedContainerService.HintSize="349,85" sap2010:WorkflowViewState.IdRef="WriteTextFile_31" WriteOptions="AppendLine">
                                                            <baasf:WriteTextFile.ContentToWrite>
                                                              <InArgument x:TypeArguments="x:String">
                                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_173">"[出错]发票查验接口异常，终止整个流程" + DateTime.Now.ToString() + "---" + item + "，错误消息：" + exception.Message</mca:CSharpValue>
                                                              </InArgument>
                                                            </baasf:WriteTextFile.ContentToWrite>
                                                            <baasf:WriteTextFile.FilePath>
                                                              <InArgument x:TypeArguments="x:String">
                                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_172">logFile</mca:CSharpValue>
                                                              </InArgument>
                                                            </baasf:WriteTextFile.FilePath>
                                                          </baasf:WriteTextFile>
                                                          <bfa:Break BreakAction="{x:Null}" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="终止循环" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="Break_7" IsIgnore="False" />
                                                        </Sequence>
                                                      </bfa:If.Else>
                                                    </bfa:If>
                                                  </bfa:If.Else>
                                                </bfa:If>
                                              </ActivityAction>
                                            </bfa:Catch.Action>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </bfa:Catch>
                                        </bfa:TryCatch.Catches>
                                      </bfa:TryCatch>
                                      <FlowStep.Next>
                                        <FlowDecision x:Name="__ReferenceID41" DisplayName="发票检验请求成功" sap:VirtualizedContainerService.HintSize="100,87" sap2010:WorkflowViewState.IdRef="FlowDecision_47">
                                          <FlowDecision.Condition>
                                            <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_174">!String.IsNullOrEmpty(发票查验结果)</mca:CSharpValue>
                                          </FlowDecision.Condition>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <av:Point x:Key="ShapeLocation">240,316.5</av:Point>
                                              <av:Size x:Key="ShapeSize">100,87</av:Size>
                                              <av:PointCollection x:Key="TrueConnector">240,360 170,360 170,431</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <FlowDecision.True>
                                            <FlowStep x:Name="__ReferenceID42" sap2010:WorkflowViewState.IdRef="FlowStep_148">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">70,431</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,58</av:Size>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <baac:InvokeCSharpCodeNoVariableActivity CSharpCode="dAByAHkADQAKAHsADQAKAAkASgBPAGIAagBlAGMAdAAgAGoATwBiAGoAZQBjAHQAIAA9ACAAKABKAE8AYgBqAGUAYwB0ACkASgBzAG8AbgBDAG8AbgB2AGUAcgB0AC4ARABlAHMAZQByAGkAYQBsAGkAegBlAE8AYgBqAGUAYwB0ACgA0VNoeeVnjJrTfpxnKQA7AA0ACgAJAEoAVgBhAGwAdQBlACAAaQBuAHYAbwBpAGMAZQBTAHQAYQB0AGUAIAA9ACAAKABKAFYAYQBsAHUAZQApAGoATwBiAGoAZQBjAHQAWwAiAHMAdABhAHQAZQAiAF0AOwANAAoACQBTAHQAcgBpAG4AZwAgAHMAdABhAHQAZQBWAGEAbAB1AGUAIAA9ACAAaQBuAHYAbwBpAGMAZQBTAHQAYQB0AGUALgBWAGEAbAB1AGUALgBUAG8AUwB0AHIAaQBuAGcAKAApADsADQAKAAkAaQBmACgAcwB0AGEAdABlAFYAYQBsAHUAZQAgAD0APQAgACIAMAAiACkADQAKAAkAewANAAoACQAgACAAaQBuAHYAbwBpAGMAZQBSAG8AdwBbACIAtnIBYCIAXQAgAD0AIAAiAGNrOF4iADsADQAKAAkAfQANAAoACQBlAGwAcwBlACAAaQBmACgAcwB0AGEAdABlAFYAYQBsAHUAZQAgAD0APQAgACIAMgAiACkADQAKAAkAewANAAoACQAgACAAaQBuAHYAbwBpAGMAZQBSAG8AdwBbACIAtnIBYCIAXQAgAD0AIAAiAFxPn14iADsADQAKAAkAfQANAAoACQBlAGwAcwBlACAAaQBmACgAcwB0AGEAdABlAFYAYQBsAHUAZQAgAD0APQAgACIAMwAiACkADQAKAAkAewANAAoACQAgACAAaQBuAHYAbwBpAGMAZQBSAG8AdwBbACIAtnIBYCIAXQAgAD0AIAAiALJRon4iADsADQAKAAkAfQANAAoACQBlAGwAcwBlAA0ACgAJAHsADQAKAAkAIAAgAGkAbgB2AG8AaQBjAGUAUgBvAHcAWwAiALZyAWAiAF0AIAA9ACAAcwB0AGEAdABlAFYAYQBsAHUAZQAgACsAIAAiAC0AKmfldyIAOwANAAoACQB9AA0ACgB9AA0ACgBjAGEAdABjAGgAKABFAHgAYwBlAHAAdABpAG8AbgAgAGUAKQANAAoAewANAAoAIAAgACAAIABDAG8AbgBzAG8AbABlAC4AVwByAGkAdABlAEwAaQBuAGUAKAAiANFTaHnAaIyaQwAjAARZBnT6URmVGv8iACAAKwAgAGUALgBNAGUAcwBzAGEAZwBlACkAOwANAAoAfQA=" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 解析查验结果" sap:VirtualizedContainerService.HintSize="200,58" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_21">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </baac:InvokeCSharpCodeNoVariableActivity>
                                            </FlowStep>
                                          </FlowDecision.True>
                                        </FlowDecision>
                                      </FlowStep.Next>
                                    </FlowStep>
                                    <x:Reference>__ReferenceID41</x:Reference>
                                    <x:Reference>__ReferenceID42</x:Reference>
                                    <FlowStep sap2010:WorkflowViewState.IdRef="FlowStep_150">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">420,231</av:Point>
                                          <av:Size x:Key="ShapeSize">200,58</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">520,289 520,460 270,460</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <baac:InvokeCSharpCodeNoVariableActivity CSharpCode="cwB0AHIAaQBuAGcAIABmAGkAbABlACAAPQAgAEAAIgBEADoAXACRTmli0XmAYlwAUgBQAEEAXABPAEMAUgBcANFTaHnlZ4yaXE+fXi4AdAB4AHQAIgA7AA0ACgDRU2h55WeMmtN+nGcgAD0AIABGAGkAbABlAC4AUgBlAGEAZABBAGwAbABUAGUAeAB0ACgAZgBpAGwAZQApADsA" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 跳过查验请求" sap:VirtualizedContainerService.HintSize="200,58" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_22">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </baac:InvokeCSharpCodeNoVariableActivity>
                                      <FlowStep.Next>
                                        <x:Reference>__ReferenceID42</x:Reference>
                                      </FlowStep.Next>
                                    </FlowStep>
                                    <FlowStep sap2010:WorkflowViewState.IdRef="FlowStep_152">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">8.5,122.5</av:Point>
                                          <av:Size x:Key="ShapeSize">323,55</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">170,177.5 130,177.5 130,189</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_62" IsIgnore="False">
                                        <bfa:Assign.To>
                                          <OutArgument x:TypeArguments="x:Boolean">
                                            <mca:CSharpReference x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpReference`1_58">endWholeProcess</mca:CSharpReference>
                                          </OutArgument>
                                        </bfa:Assign.To>
                                        <bfa:Assign.Value>
                                          <InArgument x:TypeArguments="x:Boolean">
                                            <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_175">true</mca:CSharpValue>
                                          </InArgument>
                                        </bfa:Assign.Value>
                                      </bfa:Assign>
                                      <FlowStep.Next>
                                        <FlowStep x:Name="__ReferenceID43" sap2010:WorkflowViewState.IdRef="FlowStep_151">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">30,189</av:Point>
                                              <av:Size x:Key="ShapeSize">200,22</av:Size>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <bfa:Break BreakAction="{x:Null}" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="终止循环" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Break_8" IsIgnore="False">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </bfa:Break>
                                        </FlowStep>
                                      </FlowStep.Next>
                                    </FlowStep>
                                    <x:Reference>__ReferenceID43</x:Reference>
                                  </Flowchart>
                                </FlowStep>
                                <FlowStep sap2010:WorkflowViewState.IdRef="FlowStep_155">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">840,241</av:Point>
                                      <av:Size x:Key="ShapeSize">200,58</av:Size>
                                      <av:PointCollection x:Key="ConnectorLocation">940,299 940,343.5</av:PointCollection>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <baac:InvokeCSharpCodeNoVariableActivity CSharpCode="cwB0AHIAaQBuAGcAIABmAGkAbABlACAAPQAgAEAAIgBDADoAXABwZVdbWFTlXVwAagBzAG8AbgAuAHQAeAB0ACIAOwANAAoA0VNoecaLK1LTfpxnIAA9ACAARgBpAGwAZQAuAFIAZQBhAGQAQQBsAGwAVABlAHgAdAAoAGYAaQBsAGUAKQA7AA==" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 假设获取到result" sap:VirtualizedContainerService.HintSize="200,58" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_23">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </baac:InvokeCSharpCodeNoVariableActivity>
                                  <FlowStep.Next>
                                    <FlowStep x:Name="__ReferenceID45" sap2010:WorkflowViewState.IdRef="FlowStep_154">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">840,343.5</av:Point>
                                          <av:Size x:Key="ShapeSize">200,53</av:Size>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <baast:LogActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="LogActivity_11" Level="Info">
                                        <baast:LogActivity.LogContent>
                                          <InArgument x:TypeArguments="x:String">
                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_176">"发票识别结果:" + 发票识别结果</mca:CSharpValue>
                                          </InArgument>
                                        </baast:LogActivity.LogContent>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </baast:LogActivity>
                                    </FlowStep>
                                  </FlowStep.Next>
                                </FlowStep>
                                <x:Reference>__ReferenceID31</x:Reference>
                                <x:Reference>__ReferenceID45</x:Reference>
                                <x:Reference>__ReferenceID46</x:Reference>
                                <x:Reference>__ReferenceID47</x:Reference>
                                <FlowStep x:Name="__ReferenceID50" sap2010:WorkflowViewState.IdRef="FlowStep_147">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">200,127.5</av:Point>
                                      <av:Size x:Key="ShapeSize">200,58</av:Size>
                                      <av:PointCollection x:Key="ConnectorLocation">300,185.5 300,223.5</av:PointCollection>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <baac:InvokeCSharpCodeNoVariableActivity CSharpCode="aQBuAHYAbwBpAGMAZQBSAG8AdwAgAD0AIABpAG4AdgBvAGkAYwBlAEQAVAAuAE4AZQB3AFIAbwB3ACgAKQA7AA0ACgBpAG4AdgBvAGkAYwBlAFIAbwB3AFsAIgCPXvdTIgBdACAAPQBQAGEAdABoAC4ARwBlAHQARgBpAGwAZQBOAGEAbQBlAFcAaQB0AGgAbwB1AHQARQB4AHQAZQBuAHMAaQBvAG4AKABpAHQAZQBtACkAOwA=" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 dr 填写序号" sap:VirtualizedContainerService.HintSize="200,58" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_19">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </baac:InvokeCSharpCodeNoVariableActivity>
                                  <FlowStep.Next>
                                    <x:Reference>__ReferenceID28</x:Reference>
                                  </FlowStep.Next>
                                </FlowStep>
                                <x:Reference>__ReferenceID48</x:Reference>
                                <x:Reference>__ReferenceID49</x:Reference>
                              </Flowchart>
                            </bfa:TryCatch.Try>
                            <bfa:TryCatch.Catches>
                              <bfa:Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1268,156" sap2010:WorkflowViewState.IdRef="Catch`1_18">
                                <bfa:Catch.Action>
                                  <ActivityAction x:TypeArguments="s:Exception">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                    </ActivityAction.Argument>
                                    <baasf:WriteTextFile ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入文件" sap:VirtualizedContainerService.HintSize="349,85" sap2010:WorkflowViewState.IdRef="WriteTextFile_32" WriteOptions="AppendLine">
                                      <baasf:WriteTextFile.ContentToWrite>
                                        <InArgument x:TypeArguments="x:String">
                                          <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_178">"[出错]发票识别及查验，" + DateTime.Now.ToString() + "---" + item + "，错误消息：" + exception.Message</mca:CSharpValue>
                                        </InArgument>
                                      </baasf:WriteTextFile.ContentToWrite>
                                      <baasf:WriteTextFile.FilePath>
                                        <InArgument x:TypeArguments="x:String">
                                          <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_177">logFile</mca:CSharpValue>
                                        </InArgument>
                                      </baasf:WriteTextFile.FilePath>
                                    </baasf:WriteTextFile>
                                  </ActivityAction>
                                </bfa:Catch.Action>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </bfa:Catch>
                            </bfa:TryCatch.Catches>
                            <bfa:TryCatch.Finally>
                              <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="471,311" sap2010:WorkflowViewState.IdRef="Sequence_43">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <bfa:If ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If） invoiceRow 不为null" sap:VirtualizedContainerService.HintSize="449,187" sap2010:WorkflowViewState.IdRef="If_20" IsIgnore="False">
                                  <bfa:If.Condition>
                                    <InArgument x:TypeArguments="x:Boolean">
                                      <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_179">invoiceRow != null</mca:CSharpValue>
                                    </InArgument>
                                  </bfa:If.Condition>
                                  <bfa:If.Then>
                                    <bda:DataTableAddRowActivity ArrayRow="{x:Null}" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="添加数据行" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="DataTableAddRowActivity_7">
                                      <bda:DataTableAddRowActivity.DataRow>
                                        <InArgument x:TypeArguments="sd:DataRow">
                                          <mca:CSharpValue x:TypeArguments="sd:DataRow" sap2010:WorkflowViewState.IdRef="CSharpValue`1_181">invoiceRow</mca:CSharpValue>
                                        </InArgument>
                                      </bda:DataTableAddRowActivity.DataRow>
                                      <bda:DataTableAddRowActivity.DataTable>
                                        <InArgument x:TypeArguments="sd:DataTable">
                                          <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_180">invoiceDT</mca:CSharpValue>
                                        </InArgument>
                                      </bda:DataTableAddRowActivity.DataTable>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </bda:DataTableAddRowActivity>
                                  </bfa:If.Then>
                                </bfa:If>
                              </Sequence>
                            </bfa:TryCatch.Finally>
                          </bfa:TryCatch>
                          <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="1282,55" sap2010:WorkflowViewState.IdRef="Assign_63" IsIgnore="False">
                            <bfa:Assign.To>
                              <OutArgument x:TypeArguments="x:Int32">
                                <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_59">tmpIndex</mca:CSharpReference>
                              </OutArgument>
                            </bfa:Assign.To>
                            <bfa:Assign.Value>
                              <InArgument x:TypeArguments="x:Int32">
                                <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_182">tmpIndex + 1</mca:CSharpValue>
                              </InArgument>
                            </bfa:Assign.Value>
                          </bfa:Assign>
                          <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="1282,55" sap2010:WorkflowViewState.IdRef="Assign_64" IsIgnore="False">
                            <bfa:Assign.To>
                              <OutArgument x:TypeArguments="x:Int32">
                                <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_60">imageIndex</mca:CSharpReference>
                              </OutArgument>
                            </bfa:Assign.To>
                            <bfa:Assign.Value>
                              <InArgument x:TypeArguments="x:Int32">
                                <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_183">imageIndex + 1</mca:CSharpValue>
                              </InArgument>
                            </bfa:Assign.Value>
                          </bfa:Assign>
                        </Sequence>
                      </bfa:While>
                      <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="1324,55" sap2010:WorkflowViewState.IdRef="Assign_65" IsIgnore="False">
                        <bfa:Assign.To>
                          <OutArgument x:TypeArguments="x:Int32">
                            <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_61">roundIndex</mca:CSharpReference>
                          </OutArgument>
                        </bfa:Assign.To>
                        <bfa:Assign.Value>
                          <InArgument x:TypeArguments="x:Int32">
                            <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_184">roundIndex + 1</mca:CSharpValue>
                          </InArgument>
                        </bfa:Assign.Value>
                      </bfa:Assign>
                      <boa:OfficeExcelOpenOrCreateActivity OfficeVersion="{x:Null}" Password="{x:Null}" SaveAs="{x:Null}" AutoSave="True" ContinueOnError="No" CreateNewFile="False" DelayAfter="0" DelayBefore="0" DisplayName="打开/新建" EnableMacro="False" sap:VirtualizedContainerService.HintSize="1324,444" sap2010:WorkflowViewState.IdRef="OfficeExcelOpenOrCreateActivity_7" ReadOnly="False" Visible="False" needRestoreKey="False">
                        <boa:OfficeExcelOpenOrCreateActivity.Body>
                          <ActivityAction x:TypeArguments="x:Object">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="x:Object" Name="XlWorkbook" />
                            </ActivityAction.Argument>
                            <Sequence sap:VirtualizedContainerService.HintSize="745,336" sap2010:WorkflowViewState.IdRef="Sequence_45">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <bfa:If ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If）" sap:VirtualizedContainerService.HintSize="723,212" sap2010:WorkflowViewState.IdRef="If_21" IsIgnore="False">
                                <bfa:If.Condition>
                                  <InArgument x:TypeArguments="x:Boolean">
                                    <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_185">roundIndex == 1</mca:CSharpValue>
                                  </InArgument>
                                </bfa:If.Condition>
                                <bfa:If.Then>
                                  <boa:OfficeExcelSetRangeActivity AddHeaders="True" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入区域" sap:VirtualizedContainerService.HintSize="349,85" sap2010:WorkflowViewState.IdRef="OfficeExcelSetRangeActivity_6" SheetName="Sheet1">
                                    <boa:OfficeExcelSetRangeActivity.InputDataTable>
                                      <InArgument x:TypeArguments="sd:DataTable">
                                        <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_187">invoiceDT</mca:CSharpValue>
                                      </InArgument>
                                    </boa:OfficeExcelSetRangeActivity.InputDataTable>
                                    <boa:OfficeExcelSetRangeActivity.StartCell>
                                      <InArgument x:TypeArguments="x:String">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_186">"A" + (1 + perRoundCount * (roundIndex - 1)).ToString()</mca:CSharpValue>
                                      </InArgument>
                                    </boa:OfficeExcelSetRangeActivity.StartCell>
                                  </boa:OfficeExcelSetRangeActivity>
                                </bfa:If.Then>
                                <bfa:If.Else>
                                  <boa:OfficeExcelSetRangeActivity AddHeaders="False" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入区域" sap:VirtualizedContainerService.HintSize="349,85" sap2010:WorkflowViewState.IdRef="OfficeExcelSetRangeActivity_7" SheetName="Sheet1">
                                    <boa:OfficeExcelSetRangeActivity.InputDataTable>
                                      <InArgument x:TypeArguments="sd:DataTable">
                                        <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_189">invoiceDT</mca:CSharpValue>
                                      </InArgument>
                                    </boa:OfficeExcelSetRangeActivity.InputDataTable>
                                    <boa:OfficeExcelSetRangeActivity.StartCell>
                                      <InArgument x:TypeArguments="x:String">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_188">"A" + (2 + perRoundCount * (roundIndex - 1)).ToString()</mca:CSharpValue>
                                      </InArgument>
                                    </boa:OfficeExcelSetRangeActivity.StartCell>
                                  </boa:OfficeExcelSetRangeActivity>
                                </bfa:If.Else>
                              </bfa:If>
                            </Sequence>
                          </ActivityAction>
                        </boa:OfficeExcelOpenOrCreateActivity.Body>
                        <boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                          <InArgument x:TypeArguments="x:String">
                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_190">发票结果临时文件</mca:CSharpValue>
                          </InArgument>
                        </boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                      </boa:OfficeExcelOpenOrCreateActivity>
                      <bfa:If ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If）" sap:VirtualizedContainerService.HintSize="1324,187" sap2010:WorkflowViewState.IdRef="If_22" IsIgnore="False">
                        <bfa:If.Condition>
                          <InArgument x:TypeArguments="x:Boolean">
                            <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_191">endWholeProcess</mca:CSharpValue>
                          </InArgument>
                        </bfa:If.Condition>
                        <bfa:If.Then>
                          <bfa:Break BreakAction="{x:Null}" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="终止循环" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Break_9" IsIgnore="False" />
                        </bfa:If.Then>
                      </bfa:If>
                    </Sequence>
                  </bfa:DoWhile>
                </FlowStep>
                <FlowStep x:Name="__ReferenceID77" sap2010:WorkflowViewState.IdRef="FlowStep_197">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">310,153.5</av:Point>
                      <av:Size x:Key="ShapeSize">200,53</av:Size>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Flowchart DisplayName="读取excel，处理发票" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="Flowchart_30">
                    <Flowchart.Variables>
                      <Variable x:TypeArguments="x:Object" Name="lastTimeIndexObj" />
                      <Variable x:TypeArguments="x:Int32" Default="2" Name="rowIndex" />
                      <Variable x:TypeArguments="x:Int32" Name="发票末行号" />
                    </Flowchart.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                        <av:Size x:Key="ShapeSize">60,75</av:Size>
                        <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,133.5</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Flowchart.StartNode>
                      <x:Reference>__ReferenceID76</x:Reference>
                    </Flowchart.StartNode>
                    <FlowStep x:Name="__ReferenceID74" sap2010:WorkflowViewState.IdRef="FlowStep_195">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">200,373.5</av:Point>
                          <av:Size x:Key="ShapeSize">200,53</av:Size>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <boa:OfficeExcelOpenOrCreateActivity OfficeVersion="{x:Null}" Password="{x:Null}" SaveAs="{x:Null}" AutoSave="True" ContinueOnError="No" CreateNewFile="False" DelayAfter="0" DelayBefore="0" DisplayName="打开 - 发票excel文件" EnableMacro="False" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="OfficeExcelOpenOrCreateActivity_11" ReadOnly="False" Visible="False" needRestoreKey="False">
                        <boa:OfficeExcelOpenOrCreateActivity.Body>
                          <ActivityAction x:TypeArguments="x:Object">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="x:Object" Name="XlWorkbook" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="1677,3708" sap2010:WorkflowViewState.IdRef="Sequence_49">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <boa:OfficeExcelGetLastRowIndexActivity ColumnIndex="1" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="获取末行号" sap:VirtualizedContainerService.HintSize="1655,58" sap2010:WorkflowViewState.IdRef="OfficeExcelGetLastRowIndexActivity_2" SheetName="Sheet1">
                                <boa:OfficeExcelGetLastRowIndexActivity.LastRowIndex>
                                  <OutArgument x:TypeArguments="x:Int32">
                                    <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_77">发票末行号</mca:CSharpReference>
                                  </OutArgument>
                                </boa:OfficeExcelGetLastRowIndexActivity.LastRowIndex>
                              </boa:OfficeExcelGetLastRowIndexActivity>
                              <bfa:While ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="循环操作（While)" sap:VirtualizedContainerService.HintSize="1655,3486" sap2010:WorkflowViewState.IdRef="While_3" IsIgnore="False">
                                <bfa:While.Variables>
                                  <Variable x:TypeArguments="x:Object" Name="序号" />
                                </bfa:While.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <bfa:While.Condition>
                                  <InArgument x:TypeArguments="x:Boolean">
                                    <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_241">rowIndex &lt;= 发票末行号</mca:CSharpValue>
                                  </InArgument>
                                </bfa:While.Condition>
                                <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="1635,3377" sap2010:WorkflowViewState.IdRef="Sequence_58">
                                  <Sequence.Variables>
                                    <Variable x:TypeArguments="x:String" Name="发票图片" />
                                    <Variable x:TypeArguments="x:String" Name="发票状态" />
                                    <Variable x:TypeArguments="x:Boolean" Name="fileExist" />
                                  </Sequence.Variables>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <boa:OfficeExcelReadCellActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="读取单元格 - 获取序号" sap:VirtualizedContainerService.HintSize="1613,58" sap2010:WorkflowViewState.IdRef="OfficeExcelReadCellActivity_5" PreserveFormat="False" SheetName="Sheet1">
                                    <boa:OfficeExcelReadCellActivity.CellName>
                                      <InArgument x:TypeArguments="x:String">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_243">"A" + rowIndex</mca:CSharpValue>
                                      </InArgument>
                                    </boa:OfficeExcelReadCellActivity.CellName>
                                    <boa:OfficeExcelReadCellActivity.CellValue>
                                      <OutArgument x:TypeArguments="x:Object">
                                        <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_79">序号</mca:CSharpReference>
                                      </OutArgument>
                                    </boa:OfficeExcelReadCellActivity.CellValue>
                                  </boa:OfficeExcelReadCellActivity>
                                  <bfa:If ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If）" sap:VirtualizedContainerService.HintSize="1613,187" sap2010:WorkflowViewState.IdRef="If_25" IsIgnore="False">
                                    <bfa:If.Condition>
                                      <InArgument x:TypeArguments="x:Boolean">
                                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_295">序号 == null</mca:CSharpValue>
                                      </InArgument>
                                    </bfa:If.Condition>
                                    <bfa:If.Then>
                                      <bfa:Continue ContinueAction="{x:Null}" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="继续循环" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_1" IsIgnore="False" />
                                    </bfa:If.Then>
                                  </bfa:If>
                                  <baac:InvokeCSharpCodeNoVariableActivity CSharpCode="0VNoef5WR3IgAD0AIABQAGEAdABoAC4AQwBvAG0AYgBpAG4AZQAoAIVfBFkGdNFTaHmHZfZOOVksACAAQwBvAG4AdgBlAHIAdAAuAFQAbwBTAHQAcgBpAG4AZwAoAI9e91MpACAAKwAgACIALgBqAHAAZwAiACkAOwA=" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 - 获取发票图片" sap:VirtualizedContainerService.HintSize="1613,58" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_26" />
                                  <baasf:PathExistsActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="文件/文件夹是否存在" sap:VirtualizedContainerService.HintSize="1613,58" sap2010:WorkflowViewState.IdRef="PathExistsActivity_9" InputType="File">
                                    <baasf:PathExistsActivity.Exists>
                                      <OutArgument x:TypeArguments="x:Boolean">
                                        <mca:CSharpReference x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpReference`1_96">fileExist</mca:CSharpReference>
                                      </OutArgument>
                                    </baasf:PathExistsActivity.Exists>
                                    <baasf:PathExistsActivity.InputPath>
                                      <InArgument x:TypeArguments="x:String">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_296">发票图片</mca:CSharpValue>
                                      </InArgument>
                                    </baasf:PathExistsActivity.InputPath>
                                  </baasf:PathExistsActivity>
                                  <bfa:If ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If）" sap:VirtualizedContainerService.HintSize="1613,2637" sap2010:WorkflowViewState.IdRef="If_26" IsIgnore="False">
                                    <bfa:If.Condition>
                                      <InArgument x:TypeArguments="x:Boolean">
                                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_297">fileExist</mca:CSharpValue>
                                      </InArgument>
                                    </bfa:If.Condition>
                                    <bfa:If.Then>
                                      <bfa:TryCatch ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="错误捕获 发票识别验真" sap:VirtualizedContainerService.HintSize="1376,2510" sap2010:WorkflowViewState.IdRef="TryCatch_23" IsIgnore="False">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <bfa:TryCatch.Try>
                                          <Flowchart DisplayName="发票识别验真" sap:VirtualizedContainerService.HintSize="1358,2036" sap2010:WorkflowViewState.IdRef="Flowchart_35">
                                            <Flowchart.Variables>
                                              <Variable x:TypeArguments="x:String" Name="发票识别结果" />
                                              <Variable x:TypeArguments="x:String" Name="发票类型" />
                                              <Variable x:TypeArguments="x:String" Name="识别错误信息" />
                                              <Variable x:TypeArguments="x:Boolean" Default="True" Name="识别结果正确" />
                                              <Variable x:TypeArguments="x:String" Name="ValdateStatus">
                                                <Variable.Default>
                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                </Variable.Default>
                                              </Variable>
                                              <Variable x:TypeArguments="x:Int32" Default="1" Name="tryTimes" />
                                              <Variable x:TypeArguments="sd:DataRow" Name="invoiceRow" />
                                              <Variable x:TypeArguments="sd:DataTable" Name="cellDT" />
                                            </Flowchart.Variables>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                <av:Point x:Key="ShapeLocation">490,12.5</av:Point>
                                                <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                <av:PointCollection x:Key="ConnectorLocation">520,87.5 520,122</av:PointCollection>
                                                <x:Double x:Key="Width">1344</x:Double>
                                                <x:Double x:Key="Height">2000</x:Double>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Flowchart.StartNode>
                                              <x:Reference>__ReferenceID70</x:Reference>
                                            </Flowchart.StartNode>
                                            <FlowStep x:Name="__ReferenceID51" sap2010:WorkflowViewState.IdRef="FlowStep_222">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">420,213.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">520,266.5 520,316.5</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <bfa:TryCatch ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="错误捕获 发票识别验真" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="TryCatch_22" IsIgnore="False">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <bfa:TryCatch.Try>
                                                  <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="316,180" sap2010:WorkflowViewState.IdRef="Sequence_61">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <eb:InvoiceValidateRegActivity DisplayName="发票识别并验真" sap:VirtualizedContainerService.HintSize="294,56" sap2010:WorkflowViewState.IdRef="InvoiceValidateRegActivity_4">
                                                      <eb:InvoiceValidateRegActivity.AppKey>
                                                        <InArgument x:TypeArguments="x:String">
                                                          <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_303">APP_KEY</mca:CSharpValue>
                                                        </InArgument>
                                                      </eb:InvoiceValidateRegActivity.AppKey>
                                                      <eb:InvoiceValidateRegActivity.ImagePath>
                                                        <InArgument x:TypeArguments="x:String">
                                                          <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_302">发票图片</mca:CSharpValue>
                                                        </InArgument>
                                                      </eb:InvoiceValidateRegActivity.ImagePath>
                                                      <eb:InvoiceValidateRegActivity.RegResult>
                                                        <OutArgument x:TypeArguments="x:String">
                                                          <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_98">发票识别结果</mca:CSharpReference>
                                                        </OutArgument>
                                                      </eb:InvoiceValidateRegActivity.RegResult>
                                                    </eb:InvoiceValidateRegActivity>
                                                  </Sequence>
                                                </bfa:TryCatch.Try>
                                                <bfa:TryCatch.Catches>
                                                  <bfa:Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="435,437" sap2010:WorkflowViewState.IdRef="Catch`1_22">
                                                    <bfa:Catch.Action>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,366" sap2010:WorkflowViewState.IdRef="Sequence_62">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <baasf:WriteTextFile ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入文件" sap:VirtualizedContainerService.HintSize="349,85" sap2010:WorkflowViewState.IdRef="WriteTextFile_44" WriteOptions="AppendLine">
                                                            <baasf:WriteTextFile.ContentToWrite>
                                                              <InArgument x:TypeArguments="x:String">
                                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_305">"[出错] 发票识别验真组件," + DateTime.Now.ToString() + "---" + 发票图片 + "，错误消息：" + exception.Message</mca:CSharpValue>
                                                              </InArgument>
                                                            </baasf:WriteTextFile.ContentToWrite>
                                                            <baasf:WriteTextFile.FilePath>
                                                              <InArgument x:TypeArguments="x:String">
                                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_304">logFile</mca:CSharpValue>
                                                              </InArgument>
                                                            </baasf:WriteTextFile.FilePath>
                                                          </baasf:WriteTextFile>
                                                          <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="349,55" sap2010:WorkflowViewState.IdRef="Assign_82" IsIgnore="False">
                                                            <bfa:Assign.To>
                                                              <OutArgument x:TypeArguments="x:Boolean">
                                                                <mca:CSharpReference x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpReference`1_99">endWholeProcess</mca:CSharpReference>
                                                              </OutArgument>
                                                            </bfa:Assign.To>
                                                            <bfa:Assign.Value>
                                                              <InArgument x:TypeArguments="x:Boolean">
                                                                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_306">true</mca:CSharpValue>
                                                              </InArgument>
                                                            </bfa:Assign.Value>
                                                          </bfa:Assign>
                                                          <bfa:Break BreakAction="{x:Null}" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="终止循环" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="Break_13" IsIgnore="False" />
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </bfa:Catch.Action>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </bfa:Catch>
                                                </bfa:TryCatch.Catches>
                                              </bfa:TryCatch>
                                              <FlowStep.Next>
                                                <FlowDecision x:Name="__ReferenceID55" DisplayName="发票识别验真请求成功" sap:VirtualizedContainerService.HintSize="124,87" sap2010:WorkflowViewState.IdRef="FlowDecision_68">
                                                  <FlowDecision.Condition>
                                                    <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_298">!String.IsNullOrEmpty(发票识别结果)</mca:CSharpValue>
                                                  </FlowDecision.Condition>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <av:Point x:Key="ShapeLocation">458,316.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">124,87</av:Size>
                                                      <av:PointCollection x:Key="TrueConnector">458,360 380,360 380,490 410,490</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <FlowDecision.True>
                                                    <FlowStep x:Name="__ReferenceID56" sap2010:WorkflowViewState.IdRef="FlowStep_234">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">410,461</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,58</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">510,519 510,586.5</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <baac:InvokeCSharpCodeNoVariableActivity CSharpCode="dAByAHkADQAKAHsADQAKAAkASgBPAGIAagBlAGMAdAAgAGoATwBiAGoAZQBjAHQAIAA9ACAAKABKAE8AYgBqAGUAYwB0ACkASgBzAG8AbgBDAG8AbgB2AGUAcgB0AC4ARABlAHMAZQByAGkAYQBsAGkAegBlAE8AYgBqAGUAYwB0ACgA0VNoecaLK1LTfpxnKQA7AA0ACgAJAEoAVgBhAGwAdQBlACAAcgBlAHMAdQBsAHQAVgBhAGwAdQBlACAAPQAgACgASgBWAGEAbAB1AGUAKQBqAE8AYgBqAGUAYwB0AFsAIgByAGUAcwB1AGwAdAAiAF0AOwANAAoACQBpAGYAKAByAGUAcwB1AGwAdABWAGEAbAB1AGUALgBWAGEAbAB1AGUALgBUAG8AUwB0AHIAaQBuAGcAKAApACAAPQA9ACAAIgAxACIAKQB7AA0ACgAJACAAIAAgACAASgBPAGIAagBlAGMAdAAgAGQAYQB0AGEAIAA9ACAAKABKAE8AYgBqAGUAYwB0ACkAagBPAGIAagBlAGMAdABbACIAcgBlAHMAcABvAG4AcwBlACIAXQBbACIAZABhAHQAYQAiAF0AOwANAAoACQAgACAAIAAgAEoAQQByAHIAYQB5ACAAaQBkAGUAbgB0AGkAZgB5AF8AcgBlAHMAdQBsAHQAcwAgACAAPQAgACgASgBBAHIAcgBhAHkAKQBkAGEAdABhAFsAIgBpAGQAZQBuAHQAaQBmAHkAXwByAGUAcwB1AGwAdABzACIAXQA7AA0ACgAJACAAIAAgACAATABpAHMAdAA8AEoAVABvAGsAZQBuAD4AIABpAHQAZQBtAHMAIAA9ACAAaQBkAGUAbgB0AGkAZgB5AF8AcgBlAHMAdQBsAHQAcwAuAEMAaABpAGwAZAByAGUAbgAoACkALgBUAG8ATABpAHMAdAAoACkAOwANAAoACQAgACAAIAAgAGkAZgAoAGkAdABlAG0AcwAuAEMAbwB1AG4AdAAgAD4AIAAwACkADQAKAAkAIAAgACAAIAB7AA0ACgAJAAkAIAAgACAAIABKAE8AYgBqAGUAYwB0ACAAZgBpAHIAcwB0AEkAdABlAG0AIAA9ACAAKABKAE8AYgBqAGUAYwB0ACkAaQB0AGUAbQBzAFsAMABdADsADQAKAAkACQAgACAAIAAgAEoAVgBhAGwAdQBlACAAaQBuAHYAbwBpAGMAZQBUAHkAcABlACAAPQAgACgASgBWAGEAbAB1AGUAKQBmAGkAcgBzAHQASQB0AGUAbQBbACIAdAB5AHAAZQAiAF0AOwANAAoACQAJACAAIAAgACAA0VNoeXt8i1cgAD0AIABpAG4AdgBvAGkAYwBlAFQAeQBwAGUALgBWAGEAbAB1AGUALgBUAG8AUwB0AHIAaQBuAGcAKAApADsADQAKAAkACQAgACAAIAAgAEMAbwBuAHMAbwBsAGUALgBXAHIAaQB0AGUATABpAG4AZQAoANFTaHl7fItXKQA7AA0ACgAJAAkAIAAgACAAIABKAE8AYgBqAGUAYwB0ACAAdgBhAGwAaQBkAGEAdABpAG8AbgAgAD0AIAAoAEoATwBiAGoAZQBjAHQAKQBmAGkAcgBzAHQASQB0AGUAbQBbACIAdgBhAGwAaQBkAGEAdABpAG8AbgAiAF0AOwANAAoACQAgACAAIAAgACAAIAAgACAAZgBvAHIAZQBhAGMAaAAgACgASgBQAHIAbwBwAGUAcgB0AHkAIABqAHAAIABpAG4AIAAoAEoAVABvAGsAZQBuACkAdgBhAGwAaQBkAGEAdABpAG8AbgApAA0ACgAJACAAIAAgACAAIAAgACAAIAB7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHMAdAByAGkAbgBnACAAbgBhAG0AZQAgAD0AIABqAHAALgBOAGEAbQBlAC4AVABvAFMAdAByAGkAbgBnACgAKQA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHMAdAByAGkAbgBnACAAdgBhAGwAdQBlACAAPQAgAGoAcAAuAFYAYQBsAHUAZQAuAFQAbwBTAHQAcgBpAG4AZwAoACkAOwANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAGYAIAAoACIAYwBvAGQAZQAiAC4ARQBxAHUAYQBsAHMAKABuAGEAbQBlACkAKQANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAB7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAcwB3AGkAdABjAGgAIAAoAHYAYQBsAHUAZQApAA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAewANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAMQAwADAAMAAwACIAOgANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABWAGEAbABkAGEAdABlAFMAdABhAHQAdQBzACAAPQAgACIAY2s4XiIAOwANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAMQAwADAAMAAxACIAOgANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABWAGEAbABkAGEAdABlAFMAdABhAHQAdQBzACAAPQAgACIA5WfgZWRraHkiADsADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYgByAGUAYQBrADsADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGMAYQBzAGUAIAAiADEAMAAwADAAMgAiADoADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAVgBhAGwAZABhAHQAZQBTAHQAYQB0AHUAcwAgAD0AIAAiAOVnjJrhT29gDU4ATvSBIgA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAcgBlAGEAawA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABjAGEAcwBlACAAIgAxADAAMAAwADMAIgA6AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAFYAYQBsAGQAYQB0AGUAUwB0AGEAdAB1AHMAIAA9ACAAIgCMmh93IWtwZYWNx49QljZSDP8MVABOIF9oeQBOKVkAZxpZ71PlTuVnjJo1ACFrIgA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAcgBlAGEAawA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABjAGEAcwBlACAAIgAxADAAMAAwADQAIgA6AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAFYAYQBsAGQAYQB0AGUAUwB0AGEAdAB1AHMAIAA9ACAAIgANTi9lAWOMmh930VNoeXt8i1ciADsADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYgByAGUAYQBrADsADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGMAYQBzAGUAIAAiADEAMAAwADAANQAiADoADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAVgBhAGwAZABhAHQAZQBTAHQAYQB0AHUAcwAgAD0AIAAiAOBlSGXCU3BlIgA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAcgBlAGEAawA7AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABjAGEAcwBlACAAIgAxADAAMAAwADYAIgA6AA0ACgAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAFYAYQBsAGQAYQB0AGUAUwB0AGEAdAB1AHMAIAA9ACAAIgB2UYNbGZXviyIAOwANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ADQAKAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAfQANAAoACQANAAoACQAgACAAIAAgACAAIAAgACAAIAAgACAAIABDAG8AbgBzAG8AbABlAC4AVwByAGkAdABlAEwAaQBuAGUAKABWAGEAbABkAGEAdABlAFMAdABhAHQAdQBzACkAOwANAAoACQAgACAAIAAgACAAIAAgACAAfQANAAoAIAAgACAAIAAgACAAIAAgAA0ACgAJAAkAIAAgACAAIABKAE8AYgBqAGUAYwB0ACAAZABlAHQAYQBpAGwAcwAgAD0AIAAoAEoATwBiAGoAZQBjAHQAKQBmAGkAcgBzAHQASQB0AGUAbQBbACIAZABlAHQAYQBpAGwAcwAiAF0AOwANAAoACQAJACAAIAAgACAAZgBvAHIAZQBhAGMAaAAgACgASgBQAHIAbwBwAGUAcgB0AHkAIABqAHAAIABpAG4AIAAoAEoAVABvAGsAZQBuACkAZABlAHQAYQBpAGwAcwApAA0ACgAJAAkAIAAgACAAIAAgACAAIAAgAHsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIABzAHQAcgBpAG4AZwAgAG4AYQBtAGUAIAA9ACAAagBwAC4ATgBhAG0AZQAuAFQAbwBTAHQAcgBpAG4AZwAoACkAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHMAdAByAGkAbgBnACAAdgBhAGwAdQBlACAAPQAgAGoAcAAuAFYAYQBsAHUAZQAuAFQAbwBTAHQAcgBpAG4AZwAoACkAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHMAdwBpAHQAYwBoACgAbgBhAG0AZQApAA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAewANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAYwBvAGQAZQAiADoADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAaQBuAHYAbwBpAGMAZQBSAG8AdwBbACIA0VNoeeNOAXgiAF0AIAA9ACAAdgBhAGwAdQBlADsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYgByAGUAYQBrADsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGMAYQBzAGUAIAAiAG4AdQBtAGIAZQByACIAOgANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAG4AdgBvAGkAYwBlAFIAbwB3AFsAIgDRU2h591MBeCIAXQAgAD0AIAB2AGEAbAB1AGUAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAZABhAHQAZQAiADoADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAARABhAHQAZQBUAGkAbQBlACAAdABtAHAARABhAHQAZQA7AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAbwBvAGwAIABpAHMARABhAHQAZQAgAD0AIABEAGEAdABlAFQAaQBtAGUALgBUAHIAeQBQAGEAcgBzAGUAKAB2AGEAbAB1AGUALAAgAG8AdQB0ACAAdABtAHAARABhAHQAZQApADsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAaQBmACAAKABpAHMARABhAHQAZQApAA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAG4AdgBvAGkAYwBlAFIAbwB3AFsAIgAAX2h55WUfZyIAXQAgAD0AIAB0AG0AcABEAGEAdABlAC4AVABvAFMAdAByAGkAbgBnACgAIgB5AHkAeQB5AC0ATQBNAC0AZABkACIAKQA7AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYgByAGUAYQBrADsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGMAYQBzAGUAIAAiAHAAcgBlAHQAYQB4AF8AYQBtAG8AdQBuAHQAIgA6AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAbgB2AG8AaQBjAGUAUgBvAHcAWwAiAABfaHnRkZ2YIgBdACAAPQAgAHYAYQBsAHUAZQA7AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAcgBlAGEAawA7AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABjAGEAcwBlACAAIgBiAHUAeQBlAHIAIgA6AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAbgB2AG8AaQBjAGUAUgBvAHcAWwAiAC2NcE4FgCIAXQAgAD0AIAB2AGEAbAB1AGUAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAYgB1AHkAZQByAF8AaQBkACIAOgANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAG4AdgBvAGkAYwBlAFIAbwB3AFsAIgAtjXBOBYCrjv1OwYv3UyIAXQAgAD0AIAB2AGEAbAB1AGUAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHMAZQAgACIAaQBuAHYAYQBsAGkAZABfAG0AYQByAGsAIgA6AA0ACgAJAAkAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAZgAoAHYAYQBsAHUAZQAgACEAPQAgACIAMAAiACkADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAewANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAVgBhAGwAZABhAHQAZQBTAHQAYQB0AHUAcwAgAD0AIAAiAFxPn14iADsADQAKAAkACQAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAfQANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHIAZQBhAGsAOwANAAoACQAJACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ADQAKAAkACQAgACAAIAAgACAAIAAgACAAfQANAAoACQAgACAAIAAgAH0ADQAKAAkAfQANAAoACQBlAGwAcwBlAA0ACgAJAHsADQAKAAkAIAAgAMaLK1LTfpxnY2tueCAAIAA9ACAAZgBhAGwAcwBlADsADQAKAAkAIAAgAEoAVgBhAGwAdQBlACAAcgBlAHEAdQBlAHMAdABNAGUAcwBzAGEAZwBlACAAPQAgACgASgBWAGEAbAB1AGUAKQBqAE8AYgBqAGUAYwB0AFsAIgBtAGUAcwBzAGEAZwBlACIAXQA7AA0ACgAJACAAIADGiytSGZXvi+FPb2AgAD0AIAByAGUAcQB1AGUAcwB0AE0AZQBzAHMAYQBnAGUALgBWAGEAbAB1AGUALgBUAG8AUwB0AHIAaQBuAGcAKAApADsADQAKAAkAfQANAAoAfQANAAoAYwBhAHQAYwBoACgARQB4AGMAZQBwAHQAaQBvAG4AIABlACkADQAKAHsADQAKACAAIAAgACAAQwBvAG4AcwBvAGwAZQAuAFcAcgBpAHQAZQBMAGkAbgBlACgAIgBDACMAxH72ToVR6JAM/9FTaHnGiytSBFkGdPpRGZUa/yIAIAArACAAZQAuAE0AZQBzAHMAYQBnAGUAKQA7AA0ACgB9AA==" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 解析识别结果" sap:VirtualizedContainerService.HintSize="200,58" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_36">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </baac:InvokeCSharpCodeNoVariableActivity>
                                                      <FlowStep.Next>
                                                        <FlowDecision x:Name="__ReferenceID57" DisplayName="&quot;识别结果成功&quot;" sap:VirtualizedContainerService.HintSize="86,87" sap2010:WorkflowViewState.IdRef="FlowDecision_67">
                                                          <FlowDecision.Condition>
                                                            <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_299">识别结果正确</mca:CSharpValue>
                                                          </FlowDecision.Condition>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <av:Point x:Key="ShapeLocation">467,586.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">86,87</av:Size>
                                                              <av:PointCollection x:Key="FalseConnector">553,630 690,630</av:PointCollection>
                                                              <av:PointCollection x:Key="TrueConnector">467,630 437,630 437,736.5 490,736.5 490,766.5</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <FlowDecision.True>
                                                            <FlowDecision x:Name="__ReferenceID66" DisplayName="其它错误" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_66">
                                                              <FlowDecision.Condition>
                                                                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_300">ValdateStatus == "其它错误" &amp;&amp; tryTimes &lt;= 3</mca:CSharpValue>
                                                              </FlowDecision.Condition>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  <av:Point x:Key="ShapeLocation">455,766.5</av:Point>
                                                                  <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                                  <av:PointCollection x:Key="TrueConnector">455,810 331.5,810</av:PointCollection>
                                                                  <av:PointCollection x:Key="FalseConnector">525,810 555,810 555,876.5 500,876.5 500,906.5</av:PointCollection>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <FlowDecision.True>
                                                                <FlowStep x:Name="__ReferenceID67" sap2010:WorkflowViewState.IdRef="FlowStep_223">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <av:Point x:Key="ShapeLocation">8.5,782.5</av:Point>
                                                                      <av:Size x:Key="ShapeSize">323,55</av:Size>
                                                                      <av:PointCollection x:Key="ConnectorLocation">170,782.5 170,240 420,240</av:PointCollection>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 如果出现其他错误，则重试3次" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_81" IsIgnore="False">
                                                                    <bfa:Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Int32">
                                                                        <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_97">tryTimes</mca:CSharpReference>
                                                                      </OutArgument>
                                                                    </bfa:Assign.To>
                                                                    <bfa:Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Int32">
                                                                        <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_301">tryTimes + 1</mca:CSharpValue>
                                                                      </InArgument>
                                                                    </bfa:Assign.Value>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </bfa:Assign>
                                                                  <FlowStep.Next>
                                                                    <x:Reference>__ReferenceID51</x:Reference>
                                                                  </FlowStep.Next>
                                                                </FlowStep>
                                                              </FlowDecision.True>
                                                              <FlowDecision.False>
                                                                <FlowDecision x:Name="__ReferenceID59" DisplayName="是机动车购置发票" sap:VirtualizedContainerService.HintSize="100,87" sap2010:WorkflowViewState.IdRef="FlowDecision_65">
                                                                  <FlowDecision.Condition>
                                                                    <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_307">发票类型 == 机动车购置发票类型</mca:CSharpValue>
                                                                  </FlowDecision.Condition>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <av:Point x:Key="ShapeLocation">450,906.5</av:Point>
                                                                      <av:Size x:Key="ShapeSize">100,87</av:Size>
                                                                      <av:PointCollection x:Key="FalseConnector">550,950 740,950 740,1046.5</av:PointCollection>
                                                                      <av:PointCollection x:Key="TrueConnector">450,950 188.5,950 188.5,1130 218.5,1130</av:PointCollection>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <FlowDecision.True>
                                                                    <FlowStep x:Name="__ReferenceID64" sap2010:WorkflowViewState.IdRef="FlowStep_230">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <av:Point x:Key="ShapeLocation">218.5,1102.5</av:Point>
                                                                          <av:Size x:Key="ShapeSize">323,55</av:Size>
                                                                          <av:PointCollection x:Key="ConnectorLocation">380,1157.5 380,1221</av:PointCollection>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_83" IsIgnore="False">
                                                                        <bfa:Assign.To>
                                                                          <OutArgument x:TypeArguments="x:Object">
                                                                            <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_105">invoiceRow["状态"]</mca:CSharpReference>
                                                                          </OutArgument>
                                                                        </bfa:Assign.To>
                                                                        <bfa:Assign.Value>
                                                                          <InArgument x:TypeArguments="x:String">
                                                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_308">ValdateStatus</mca:CSharpValue>
                                                                          </InArgument>
                                                                        </bfa:Assign.Value>
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                      </bfa:Assign>
                                                                      <FlowStep.Next>
                                                                        <FlowStep x:Name="__ReferenceID63" sap2010:WorkflowViewState.IdRef="FlowStep_229">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <av:Point x:Key="ShapeLocation">280,1221</av:Point>
                                                                              <av:Size x:Key="ShapeSize">200,78</av:Size>
                                                                              <av:PointCollection x:Key="ConnectorLocation">380,1299 380,1491 570,1491 570,1521</av:PointCollection>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <Flowchart sap2010:Annotation.AnnotationText="必填值有一个没值" DisplayName="影像不清晰判断" sap:VirtualizedContainerService.HintSize="200,78" sap2010:WorkflowViewState.IdRef="Flowchart_34">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                                                                <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                                                <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,126.5</av:PointCollection>
                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <Flowchart.StartNode>
                                                                              <x:Reference>__ReferenceID53</x:Reference>
                                                                            </Flowchart.StartNode>
                                                                            <FlowDecision x:Name="__ReferenceID53" DisplayName="4个必填值只要有一个没有值" sap:VirtualizedContainerService.HintSize="155,87" sap2010:WorkflowViewState.IdRef="FlowDecision_63">
                                                                              <FlowDecision.Condition>
                                                                                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_309">String.IsNullOrEmpty(Convert.ToString(invoiceRow["发票代码"])) || String.IsNullOrEmpty(Convert.ToString(invoiceRow["发票号码"])) || String.IsNullOrEmpty(Convert.ToString(invoiceRow["开票日期"])) || String.IsNullOrEmpty(Convert.ToString(invoiceRow["开票金额"]))</mca:CSharpValue>
                                                                              </FlowDecision.Condition>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <av:Point x:Key="ShapeLocation">222.5,126.5</av:Point>
                                                                                  <av:Size x:Key="ShapeSize">155,87</av:Size>
                                                                                  <av:PointCollection x:Key="TrueConnector">222.5,170 128.5,170 128.5,310 158.5,310</av:PointCollection>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <FlowDecision.True>
                                                                                <FlowStep x:Name="__ReferenceID52" sap2010:WorkflowViewState.IdRef="FlowStep_224">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <av:Point x:Key="ShapeLocation">158.5,282.5</av:Point>
                                                                                      <av:Size x:Key="ShapeSize">323,55</av:Size>
                                                                                      <av:PointCollection x:Key="ConnectorLocation">450,797.5 450,847.5</av:PointCollection>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_84" IsIgnore="False">
                                                                                    <bfa:Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:Object">
                                                                                        <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_106">invoiceRow["状态"]</mca:CSharpReference>
                                                                                      </OutArgument>
                                                                                    </bfa:Assign.To>
                                                                                    <bfa:Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">
                                                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_310">"影像不清晰"</mca:CSharpValue>
                                                                                      </InArgument>
                                                                                    </bfa:Assign.Value>
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                  </bfa:Assign>
                                                                                </FlowStep>
                                                                              </FlowDecision.True>
                                                                            </FlowDecision>
                                                                            <x:Reference>__ReferenceID52</x:Reference>
                                                                          </Flowchart>
                                                                          <FlowStep.Next>
                                                                            <FlowStep x:Name="__ReferenceID54" sap2010:WorkflowViewState.IdRef="FlowStep_227">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <av:Point x:Key="ShapeLocation">470,1521</av:Point>
                                                                                  <av:Size x:Key="ShapeSize">200,58</av:Size>
                                                                                  <av:PointCollection x:Key="ConnectorLocation">570,1579 570,1643.5</av:PointCollection>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <baac:InvokeCSharpCodeNoVariableActivity CSharpCode="YwBlAGwAbABEAFQAIAA9ACAAbgBlAHcAIABEAGEAdABhAFQAYQBiAGwAZQAoACkAOwANAAoAYwBlAGwAbABEAFQALgBDAG8AbAB1AG0AbgBzAC4AQQBkAGQAKABuAGUAdwAgAEQAYQB0AGEAQwBvAGwAdQBtAG4AKAAiALZyAWAiACwAIAB0AHkAcABlAG8AZgAoAFMAdAByAGkAbgBnACkAKQApADsADQAKAGMAZQBsAGwARABUAC4AQwBvAGwAdQBtAG4AcwAuAEEAZABkACgAbgBlAHcAIABEAGEAdABhAEMAbwBsAHUAbQBuACgAIgDlZ+KLuk4iACwAIAB0AHkAcABlAG8AZgAoAFMAdAByAGkAbgBnACkAKQApADsADQAKAGMAZQBsAGwARABUAC4AQwBvAGwAdQBtAG4AcwAuAEEAZABkACgAbgBlAHcAIABEAGEAdABhAEMAbwBsAHUAbQBuACgAIgDRU2h50ZGdmCIALAAgAHQAeQBwAGUAbwBmACgAUwB0AHIAaQBuAGcAKQApACkAOwANAAoAYwBlAGwAbABEAFQALgBDAG8AbAB1AG0AbgBzAC4AQQBkAGQAKABuAGUAdwAgAEQAYQB0AGEAQwBvAGwAdQBtAG4AKAAiAJ9T0VNoeeNOAXjKU/dTAXgiACwAIAB0AHkAcABlAG8AZgAoAFMAdAByAGkAbgBnACkAKQApADsADQAKAHMAdAByAGkAbgBnACAAn1PRU2h5404BeMpT91MBeCAAPQAgAHMAdAByAGkAbgBnAC4ASgBvAGkAbgAoACIALQAiACwAIAAgAG4AZQB3ACAATABpAHMAdAA8AFMAdAByAGkAbgBnAD4AewBDAG8AbgB2AGUAcgB0AC4AVABvAFMAdAByAGkAbgBnACgAaQBuAHYAbwBpAGMAZQBSAG8AdwBbACIA0VNoeeNOAXgiAF0AKQAsACAAQwBvAG4AdgBlAHIAdAAuAFQAbwBTAHQAcgBpAG4AZwAoAGkAbgB2AG8AaQBjAGUAUgBvAHcAWwAiANFTaHn3UwF4IgBdACkAfQApADsADQAKAGMAZQBsAGwARABUAC4AUgBvAHcAcwAuAEEAZABkACgAaQBuAHYAbwBpAGMAZQBSAG8AdwBbACIAtnIBYCIAXQAsACAAbgB1AGwAbAAsACAAaQBuAHYAbwBpAGMAZQBSAG8AdwBbACIAAF9oedGRnZgiAF0ALgBUAG8AUwB0AHIAaQBuAGcAKAApACwAIACfU9FTaHnjTgF4ylP3UwF4KQA7AA==" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码" sap:VirtualizedContainerService.HintSize="200,58" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_37" />
                                                                              <FlowStep.Next>
                                                                                <FlowStep x:Name="__ReferenceID68" sap2010:WorkflowViewState.IdRef="FlowStep_226">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <av:Point x:Key="ShapeLocation">470,1643.5</av:Point>
                                                                                      <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                                                      <av:PointCollection x:Key="ConnectorLocation">570,1696.5 570,1763.5</av:PointCollection>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <boa:OfficeExcelSetRangeActivity AddHeaders="False" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入区域" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="OfficeExcelSetRangeActivity_10" SheetName="Sheet1">
                                                                                    <boa:OfficeExcelSetRangeActivity.InputDataTable>
                                                                                      <InArgument x:TypeArguments="sd:DataTable">
                                                                                        <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_314">cellDT</mca:CSharpValue>
                                                                                      </InArgument>
                                                                                    </boa:OfficeExcelSetRangeActivity.InputDataTable>
                                                                                    <boa:OfficeExcelSetRangeActivity.StartCell>
                                                                                      <InArgument x:TypeArguments="x:String">
                                                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_313">"N" + rowIndex</mca:CSharpValue>
                                                                                      </InArgument>
                                                                                    </boa:OfficeExcelSetRangeActivity.StartCell>
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                  </boa:OfficeExcelSetRangeActivity>
                                                                                  <FlowStep.Next>
                                                                                    <FlowStep x:Name="__ReferenceID65" sap2010:WorkflowViewState.IdRef="FlowStep_228">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <av:Point x:Key="ShapeLocation">470,1763.5</av:Point>
                                                                                          <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                                                          <av:PointCollection x:Key="ConnectorLocation">570,1816.5 570,1883.5</av:PointCollection>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <baasf:FileCopyMoveActivity ActionType="Move" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="移动发票图片到已处理" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="FileCopyMoveActivity_5" Overwrite="True">
                                                                                        <baasf:FileCopyMoveActivity.DestinationPath>
                                                                                          <InArgument x:TypeArguments="x:String">
                                                                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_312">发票已处理</mca:CSharpValue>
                                                                                          </InArgument>
                                                                                        </baasf:FileCopyMoveActivity.DestinationPath>
                                                                                        <baasf:FileCopyMoveActivity.OriginPath>
                                                                                          <InArgument x:TypeArguments="x:String">
                                                                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_311">发票图片</mca:CSharpValue>
                                                                                          </InArgument>
                                                                                        </baasf:FileCopyMoveActivity.OriginPath>
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </baasf:FileCopyMoveActivity>
                                                                                      <FlowStep.Next>
                                                                                        <FlowStep x:Name="__ReferenceID69" sap2010:WorkflowViewState.IdRef="FlowStep_225">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <av:Point x:Key="ShapeLocation">470,1883.5</av:Point>
                                                                                              <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <boa:OfficeExcelOpenOrCreateActivity OfficeVersion="{x:Null}" Password="{x:Null}" SaveAs="{x:Null}" AutoSave="True" ContinueOnError="No" CreateNewFile="False" DelayAfter="0" DelayBefore="0" DisplayName="打开 续处理excel" EnableMacro="False" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="OfficeExcelOpenOrCreateActivity_14" ReadOnly="False" Visible="False" needRestoreKey="False">
                                                                                            <boa:OfficeExcelOpenOrCreateActivity.Body>
                                                                                              <ActivityAction x:TypeArguments="x:Object">
                                                                                                <ActivityAction.Argument>
                                                                                                  <DelegateInArgument x:TypeArguments="x:Object" Name="XlWorkbook" />
                                                                                                </ActivityAction.Argument>
                                                                                                <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,209" sap2010:WorkflowViewState.IdRef="Sequence_63">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <boa:OfficeExcelSetCellActivity CellName="A1" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入单元格" sap:VirtualizedContainerService.HintSize="349,85" sap2010:WorkflowViewState.IdRef="OfficeExcelSetCellActivity_5" SheetName="续处理">
                                                                                                    <boa:OfficeExcelSetCellActivity.Text>
                                                                                                      <InArgument x:TypeArguments="x:Object">
                                                                                                        <mca:CSharpValue x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpValue`1_315">rowIndex</mca:CSharpValue>
                                                                                                      </InArgument>
                                                                                                    </boa:OfficeExcelSetCellActivity.Text>
                                                                                                  </boa:OfficeExcelSetCellActivity>
                                                                                                </Sequence>
                                                                                              </ActivityAction>
                                                                                            </boa:OfficeExcelOpenOrCreateActivity.Body>
                                                                                            <boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_316">续处理excel</mca:CSharpValue>
                                                                                              </InArgument>
                                                                                            </boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </boa:OfficeExcelOpenOrCreateActivity>
                                                                                        </FlowStep>
                                                                                      </FlowStep.Next>
                                                                                    </FlowStep>
                                                                                  </FlowStep.Next>
                                                                                </FlowStep>
                                                                              </FlowStep.Next>
                                                                            </FlowStep>
                                                                          </FlowStep.Next>
                                                                        </FlowStep>
                                                                      </FlowStep.Next>
                                                                    </FlowStep>
                                                                  </FlowDecision.True>
                                                                  <FlowDecision.False>
                                                                    <FlowDecision x:Name="__ReferenceID60" DisplayName="二手车发票类型" sap:VirtualizedContainerService.HintSize="88,87" sap2010:WorkflowViewState.IdRef="FlowDecision_64">
                                                                      <FlowDecision.Condition>
                                                                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_317">发票类型 == 二手车发票类型</mca:CSharpValue>
                                                                      </FlowDecision.Condition>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <av:Point x:Key="ShapeLocation">696,1046.5</av:Point>
                                                                          <av:Size x:Key="ShapeSize">88,87</av:Size>
                                                                          <av:PointCollection x:Key="FalseConnector">784,1090 880,1090</av:PointCollection>
                                                                          <av:PointCollection x:Key="TrueConnector">696,1090 628.5,1090 628.5,1240 658.5,1240</av:PointCollection>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <FlowDecision.True>
                                                                        <FlowStep x:Name="__ReferenceID62" sap2010:WorkflowViewState.IdRef="FlowStep_231">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <av:Point x:Key="ShapeLocation">658.5,1212.5</av:Point>
                                                                              <av:Size x:Key="ShapeSize">323,55</av:Size>
                                                                              <av:PointCollection x:Key="ConnectorLocation">820,1267.5 820,1491 570,1491 570,1521</av:PointCollection>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="323,55" sap2010:WorkflowViewState.IdRef="Assign_85" IsIgnore="False">
                                                                            <bfa:Assign.To>
                                                                              <OutArgument x:TypeArguments="x:Object">
                                                                                <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_107">invoiceRow["状态"]</mca:CSharpReference>
                                                                              </OutArgument>
                                                                            </bfa:Assign.To>
                                                                            <bfa:Assign.Value>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_318">"二手车"</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </bfa:Assign.Value>
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                          </bfa:Assign>
                                                                          <FlowStep.Next>
                                                                            <x:Reference>__ReferenceID54</x:Reference>
                                                                          </FlowStep.Next>
                                                                        </FlowStep>
                                                                      </FlowDecision.True>
                                                                      <FlowDecision.False>
                                                                        <FlowStep x:Name="__ReferenceID61" sap2010:WorkflowViewState.IdRef="FlowStep_232">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <av:Point x:Key="ShapeLocation">880,1063.5</av:Point>
                                                                              <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <baasf:WriteTextFile ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入文件" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="WriteTextFile_45" WriteOptions="AppendLine">
                                                                            <baasf:WriteTextFile.ContentToWrite>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_320">"[出错]发票查验结果出错，" + DateTime.Now.ToString() + "---" + 发票图片 + "，不是机动车或者二手车购车发票"</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </baasf:WriteTextFile.ContentToWrite>
                                                                            <baasf:WriteTextFile.FilePath>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_319">logFile</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </baasf:WriteTextFile.FilePath>
                                                                          </baasf:WriteTextFile>
                                                                        </FlowStep>
                                                                      </FlowDecision.False>
                                                                    </FlowDecision>
                                                                  </FlowDecision.False>
                                                                </FlowDecision>
                                                              </FlowDecision.False>
                                                            </FlowDecision>
                                                          </FlowDecision.True>
                                                          <FlowDecision.False>
                                                            <FlowStep x:Name="__ReferenceID58" sap2010:WorkflowViewState.IdRef="FlowStep_233">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <av:Point x:Key="ShapeLocation">690,603.5</av:Point>
                                                                  <av:Size x:Key="ShapeSize">200,53</av:Size>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <baasf:WriteTextFile ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入文件" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="WriteTextFile_46" WriteOptions="AppendLine">
                                                                <baasf:WriteTextFile.ContentToWrite>
                                                                  <InArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_322">"[出错]发票查验结果出错，" + DateTime.Now.ToString() + "---" + 发票图片 + "，错误消息：" + 识别错误信息</mca:CSharpValue>
                                                                  </InArgument>
                                                                </baasf:WriteTextFile.ContentToWrite>
                                                                <baasf:WriteTextFile.FilePath>
                                                                  <InArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_321">logFile</mca:CSharpValue>
                                                                  </InArgument>
                                                                </baasf:WriteTextFile.FilePath>
                                                              </baasf:WriteTextFile>
                                                            </FlowStep>
                                                          </FlowDecision.False>
                                                        </FlowDecision>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                  </FlowDecision.True>
                                                </FlowDecision>
                                              </FlowStep.Next>
                                            </FlowStep>
                                            <x:Reference>__ReferenceID55</x:Reference>
                                            <x:Reference>__ReferenceID56</x:Reference>
                                            <x:Reference>__ReferenceID57</x:Reference>
                                            <x:Reference>__ReferenceID58</x:Reference>
                                            <x:Reference>__ReferenceID59</x:Reference>
                                            <x:Reference>__ReferenceID60</x:Reference>
                                            <x:Reference>__ReferenceID61</x:Reference>
                                            <x:Reference>__ReferenceID62</x:Reference>
                                            <x:Reference>__ReferenceID63</x:Reference>
                                            <x:Reference>__ReferenceID64</x:Reference>
                                            <x:Reference>__ReferenceID65</x:Reference>
                                            <x:Reference>__ReferenceID66</x:Reference>
                                            <x:Reference>__ReferenceID67</x:Reference>
                                            <FlowStep x:Name="__ReferenceID70" sap2010:WorkflowViewState.IdRef="FlowStep_236">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">420,122</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,58</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">520,180 520,213.5</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <baac:InvokeCSharpCodeNoVariableActivity CSharpCode="aQBuAHYAbwBpAGMAZQBSAG8AdwAgAD0AIABpAG4AdgBvAGkAYwBlAEQAVAAuAE4AZQB3AFIAbwB3ACgAKQA7AA0ACgBpAG4AdgBvAGkAYwBlAFIAbwB3AFsAIgCPXvdTIgBdACAAPQAgAEMAbwBuAHYAZQByAHQALgBUAG8AUwB0AHIAaQBuAGcAKACPXvdTKQA7AA==" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码" sap:VirtualizedContainerService.HintSize="200,58" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_34">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </baac:InvokeCSharpCodeNoVariableActivity>
                                              <FlowStep.Next>
                                                <x:Reference>__ReferenceID51</x:Reference>
                                              </FlowStep.Next>
                                            </FlowStep>
                                            <x:Reference>__ReferenceID54</x:Reference>
                                            <x:Reference>__ReferenceID68</x:Reference>
                                            <FlowStep sap2010:WorkflowViewState.IdRef="FlowStep_235">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">730,211</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,58</av:Size>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <baac:InvokeCSharpCodeNoVariableActivity CSharpCode="cwB0AHIAaQBuAGcAIABmAGkAbABlACAAPQAgAEAAIgBDADoAXABwZVdbWFTlXVwAagBzAG8AbgAuAHQAeAB0ACIAOwANAAoA0VNoecaLK1LTfpxnIAA9ACAARgBpAGwAZQAuAFIAZQBhAGQAQQBsAGwAVABlAHgAdAAoAGYAaQBsAGUAKQA7AA==" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 假设获取到result" sap:VirtualizedContainerService.HintSize="200,58" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeNoVariableActivity_35">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </baac:InvokeCSharpCodeNoVariableActivity>
                                            </FlowStep>
                                            <x:Reference>__ReferenceID69</x:Reference>
                                          </Flowchart>
                                        </bfa:TryCatch.Try>
                                        <bfa:TryCatch.Catches>
                                          <bfa:Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1362,156" sap2010:WorkflowViewState.IdRef="Catch`1_23">
                                            <bfa:Catch.Action>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                </ActivityAction.Argument>
                                                <baasf:WriteTextFile ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入文件" sap:VirtualizedContainerService.HintSize="349,85" sap2010:WorkflowViewState.IdRef="WriteTextFile_47" WriteOptions="AppendLine">
                                                  <baasf:WriteTextFile.ContentToWrite>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_325">"[出错]发票识别及查验，" + DateTime.Now.ToString() + "---" + 发票图片 + "，错误消息：" + exception.Message</mca:CSharpValue>
                                                    </InArgument>
                                                  </baasf:WriteTextFile.ContentToWrite>
                                                  <baasf:WriteTextFile.FilePath>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_324">logFile</mca:CSharpValue>
                                                    </InArgument>
                                                  </baasf:WriteTextFile.FilePath>
                                                </baasf:WriteTextFile>
                                              </ActivityAction>
                                            </bfa:Catch.Action>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </bfa:Catch>
                                        </bfa:TryCatch.Catches>
                                      </bfa:TryCatch>
                                    </bfa:If.Then>
                                  </bfa:If>
                                  <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="1613,55" sap2010:WorkflowViewState.IdRef="Assign_86" IsIgnore="False">
                                    <bfa:Assign.To>
                                      <OutArgument x:TypeArguments="x:Int32">
                                        <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_103">rowIndex</mca:CSharpReference>
                                      </OutArgument>
                                    </bfa:Assign.To>
                                    <bfa:Assign.Value>
                                      <InArgument x:TypeArguments="x:Int32">
                                        <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_326">rowIndex + 1</mca:CSharpValue>
                                      </InArgument>
                                    </bfa:Assign.Value>
                                  </bfa:Assign>
                                </Sequence>
                              </bfa:While>
                            </Sequence>
                          </ActivityAction>
                        </boa:OfficeExcelOpenOrCreateActivity.Body>
                        <boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                          <InArgument x:TypeArguments="x:String">
                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_235">invoiceFiles[0]</mca:CSharpValue>
                          </InArgument>
                        </boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </boa:OfficeExcelOpenOrCreateActivity>
                    </FlowStep>
                    <FlowStep x:Name="__ReferenceID76" sap2010:WorkflowViewState.IdRef="FlowStep_196">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">200,133.5</av:Point>
                          <av:Size x:Key="ShapeSize">200,53</av:Size>
                          <av:PointCollection x:Key="ConnectorLocation">300,186.5 300,263.5</av:PointCollection>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Flowchart DisplayName="续处理excel，获取上一次中断结果" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="Flowchart_29">
                        <Flowchart.Variables>
                          <Variable x:TypeArguments="x:Boolean" Name="fileExist" />
                        </Flowchart.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                            <av:Size x:Key="ShapeSize">60,75</av:Size>
                            <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,127.5</av:PointCollection>
                            <x:Double x:Key="Width">616</x:Double>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Flowchart.StartNode>
                          <x:Reference>__ReferenceID73</x:Reference>
                        </Flowchart.StartNode>
                        <FlowStep x:Name="__ReferenceID73" sap2010:WorkflowViewState.IdRef="FlowStep_194">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">200,127.5</av:Point>
                              <av:Size x:Key="ShapeSize">200,53</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">300,180.5 300,230.5</av:PointCollection>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <baasf:PathExistsActivity ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="文件是否存在" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="PathExistsActivity_8" InputType="File">
                            <baasf:PathExistsActivity.Exists>
                              <OutArgument x:TypeArguments="x:Boolean">
                                <mca:CSharpReference x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpReference`1_71">fileExist</mca:CSharpReference>
                              </OutArgument>
                            </baasf:PathExistsActivity.Exists>
                            <baasf:PathExistsActivity.InputPath>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_230">续处理excel</mca:CSharpValue>
                              </InArgument>
                            </baasf:PathExistsActivity.InputPath>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </baasf:PathExistsActivity>
                          <FlowStep.Next>
                            <FlowDecision x:Name="__ReferenceID71" DisplayName="文件存在" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_55">
                              <FlowDecision.Condition>
                                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_231">fileExist</mca:CSharpValue>
                              </FlowDecision.Condition>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  <av:Point x:Key="ShapeLocation">265,230.5</av:Point>
                                  <av:Size x:Key="ShapeSize">70,87</av:Size>
                                  <av:PointCollection x:Key="FalseConnector">335,274 365,274 365,270 400,270</av:PointCollection>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <FlowDecision.False>
                                <FlowStep x:Name="__ReferenceID72" sap2010:WorkflowViewState.IdRef="FlowStep_193">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">400,243.5</av:Point>
                                      <av:Size x:Key="ShapeSize">200,53</av:Size>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <baasf:CreateActivity ContinueOnError="No" CreationType="File" DelayAfter="0" DelayBefore="0" DisplayName="新建文件 续处理excel" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="CreateActivity_4">
                                    <baasf:CreateActivity.CreationPath>
                                      <InArgument x:TypeArguments="x:String">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_232">续处理excel</mca:CSharpValue>
                                      </InArgument>
                                    </baasf:CreateActivity.CreationPath>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </baasf:CreateActivity>
                                </FlowStep>
                              </FlowDecision.False>
                            </FlowDecision>
                          </FlowStep.Next>
                        </FlowStep>
                        <x:Reference>__ReferenceID71</x:Reference>
                        <x:Reference>__ReferenceID72</x:Reference>
                      </Flowchart>
                      <FlowStep.Next>
                        <FlowStep x:Name="__ReferenceID75" sap2010:WorkflowViewState.IdRef="FlowStep_241">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">200,263.5</av:Point>
                              <av:Size x:Key="ShapeSize">200,53</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">300,316.5 300,373.5</av:PointCollection>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <boa:OfficeExcelOpenOrCreateActivity OfficeVersion="{x:Null}" Password="{x:Null}" SaveAs="{x:Null}" AutoSave="True" ContinueOnError="No" CreateNewFile="False" DelayAfter="0" DelayBefore="0" DisplayName="打开 续处理excel" EnableMacro="False" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="OfficeExcelOpenOrCreateActivity_15" ReadOnly="False" Visible="False" needRestoreKey="False">
                            <boa:OfficeExcelOpenOrCreateActivity.Body>
                              <ActivityAction x:TypeArguments="x:Object">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="x:Object" Name="XlWorkbook" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,277" sap2010:WorkflowViewState.IdRef="Sequence_64">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <boa:OfficeExcelReadCellActivity CellName="A1" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="读取单元格" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="OfficeExcelReadCellActivity_6" PreserveFormat="True" SheetName="续处理">
                                    <boa:OfficeExcelReadCellActivity.CellValue>
                                      <OutArgument x:TypeArguments="x:Object">
                                        <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_108">lastTimeIndexObj</mca:CSharpReference>
                                      </OutArgument>
                                    </boa:OfficeExcelReadCellActivity.CellValue>
                                  </boa:OfficeExcelReadCellActivity>
                                  <bfa:Assign ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="349,55" sap2010:WorkflowViewState.IdRef="Assign_87" IsIgnore="False">
                                    <bfa:Assign.To>
                                      <OutArgument x:TypeArguments="x:Int32">
                                        <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_109">rowIndex</mca:CSharpReference>
                                      </OutArgument>
                                    </bfa:Assign.To>
                                    <bfa:Assign.Value>
                                      <InArgument x:TypeArguments="x:Int32">
                                        <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_329">(lastTimeIndexObj !=null) ? (Convert.ToInt32(lastTimeIndexObj)+1) : 2</mca:CSharpValue>
                                      </InArgument>
                                    </bfa:Assign.Value>
                                  </bfa:Assign>
                                </Sequence>
                              </ActivityAction>
                            </boa:OfficeExcelOpenOrCreateActivity.Body>
                            <boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_330">续处理excel</mca:CSharpValue>
                              </InArgument>
                            </boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </boa:OfficeExcelOpenOrCreateActivity>
                          <FlowStep.Next>
                            <x:Reference>__ReferenceID74</x:Reference>
                          </FlowStep.Next>
                        </FlowStep>
                      </FlowStep.Next>
                    </FlowStep>
                    <x:Reference>__ReferenceID75</x:Reference>
                  </Flowchart>
                </FlowStep>
              </Flowchart>
            </FlowStep>
          </FlowStep.Next>
        </FlowStep>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID78</x:Reference>
    <x:Reference>__ReferenceID79</x:Reference>
  </Flowchart>
</Activity>