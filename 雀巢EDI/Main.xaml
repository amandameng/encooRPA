<Activity mc:Ignorable="sap sap2010 sads" x:Class="EncooWorkflow.Main" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:baast="clr-namespace:BotTime.ActivityLibrary.Activities.System.Tool;assembly=BotTime.ActivityLibrary" xmlns:bda="clr-namespace:BotTime.DataBase.Activity;assembly=BotTime.DataBase.Activity" xmlns:bfa="clr-namespace:BotTime.Flow.Activities;assembly=BotTime.Flow.Activities" xmlns:boa="clr-namespace:BotTime.Office.Activity;assembly=BotTime.Office.Activity" xmlns:eae="clr-namespace:Encootech.ActivityCommon.EncooCommonActivity;assembly=ActivityCommon" xmlns:eca="clr-namespace:Encoo.Console.Activity;assembly=Encoo.Console.Activity" xmlns:ecaac="clr-namespace:Encoo.CodeTool.Activity.Activities.CSharp;assembly=Encoo.CodeTool.Activity" xmlns:ecaac1="clr-namespace:Encoo.CodeTool.Activity.Activities.Collection;assembly=Encoo.CodeTool.Activity" xmlns:ecaad="clr-namespace:Encoo.CodeTool.Activity.Activities.Dictionary;assembly=Encoo.CodeTool.Activity" xmlns:ecam="clr-namespace:Encoo.CodeTool.Activity.Models;assembly=Encoo.CodeTool.Activity" xmlns:mca="clr-namespace:Microsoft.CSharp.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:this="clr-namespace:EncooWorkflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:sads="http://schemas.microsoft.com/netfx/2010/xaml/activities/debugger">
  <x:Members>
    <x:Property sap2010:Annotation.AnnotationText="EDI 进TEST环境还是正式环境" Name="is_edi_production" Type="InArgument(x:Boolean)" />
    <x:Property sap2010:Annotation.AnnotationText="if Ture 则流程部署的时候只处理数据库表（edi_customer_switcher）中`OnLine_on`为1的客户&#xA;else 测试（edi_customer_switcher）中`UAT_on`为1的客户,&#xA;修改POnumber + “-test”" Name="is_Online" Type="InArgument(x:Boolean)" />
    <x:Property sap2010:Annotation.AnnotationText="从低代上传pending的订单文件，触发流程再次运行。pending的需要查询order_job_history中edi_sent=-1的数据，&quot;EDI-文件/exception_edi_637800314376106587.xlsx&quot;" Name="pending订单文件" Type="InArgument(x:String)" />
    <x:Property sap2010:Annotation.AnnotationText="为true则使用本地的EDI文件夹" Name="本地测试" Type="InArgument(x:Boolean)" />
    <x:Property sap2010:Annotation.AnnotationText="为true则解析本地的文件" Name="上传文件来自本地测试" Type="InArgument(x:Boolean)" />
    <x:Property Name="gapDays" Type="InArgument(x:Int32)" />
  </x:Members>
  <this:Main.is_edi_production>
    <InArgument x:TypeArguments="x:Boolean">
      <Literal x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="Literal`1_127" Value="True" />
    </InArgument>
  </this:Main.is_edi_production>
  <this:Main.is_Online>
    <InArgument x:TypeArguments="x:Boolean">
      <Literal x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="Literal`1_55" />
    </InArgument>
  </this:Main.is_Online>
  <this:Main.本地测试>
    <InArgument x:TypeArguments="x:Boolean">
      <Literal x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="Literal`1_114" Value="True" />
    </InArgument>
  </this:Main.本地测试>
  <this:Main.上传文件来自本地测试>
    <InArgument x:TypeArguments="x:Boolean">
      <Literal x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="Literal`1_123" />
    </InArgument>
  </this:Main.上传文件来自本地测试>
  <this:Main.gapDays>
    <InArgument x:TypeArguments="x:Int32">
      <Literal x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="Literal`1_128" Value="2" />
    </InArgument>
  </this:Main.gapDays>
  <sap2010:ExpressionActivityEditor.ExpressionActivityEditor>C#</sap2010:ExpressionActivityEditor.ExpressionActivityEditor>
  <sap:VirtualizedContainerService.HintSize>654,860</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>EncooWorkflow.Workflow_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="20">
      <x:String>System.Xml</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>BotTime.DataBase.Activity</x:String>
      <x:String>Encoo.CodeTool.Activity.Activities.CSharp</x:String>
      <x:String>Microsoft.CSharp.Activities</x:String>
      <x:String>BotTime.Flow.Activities</x:String>
      <x:String>BotTime.ActivityLibrary.Activities.System.Tool</x:String>
      <x:String>System.Text</x:String>
      <x:String>System.IO</x:String>
      <x:String>System</x:String>
      <x:String>BotTime.Office.Activity</x:String>
      <x:String>Encoo.Console.Activity</x:String>
      <x:String>Encootech.ActivityCommon.EncooCommonActivity</x:String>
      <x:String>Encoo.CodeTool.Activity.Activities.Collection</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>Encoo.CodeTool.Activity.Activities.Dictionary</x:String>
      <x:String>Encoo.CodeTool.Activity.Models</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>netstandard</AssemblyReference>
      <AssemblyReference>BotTime.DataBase.Activity</AssemblyReference>
      <AssemblyReference>Encoo.CodeTool.Activity</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>BotTime.Flow.Activities</AssemblyReference>
      <AssemblyReference>BotTime.ActivityLibrary</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.Globalization.Extensions</AssemblyReference>
      <AssemblyReference>System.Net.WebSockets.Client.Managed</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>ParallelExtensionsExtras</AssemblyReference>
      <AssemblyReference>System.Text.Encoding.CodePages</AssemblyReference>
      <AssemblyReference>BotTime.Office.Activity</AssemblyReference>
      <AssemblyReference>Encoo.Console.Activity</AssemblyReference>
      <AssemblyReference>ActivityCommon</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <Flowchart sap2010:Annotation.AnnotationText="1、按格式生成Edi_timestamp.csv文件&#xA;2、将文件放到指定的EDI send文件夹&#xA;3、根据Edi Sent 文件夹状态，判断文件是否上传完成&#xA;4、更新order_history 对应order的edit_sent 状态值和时间&#xA;5、根据mail setting 设置的edi邮箱，发送运行结果&#xA;note：&#xA;数据库连接从控制台获取&#xA;" DisplayName="流程图_Root" sap:VirtualizedContainerService.HintSize="614,780" sap2010:WorkflowViewState.IdRef="Flowchart_1">
    <Flowchart.Variables>
      <Variable x:TypeArguments="x:String" sap2010:Annotation.AnnotationText="查找散威化产品码" Name="bulkProductsSql" />
      <Variable x:TypeArguments="x:String" sap2010:Annotation.AnnotationText="沃尔玛 包含散威化产品的订单" Name="excelToOrderQueryForWMSql" />
      <Variable x:TypeArguments="x:String" sap2010:Annotation.AnnotationText="需要发送EDI的 excel To Order 信息" Name="excelToOrderQueryForAllSql" />
      <Variable x:TypeArguments="sd:DataTable" Name="allToDoEx2oDT" />
      <Variable x:TypeArguments="sd:DataTable" Name="ediDT" />
      <Variable x:TypeArguments="x:String" Name="connectionFolder" />
      <Variable x:TypeArguments="x:Boolean" Name="ediStatus">
        <Variable.Default>
          <Literal x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="Literal`1_18" Value="True" />
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="x:String" Name="ediMessage" />
      <Variable x:TypeArguments="x:String" Name="邮件主题" />
      <Variable x:TypeArguments="x:String" Name="邮件正文" />
      <Variable x:TypeArguments="x:String" sap2010:Annotation.AnnotationText="EDI 邮件反馈" Name="ediMailReceiver" />
      <Variable x:TypeArguments="x:String" Name="邮件正文模板成功" />
      <Variable x:TypeArguments="x:String" Name="邮件正文模板失败" />
      <Variable x:TypeArguments="sd:DataTable" Name="mailSettingDT" />
      <Variable x:TypeArguments="x:String" Name="mailSettingEdiSQL" />
      <Variable x:TypeArguments="x:String" Name="dev_email">
        <Variable.Default>
          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_104">mengfanling@encootech.com</Literal>
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="x:String" Name="数据库连接" />
      <Variable x:TypeArguments="sd:DataTable" Name="soldToShipToTestDT" />
      <Variable x:TypeArguments="sd:DataTable" Name="materialCodeTestDT" />
      <Variable x:TypeArguments="sd:DataTable" Name="validEdiCustomerDT" />
      <Variable x:TypeArguments="x:String" Name="currentProjectSourcePath" />
      <Variable x:TypeArguments="x:String" Name="pending订单路径" />
      <Variable x:TypeArguments="sd:DataTable" Name="pendingJobDT" />
      <Variable x:TypeArguments="scg:List(x:String)" Name="notMatchedOrders">
        <Variable.Default>
          <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_212">[new List&lt;string&gt;{}]</mca:CSharpValue>
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="x:String" Name="mailSettingExceptionEdiSQL" />
      <Variable x:TypeArguments="sd:DataTable" Name="mailSettingExceptionDT" />
      <Variable x:TypeArguments="x:String" Name="orderCategoryPositive">
        <Variable.Default>
          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_92">EDI Positive Feedback</Literal>
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="x:String" Name="orderCategoryException">
        <Variable.Default>
          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_93">EDI Exception Feedback</Literal>
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="exceptionEdiEmailDic" />
      <Variable x:TypeArguments="sd:DataTable" Name="allExceptionOrdersDT" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" sap2010:Annotation.AnnotationText="key: customer_name&#xA;value: exception File" Name="customerExceptionFileDic">
        <Variable.Default>
          <mca:CSharpValue x:TypeArguments="scg:Dictionary(x:String, x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_266">[new Dictionary&lt;string,string&gt;()]</mca:CSharpValue>
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="scg:Dictionary(x:String, sd:DataTable)" sap2010:Annotation.AnnotationText="key: customer&#xA;Value: exception DT" Name="customerExceptionDTDic" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, sd:DataTable)" Name="customerExceptionDTReasonDic" />
      <Variable x:TypeArguments="x:String" Name="ex2O原始文件" />
      <Variable x:TypeArguments="x:Int64" Name="timeNowTicks" />
      <Variable x:TypeArguments="x:String" Name="activeCustomerNames" />
      <Variable x:TypeArguments="x:String" sap2010:Annotation.AnnotationText="EDI file Sent out" Name="ediFileSentPath" />
    </Flowchart.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
        <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
        <av:Size x:Key="ShapeSize">80,48</av:Size>
        <av:PointCollection x:Key="ConnectorLocation">310,50.5 310,100.5</av:PointCollection>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart.StartNode>
      <x:Reference>__ReferenceID2</x:Reference>
    </Flowchart.StartNode>
    <FlowStep x:Name="__ReferenceID2" sap2010:WorkflowViewState.IdRef="FlowStep_3">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">210,100.5</av:Point>
          <av:Size x:Key="ShapeSize">200,53</av:Size>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <bfa:TryCatch ActivityName="错误捕获（Try Catch）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="错误捕获 - 全局捕获" sap:VirtualizedContainerService.HintSize="690,7285" sap2010:WorkflowViewState.IdRef="TryCatch_1" IsIgnore="False">
        <bfa:TryCatch.Variables>
          <Variable x:TypeArguments="x:String" Name="notMatchedOrdersStr" />
        </bfa:TryCatch.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <bfa:TryCatch.Try>
          <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="672,7048" sap2010:WorkflowViewState.IdRef="Sequence_11">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ecaac:InvokeCSharpCodeActivity ActivityName="执行C#代码" sap2010:Annotation.AnnotationText="1、Edi 文件夹定义&#xA;2、SQL 定义" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 - 初始化设置" sap:VirtualizedContainerService.HintSize="650,135" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeActivity_5">
              <ecaac:InvokeCSharpCodeActivity.CodeFilePath>
                <InArgument x:TypeArguments="x:String">
                  <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_27">.code\CSharp\执行CSharp代码-初始化设置.cs</Literal>
                </InArgument>
              </ecaac:InvokeCSharpCodeActivity.CodeFilePath>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ecaac:InvokeCSharpCodeActivity>
            <bfa:TryCatch ActivityName="错误捕获（Try Catch）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="错误捕获 - 获取数据库连接" sap:VirtualizedContainerService.HintSize="650,53" sap2010:WorkflowViewState.IdRef="TryCatch_2" IsIgnore="False">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <bfa:TryCatch.Try>
                <eca:AcquireAssetsActivity ResourceGroup="{x:Null}" TenantId="{x:Null}" ActivityName="获取资产" ConsoleVersion="V4Console" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="获取资产 - 数据库连接" sap:VirtualizedContainerService.HintSize="200,64" sap2010:WorkflowViewState.IdRef="AcquireAssetsActivity_1">
                  <eca:AcquireAssetsActivity.AssetName>
                    <InArgument x:TypeArguments="x:String">
                      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_82">数据库</Literal>
                    </InArgument>
                  </eca:AcquireAssetsActivity.AssetName>
                  <eca:AcquireAssetsActivity.AssetValue>
                    <OutArgument x:TypeArguments="x:String">
                      <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_38">[数据库连接]</mca:CSharpReference>
                    </OutArgument>
                  </eca:AcquireAssetsActivity.AssetValue>
                  <eca:AcquireAssetsActivity.AssetsNames>
                    <scg:List x:TypeArguments="x:String" Capacity="4">
                      <x:String>发件人密码</x:String>
                      <x:String>数据库</x:String>
                      <x:String>超级鹰账号密码软件ID</x:String>
                    </scg:List>
                  </eca:AcquireAssetsActivity.AssetsNames>
                  <eca:AcquireAssetsActivity.ResourceGroupName>
                    <InArgument x:TypeArguments="x:String">
                      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_81" xml:space="preserve">雀巢（中国）有限公司/Customer Supply Chain </Literal>
                    </InArgument>
                  </eca:AcquireAssetsActivity.ResourceGroupName>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </eca:AcquireAssetsActivity>
              </bfa:TryCatch.Try>
              <bfa:TryCatch.Catches>
                <bfa:Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="483,23" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                  <bfa:Catch.Action>
                    <ActivityAction x:TypeArguments="s:Exception">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="477,373" sap2010:WorkflowViewState.IdRef="Sequence_25">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 数据库连接=local" sap:VirtualizedContainerService.HintSize="455,58" sap2010:WorkflowViewState.IdRef="Assign_26" IsIgnore="False">
                          <bfa:Assign.To>
                            <OutArgument x:TypeArguments="x:String">
                              <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_39">[数据库连接]</mca:CSharpReference>
                            </OutArgument>
                          </bfa:Assign.To>
                          <bfa:Assign.Value>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_156">["Server=127.0.0.1;Database=vicode_nestle; Uid=root;Password=123456Q"]</mca:CSharpValue>
                            </InArgument>
                          </bfa:Assign.Value>
                        </bfa:Assign>
                        <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="455,58" sap2010:WorkflowViewState.IdRef="LogActivity_10" Level="Info">
                          <baast:LogActivity.LogContent>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_220">[System.Convert.ToString(exception.Message)]</mca:CSharpValue>
                            </InArgument>
                          </baast:LogActivity.LogContent>
                        </baast:LogActivity>
                        <eae:CommentActivity DisplayName="注释掉" sap:VirtualizedContainerService.HintSize="455,53" sap2010:WorkflowViewState.IdRef="CommentActivity_4">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 数据库连接=prod测试" sap:VirtualizedContainerService.HintSize="323,58" sap2010:WorkflowViewState.IdRef="Assign_27" IsIgnore="False">
                            <bfa:Assign.To>
                              <OutArgument x:TypeArguments="x:String">
                                <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_46">[数据库连接]</mca:CSharpReference>
                              </OutArgument>
                            </bfa:Assign.To>
                            <bfa:Assign.Value>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_166">["Server=1.15.243.91;Database=vicode_nestle; Uid=nestle;Password=encoo@123456"]</mca:CSharpValue>
                              </InArgument>
                            </bfa:Assign.Value>
                          </bfa:Assign>
                        </eae:CommentActivity>
                      </Sequence>
                    </ActivityAction>
                  </bfa:Catch.Action>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </bfa:Catch>
              </bfa:TryCatch.Catches>
            </bfa:TryCatch>
            <bda:DatabaseConnectActivity ActivityName="连接数据库" sap2010:Annotation.AnnotationText="结合 excel_to_order 表和 order_job_history 表&#xA;TODO：&#xA;1、山姆水修改的订单是否重复进EDI 答：不进&#xA;2、散威化的订单，是订单下所有ITEMS进EDI还是仅散威化产品 答：所有ITEMS&#xA;3、mail_setting 数据检查" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="连接数据库 - 查询待处理的exceltoOrder数据" sap:VirtualizedContainerService.HintSize="650,3076" sap2010:WorkflowViewState.IdRef="DatabaseConnectActivity_2" ProviderName="MySql">
              <bda:DatabaseConnectActivity.Body>
                <ActivityAction x:TypeArguments="x:Object">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:Object" Name="DataBaseScope" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="636,2875" sap2010:WorkflowViewState.IdRef="Sequence_18">
                    <Sequence.Variables>
                      <Variable x:TypeArguments="sd:DataTable" Name="bulkProductCodesDT" />
                      <Variable x:TypeArguments="sd:DataTable" Name="wmNestleBulkDT" />
                      <Variable x:TypeArguments="x:String" Name="ex2oToEdiQuery" />
                      <Variable x:TypeArguments="x:String" Name="pendingOrderJHSql" />
                    </Sequence.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <bda:QueryTableActivity ActivityName="查询语句" sap2010:Annotation.AnnotationText="EDI positive feedback" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - mail_setting - EDI positive feedback" sap:VirtualizedContainerService.HintSize="614,47" sap2010:WorkflowViewState.IdRef="QueryTableActivity_8">
                      <bda:QueryTableActivity.DataTable>
                        <OutArgument x:TypeArguments="sd:DataTable">
                          <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_29">[mailSettingDT]</mca:CSharpReference>
                        </OutArgument>
                      </bda:QueryTableActivity.DataTable>
                      <bda:QueryTableActivity.ExecuteTimeOut>
                        <InArgument x:TypeArguments="x:TimeSpan">
                          <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_37" Value="00:00:30" />
                        </InArgument>
                      </bda:QueryTableActivity.ExecuteTimeOut>
                      <bda:QueryTableActivity.Sql>
                        <InArgument x:TypeArguments="x:String">
                          <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_114">[System.Convert.ToString(mailSettingEdiSQL)]</mca:CSharpValue>
                        </InArgument>
                      </bda:QueryTableActivity.Sql>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </bda:QueryTableActivity>
                    <bda:QueryTableActivity ActivityName="查询语句" sap2010:Annotation.AnnotationText="EDI Exception feedback" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - mail_setting - EDI Exception feedback" sap:VirtualizedContainerService.HintSize="614,47" sap2010:WorkflowViewState.IdRef="QueryTableActivity_15">
                      <bda:QueryTableActivity.DataTable>
                        <OutArgument x:TypeArguments="sd:DataTable">
                          <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_65">[mailSettingExceptionDT]</mca:CSharpReference>
                        </OutArgument>
                      </bda:QueryTableActivity.DataTable>
                      <bda:QueryTableActivity.ExecuteTimeOut>
                        <InArgument x:TypeArguments="x:TimeSpan">
                          <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_94" Value="00:00:30" />
                        </InArgument>
                      </bda:QueryTableActivity.ExecuteTimeOut>
                      <bda:QueryTableActivity.Sql>
                        <InArgument x:TypeArguments="x:String">
                          <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_225">[System.Convert.ToString(mailSettingExceptionEdiSQL)]</mca:CSharpValue>
                        </InArgument>
                      </bda:QueryTableActivity.Sql>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </bda:QueryTableActivity>
                    <bda:QueryTableActivity ActivityName="查询语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - edi Customer switcher" sap:VirtualizedContainerService.HintSize="614,22" sap2010:WorkflowViewState.IdRef="QueryTableActivity_13">
                      <bda:QueryTableActivity.DataTable>
                        <OutArgument x:TypeArguments="sd:DataTable">
                          <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_47">[validEdiCustomerDT]</mca:CSharpReference>
                        </OutArgument>
                      </bda:QueryTableActivity.DataTable>
                      <bda:QueryTableActivity.ExecuteTimeOut>
                        <InArgument x:TypeArguments="x:TimeSpan">
                          <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_57" Value="00:00:30" />
                        </InArgument>
                      </bda:QueryTableActivity.ExecuteTimeOut>
                      <bda:QueryTableActivity.Sql>
                        <InArgument x:TypeArguments="x:String">
                          <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_168">[System.Convert.ToString(string.Format("select * from edi_customer_switcher where {0} != '0'", is_Online ? "OnLine_on" : "UAT_on"))]</mca:CSharpValue>
                        </InArgument>
                      </bda:QueryTableActivity.Sql>
                    </bda:QueryTableActivity>
                    <bfa:If ActivityName="条件（If）" sap2010:Annotation.AnnotationText="没有待测试的用户则抛出无客户异常" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 存在需要上线测试的EDI的客户）" sap:VirtualizedContainerService.HintSize="614,95" sap2010:WorkflowViewState.IdRef="If_19" IsIgnore="False">
                      <bfa:If.Condition>
                        <InArgument x:TypeArguments="x:Boolean">
                          <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_200">[validEdiCustomerDT==null || validEdiCustomerDT.Rows.Count == 0]</mca:CSharpValue>
                        </InArgument>
                      </bfa:If.Condition>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <bfa:If.Then>
                        <bfa:Throw DisplayName="抛出异常 - 没有客户开启EDI传输" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_6">
                          <InArgument x:TypeArguments="s:Exception">
                            <mca:CSharpValue x:TypeArguments="s:Exception" sap2010:WorkflowViewState.IdRef="CSharpValue`1_174">[new Exception("没有客户开启EDI，请到低代平台维护完成相应的配置后重试")]</mca:CSharpValue>
                          </InArgument>
                        </bfa:Throw>
                      </bfa:If.Then>
                    </bfa:If>
                    <ecaac:InvokeCSharpCodeActivity ActivityName="执行C#代码" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 - 根据客户动态生成Ex2O查询语句" sap:VirtualizedContainerService.HintSize="614,93" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeActivity_10">
                      <ecaac:InvokeCSharpCodeActivity.CodeFilePath>
                        <InArgument x:TypeArguments="x:String">
                          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_72">.code\CSharp\执行CSharp代码-生成ex2o查询语句.cs</Literal>
                        </InArgument>
                      </ecaac:InvokeCSharpCodeActivity.CodeFilePath>
                    </ecaac:InvokeCSharpCodeActivity>
                    <bfa:If ActivityName="条件（If）" sap2010:Annotation.AnnotationText="if 不存在pending文件&#xA;  根据表order_job_history查询待处理数据" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 不存在pending订单文件）" sap:VirtualizedContainerService.HintSize="614,2247" sap2010:WorkflowViewState.IdRef="If_26" IsIgnore="False">
                      <bfa:If.Condition>
                        <InArgument x:TypeArguments="x:Boolean">
                          <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_201">[string.IsNullOrEmpty(pending订单文件)]</mca:CSharpValue>
                        </InArgument>
                      </bfa:If.Condition>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <bfa:If.Then>
                        <Sequence DisplayName="序列 - 查询edi待处理的客户" sap:VirtualizedContainerService.HintSize="596,2017" sap2010:WorkflowViewState.IdRef="Sequence_32">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 散威化查询语句不为空）" sap:VirtualizedContainerService.HintSize="574,1691" sap2010:WorkflowViewState.IdRef="If_20" IsIgnore="False">
                            <bfa:If.Condition>
                              <InArgument x:TypeArguments="x:Boolean">
                                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_172">[!string.IsNullOrEmpty(bulkProductsSql) &amp;&amp; !string.IsNullOrEmpty(excelToOrderQueryForWMSql)]</mca:CSharpValue>
                              </InArgument>
                            </bfa:If.Condition>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <bfa:If.Then>
                              <Sequence DisplayName="序列 - 沃尔玛散威化已开启" sap:VirtualizedContainerService.HintSize="556,1503" sap2010:WorkflowViewState.IdRef="Sequence_26">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <bda:QueryTableActivity ActivityName="查询语句" sap2010:Annotation.AnnotationText="查找沃尔玛散威化，雀巢码&#xA;Query:&#xA;  select group_concat(nestle_code_allocation) from nestle_bulk_walfer_config where Customer_Name='沃尔玛'&#xA;Return：&#xA;12458252,12458087,12458320,12458252,12458087,12458320" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - 散威化产品，雀巢码" sap:VirtualizedContainerService.HintSize="534,234" sap2010:WorkflowViewState.IdRef="QueryTableActivity_9">
                                  <bda:QueryTableActivity.DataTable>
                                    <OutArgument x:TypeArguments="sd:DataTable">
                                      <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_30">[bulkProductCodesDT]</mca:CSharpReference>
                                    </OutArgument>
                                  </bda:QueryTableActivity.DataTable>
                                  <bda:QueryTableActivity.ExecuteTimeOut>
                                    <InArgument x:TypeArguments="x:TimeSpan">
                                      <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_38" Value="00:00:30" />
                                    </InArgument>
                                  </bda:QueryTableActivity.ExecuteTimeOut>
                                  <bda:QueryTableActivity.Sql>
                                    <InArgument x:TypeArguments="x:String">
                                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_115">[System.Convert.ToString(bulkProductsSql)]</mca:CSharpValue>
                                    </InArgument>
                                  </bda:QueryTableActivity.Sql>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </bda:QueryTableActivity>
                                <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 散威化码存在）" sap:VirtualizedContainerService.HintSize="534,572" sap2010:WorkflowViewState.IdRef="If_15" IsIgnore="False">
                                  <bfa:If.Condition>
                                    <InArgument x:TypeArguments="x:Boolean">
                                      <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_116">[bulkProductCodesDT!=null &amp;&amp; bulkProductCodesDT.Rows.Count &gt; 0]</mca:CSharpValue>
                                    </InArgument>
                                  </bfa:If.Condition>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <bfa:If.Then>
                                    <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,384" sap2010:WorkflowViewState.IdRef="Sequence_19">
                                      <Sequence.Variables>
                                        <Variable x:TypeArguments="x:String" Name="bulkOrderNumbersSql" />
                                      </Sequence.Variables>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - bulkOrderNumbersSql" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_22" IsIgnore="False">
                                        <bfa:Assign.To>
                                          <OutArgument x:TypeArguments="x:String">
                                            <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_33">[bulkOrderNumbersSql]</mca:CSharpReference>
                                          </OutArgument>
                                        </bfa:Assign.To>
                                        <bfa:Assign.Value>
                                          <InArgument x:TypeArguments="x:String">
                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_145">[string.Format(excelToOrderQueryForWMSql, bulkProductCodesDT.Rows[0]["nestleCodes"].ToString())]</mca:CSharpValue>
                                          </InArgument>
                                        </bfa:Assign.Value>
                                      </bfa:Assign>
                                      <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志 - bulkOrderNumbersSql" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_4" Level="Info">
                                        <baast:LogActivity.LogContent>
                                          <InArgument x:TypeArguments="x:String">
                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_146">[System.Convert.ToString(bulkOrderNumbersSql)]</mca:CSharpValue>
                                          </InArgument>
                                        </baast:LogActivity.LogContent>
                                      </baast:LogActivity>
                                      <bda:QueryTableActivity ActivityName="查询语句" sap2010:Annotation.AnnotationText="包含散威化的edi_sent为null的数据" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - WM bulk order codes" sap:VirtualizedContainerService.HintSize="349,64" sap2010:WorkflowViewState.IdRef="QueryTableActivity_12">
                                        <bda:QueryTableActivity.DataTable>
                                          <OutArgument x:TypeArguments="sd:DataTable">
                                            <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_34">[wmNestleBulkDT]</mca:CSharpReference>
                                          </OutArgument>
                                        </bda:QueryTableActivity.DataTable>
                                        <bda:QueryTableActivity.ExecuteTimeOut>
                                          <InArgument x:TypeArguments="x:TimeSpan">
                                            <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_41" Value="00:00:30" />
                                          </InArgument>
                                        </bda:QueryTableActivity.ExecuteTimeOut>
                                        <bda:QueryTableActivity.Sql>
                                          <InArgument x:TypeArguments="x:String">
                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_147">[System.Convert.ToString(bulkOrderNumbersSql)]</mca:CSharpValue>
                                          </InArgument>
                                        </bda:QueryTableActivity.Sql>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </bda:QueryTableActivity>
                                    </Sequence>
                                  </bfa:If.Then>
                                  <bfa:If.Else>
                                    <bda:QueryTableActivity ActivityName="查询语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - WM bulk order codes" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="QueryTableActivity_11">
                                      <bda:QueryTableActivity.DataTable>
                                        <OutArgument x:TypeArguments="sd:DataTable">
                                          <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_32">[wmNestleBulkDT]</mca:CSharpReference>
                                        </OutArgument>
                                      </bda:QueryTableActivity.DataTable>
                                      <bda:QueryTableActivity.ExecuteTimeOut>
                                        <InArgument x:TypeArguments="x:TimeSpan">
                                          <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_40" Value="00:00:30" />
                                        </InArgument>
                                      </bda:QueryTableActivity.ExecuteTimeOut>
                                      <bda:QueryTableActivity.Sql>
                                        <InArgument x:TypeArguments="x:String">
                                          <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_144">[System.Convert.ToString(string.Format(excelToOrderQueryForWMSql, "DBNULL"))]</mca:CSharpValue>
                                        </InArgument>
                                      </bda:QueryTableActivity.Sql>
                                    </bda:QueryTableActivity>
                                  </bfa:If.Else>
                                </bfa:If>
                                <bfa:If ActivityName="条件（If）" sap2010:Annotation.AnnotationText="山姆散威化订单特殊处理" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 存在包含散威化产品的沃尔玛订单）" sap:VirtualizedContainerService.HintSize="534,493" sap2010:WorkflowViewState.IdRef="If_21" IsIgnore="False">
                                  <bfa:If.Condition>
                                    <InArgument x:TypeArguments="x:Boolean">
                                      <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_176">[wmNestleBulkDT!=null &amp;&amp; wmNestleBulkDT.Rows.Count &gt; 0]</mca:CSharpValue>
                                    </InArgument>
                                  </bfa:If.Condition>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <bfa:If.Then>
                                    <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="345,280" sap2010:WorkflowViewState.IdRef="Sequence_27">
                                      <Sequence.Variables>
                                        <Variable x:TypeArguments="s:String[]" Name="nestleNulkOrdersStringArr" />
                                      </Sequence.Variables>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - nestleNulkOrdersStringArr" sap:VirtualizedContainerService.HintSize="323,58" sap2010:WorkflowViewState.IdRef="Assign_29" IsIgnore="False">
                                        <bfa:Assign.To>
                                          <OutArgument x:TypeArguments="s:String[]">
                                            <mca:CSharpReference x:TypeArguments="s:String[]" sap2010:WorkflowViewState.IdRef="CSharpReference`1_49">[nestleNulkOrdersStringArr]</mca:CSharpReference>
                                          </OutArgument>
                                        </bfa:Assign.To>
                                        <bfa:Assign.Value>
                                          <InArgument x:TypeArguments="s:String[]">
                                            <mca:CSharpValue x:TypeArguments="s:String[]" sap2010:WorkflowViewState.IdRef="CSharpValue`1_177">[wmNestleBulkDT.Rows.Cast&lt;DataRow&gt;().Select&lt;DataRow, string&gt;(drRow =&gt; drRow["Customer_Order_Number"].ToString()).ToArray()]</mca:CSharpValue>
                                          </InArgument>
                                        </bfa:Assign.Value>
                                      </bfa:Assign>
                                      <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - ex2oToEdiQuery" sap:VirtualizedContainerService.HintSize="323,58" sap2010:WorkflowViewState.IdRef="Assign_30" IsIgnore="False">
                                        <bfa:Assign.To>
                                          <OutArgument x:TypeArguments="x:String">
                                            <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_50">[ex2oToEdiQuery]</mca:CSharpReference>
                                          </OutArgument>
                                        </bfa:Assign.To>
                                        <bfa:Assign.Value>
                                          <InArgument x:TypeArguments="x:String">
                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_222">[string.Format(excelToOrderQueryForAllSql, string.Format("(excel_to_order.Customer_Name='沃尔玛' and excel_to_order.Customer_Order_Number in ({0})) ", string.Join(",", nestleNulkOrdersStringArr)))]</mca:CSharpValue>
                                          </InArgument>
                                        </bfa:Assign.Value>
                                      </bfa:Assign>
                                    </Sequence>
                                  </bfa:If.Then>
                                  <bfa:If.Else>
                                    <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,280" sap2010:WorkflowViewState.IdRef="Sequence_28">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - ex2oToEdiQuery" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_31" IsIgnore="False">
                                        <bfa:Assign.To>
                                          <OutArgument x:TypeArguments="x:String">
                                            <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_51">[ex2oToEdiQuery]</mca:CSharpReference>
                                          </OutArgument>
                                        </bfa:Assign.To>
                                        <bfa:Assign.Value>
                                          <InArgument x:TypeArguments="x:String">
                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_179">[string.Format(excelToOrderQueryForAllSql, "1=0")]</mca:CSharpValue>
                                          </InArgument>
                                        </bfa:Assign.Value>
                                      </bfa:Assign>
                                      <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志 ex2oToEdiQuery WM 无订单" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_8" Level="Info">
                                        <baast:LogActivity.LogContent>
                                          <InArgument x:TypeArguments="x:String">
                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_180">[System.Convert.ToString(ex2oToEdiQuery)]</mca:CSharpValue>
                                          </InArgument>
                                        </baast:LogActivity.LogContent>
                                      </baast:LogActivity>
                                    </Sequence>
                                  </bfa:If.Else>
                                </bfa:If>
                              </Sequence>
                            </bfa:If.Then>
                            <bfa:If.Else>
                              <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - ex2oToEdiQuery 赋值（）不包含散威化" sap:VirtualizedContainerService.HintSize="323,58" sap2010:WorkflowViewState.IdRef="Assign_28" IsIgnore="False">
                                <bfa:Assign.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_48">[ex2oToEdiQuery]</mca:CSharpReference>
                                  </OutArgument>
                                </bfa:Assign.To>
                                <bfa:Assign.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_175">[excelToOrderQueryForAllSql]</mca:CSharpValue>
                                  </InArgument>
                                </bfa:Assign.Value>
                              </bfa:Assign>
                            </bfa:If.Else>
                          </bfa:If>
                          <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志 - ex2oToEdiQuery" sap:VirtualizedContainerService.HintSize="574,58" sap2010:WorkflowViewState.IdRef="LogActivity_7" Level="Info">
                            <baast:LogActivity.LogContent>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_173">[System.Convert.ToString(ex2oToEdiQuery)]</mca:CSharpValue>
                              </InArgument>
                            </baast:LogActivity.LogContent>
                          </baast:LogActivity>
                          <bda:QueryTableActivity ActivityName="查询语句" sap2010:Annotation.AnnotationText="符合条件的excelToOrder数据" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - ex2oToEdi" sap:VirtualizedContainerService.HintSize="574,64" sap2010:WorkflowViewState.IdRef="QueryTableActivity_10">
                            <bda:QueryTableActivity.DataTable>
                              <OutArgument x:TypeArguments="sd:DataTable">
                                <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_31">[allToDoEx2oDT]</mca:CSharpReference>
                              </OutArgument>
                            </bda:QueryTableActivity.DataTable>
                            <bda:QueryTableActivity.ExecuteTimeOut>
                              <InArgument x:TypeArguments="x:TimeSpan">
                                <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_39" Value="00:00:30" />
                              </InArgument>
                            </bda:QueryTableActivity.ExecuteTimeOut>
                            <bda:QueryTableActivity.Sql>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_118">[System.Convert.ToString(ex2oToEdiQuery)]</mca:CSharpValue>
                              </InArgument>
                            </bda:QueryTableActivity.Sql>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </bda:QueryTableActivity>
                        </Sequence>
                      </bfa:If.Then>
                      <bfa:If.Else>
                        <bda:QueryTableActivity ActivityName="查询语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - pending orders" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="QueryTableActivity_14">
                          <bda:QueryTableActivity.DataTable>
                            <OutArgument x:TypeArguments="sd:DataTable">
                              <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_63">[pendingJobDT]</mca:CSharpReference>
                            </OutArgument>
                          </bda:QueryTableActivity.DataTable>
                          <bda:QueryTableActivity.ExecuteTimeOut>
                            <InArgument x:TypeArguments="x:TimeSpan">
                              <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_76" Value="00:00:30" />
                            </InArgument>
                          </bda:QueryTableActivity.ExecuteTimeOut>
                          <bda:QueryTableActivity.Sql>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_211">[System.Convert.ToString(pendingOrderJHSql)]</mca:CSharpValue>
                            </InArgument>
                          </bda:QueryTableActivity.Sql>
                        </bda:QueryTableActivity>
                      </bfa:If.Else>
                    </bfa:If>
                  </Sequence>
                </ActivityAction>
              </bda:DatabaseConnectActivity.Body>
              <bda:DatabaseConnectActivity.ConnectionString>
                <InArgument x:TypeArguments="x:String">
                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_101">[System.Convert.ToString(数据库连接)]</mca:CSharpValue>
                </InArgument>
              </bda:DatabaseConnectActivity.ConnectionString>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </bda:DatabaseConnectActivity>
            <Flowchart DisplayName="流程图 - mail setting 数据校验" sap:VirtualizedContainerService.HintSize="650,53" sap2010:WorkflowViewState.IdRef="Flowchart_3">
              <Flowchart.Variables>
                <Variable x:TypeArguments="scg:List(x:String)" Name="errorMessageList">
                  <Variable.Default>
                    <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_104">[new List&lt;string&gt;{}]</mca:CSharpValue>
                  </Variable.Default>
                </Variable>
              </Flowchart.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                  <av:Size x:Key="ShapeSize">80,48</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">310,50.5 310,103.5</av:PointCollection>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Flowchart.StartNode>
                <x:Reference>__ReferenceID1</x:Reference>
              </Flowchart.StartNode>
              <FlowStep x:Name="__ReferenceID1" sap2010:WorkflowViewState.IdRef="FlowStep_2">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">135.5,103.5</av:Point>
                    <av:Size x:Key="ShapeSize">349,118</av:Size>
                    <av:PointCollection x:Key="ConnectorLocation">310,221.5 310,273.5</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ecaac:InvokeCSharpCodeActivity ActivityName="执行C#代码" sap2010:Annotation.AnnotationText="校验报表收件人有效性" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 - 校验邮箱信息" sap:VirtualizedContainerService.HintSize="349,118" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeActivity_6">
                  <ecaac:InvokeCSharpCodeActivity.CodeFilePath>
                    <InArgument x:TypeArguments="x:String">
                      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_83">.code\CSharp\执行CSharp代码-校验邮箱信息.cs</Literal>
                    </InArgument>
                  </ecaac:InvokeCSharpCodeActivity.CodeFilePath>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ecaac:InvokeCSharpCodeActivity>
                <FlowStep.Next>
                  <FlowStep x:Name="__ReferenceID0" sap2010:WorkflowViewState.IdRef="FlowStep_1">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:Point x:Key="ShapeLocation">210,273.5</av:Point>
                        <av:Size x:Key="ShapeSize">200,53</av:Size>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 存在错误消息）" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="If_14" IsIgnore="False">
                      <bfa:If.Condition>
                        <InArgument x:TypeArguments="x:Boolean">
                          <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_105">[errorMessageList.Count &gt; 0]</mca:CSharpValue>
                        </InArgument>
                      </bfa:If.Condition>
                      <bfa:If.Then>
                        <bfa:Throw DisplayName="抛出异常 - 汇总错误消息" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_4">
                          <InArgument x:TypeArguments="s:Exception">
                            <mca:CSharpValue x:TypeArguments="s:Exception" sap2010:WorkflowViewState.IdRef="CSharpValue`1_119">[new Exception(string.Join(", ", errorMessageList))]</mca:CSharpValue>
                          </InArgument>
                        </bfa:Throw>
                      </bfa:If.Then>
                    </bfa:If>
                  </FlowStep>
                </FlowStep.Next>
              </FlowStep>
              <x:Reference>__ReferenceID0</x:Reference>
            </Flowchart>
            <bfa:If ActivityName="条件（If）" sap2010:Annotation.AnnotationText="pending 文件，替代数据库查询待处理订单&#xA;" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 上传了pending订单文件）" sap:VirtualizedContainerService.HintSize="650,112" sap2010:WorkflowViewState.IdRef="If_27" IsIgnore="False">
              <bfa:If.Condition>
                <InArgument x:TypeArguments="x:Boolean">
                  <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_204">[!string.IsNullOrEmpty(pending订单文件)]</mca:CSharpValue>
                </InArgument>
              </bfa:If.Condition>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <bfa:If.Then>
                <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="556,1216" sap2010:WorkflowViewState.IdRef="Sequence_35">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <bfa:If ActivityName="条件（If）" sap2010:Annotation.AnnotationText="测试时本地文件，上线后控制台下载文件" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 上传文件来自本地测试）" sap:VirtualizedContainerService.HintSize="534,343" sap2010:WorkflowViewState.IdRef="If_28" IsIgnore="False">
                    <bfa:If.Condition>
                      <InArgument x:TypeArguments="x:Boolean">
                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_205">[上传文件来自本地测试]</mca:CSharpValue>
                      </InArgument>
                    </bfa:If.Condition>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <bfa:If.Then>
                      <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - local订单路径" sap:VirtualizedContainerService.HintSize="323,58" sap2010:WorkflowViewState.IdRef="Assign_35" IsIgnore="False">
                        <bfa:Assign.To>
                          <OutArgument x:TypeArguments="x:String">
                            <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_59">[pending订单路径]</mca:CSharpReference>
                          </OutArgument>
                        </bfa:Assign.To>
                        <bfa:Assign.Value>
                          <InArgument x:TypeArguments="x:String">
                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_207">[pending订单文件]</mca:CSharpValue>
                          </InArgument>
                        </bfa:Assign.Value>
                      </bfa:Assign>
                    </bfa:If.Then>
                    <bfa:If.Else>
                      <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,209" sap2010:WorkflowViewState.IdRef="Sequence_36">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <eca:FileDownloadActivity ActivityName="下载文件" ConsoleVersion="V4Console" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="下载文件" sap:VirtualizedContainerService.HintSize="349,85" sap2010:WorkflowViewState.IdRef="FileDownloadActivity_2" IsOverwrite="True">
                          <eca:FileDownloadActivity.ConsolePath>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_209">[System.Convert.ToString(pending订单文件)]</mca:CSharpValue>
                            </InArgument>
                          </eca:FileDownloadActivity.ConsolePath>
                          <eca:FileDownloadActivity.LocalDirectory>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_218">[System.Convert.ToString(Path.Combine(currentProjectSourcePath, @"Tmp"))]</mca:CSharpValue>
                            </InArgument>
                          </eca:FileDownloadActivity.LocalDirectory>
                          <eca:FileDownloadActivity.LocalFilePath>
                            <OutArgument x:TypeArguments="x:String">
                              <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_64">[pending订单路径]</mca:CSharpReference>
                            </OutArgument>
                          </eca:FileDownloadActivity.LocalFilePath>
                          <eca:FileDownloadActivity.ResourceGroupName>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_74" xml:space="preserve">雀巢（中国）有限公司/Customer Supply Chain </Literal>
                            </InArgument>
                          </eca:FileDownloadActivity.ResourceGroupName>
                          <eca:FileDownloadActivity.Timeout>
                            <InArgument x:TypeArguments="x:TimeSpan">
                              <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_75" />
                            </InArgument>
                          </eca:FileDownloadActivity.Timeout>
                        </eca:FileDownloadActivity>
                      </Sequence>
                    </bfa:If.Else>
                  </bfa:If>
                  <boa:OfficeExcelOpenOrCreateActivity OfficeVersion="{x:Null}" Password="{x:Null}" SaveAs="{x:Null}" ActivityName="打开/新建" sap2010:Annotation.AnnotationText="验证pending文件的有效性" AutoSave="True" ContinueOnError="No" CreateNewFile="False" DelayAfter="0" DelayBefore="0" DisplayName="打开 - pending 订单" EnableMacro="False" sap:VirtualizedContainerService.HintSize="650,970" sap2010:WorkflowViewState.IdRef="OfficeExcelOpenOrCreateActivity_6" ReadOnly="False" Visible="False" needRestoreKey="False">
                    <boa:OfficeExcelOpenOrCreateActivity.Body>
                      <ActivityAction x:TypeArguments="x:Object">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="x:Object" Name="XlWorkbook" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,641" sap2010:WorkflowViewState.IdRef="Sequence_37">
                          <Sequence.Variables>
                            <Variable x:TypeArguments="scg:List(x:String)" Name="allSheetNames" />
                            <Variable x:TypeArguments="x:Boolean" Name="上传文件符合要求" />
                          </Sequence.Variables>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <boa:OfficeExcelGetAllSheetsActivity ActivityName="获取所有工作表名" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="获取所有工作表名" sap:VirtualizedContainerService.HintSize="349,80" sap2010:WorkflowViewState.IdRef="OfficeExcelGetAllSheetsActivity_2">
                            <boa:OfficeExcelGetAllSheetsActivity.SheetNames>
                              <OutArgument x:TypeArguments="scg:List(x:String)">
                                <mca:CSharpReference x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_61">[allSheetNames]</mca:CSharpReference>
                              </OutArgument>
                            </boa:OfficeExcelGetAllSheetsActivity.SheetNames>
                          </boa:OfficeExcelGetAllSheetsActivity>
                          <boa:OfficeExcelReadRangeActivity Range="{x:Null}" ActivityName="读取区域" AddHeaders="True" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="读取区域 - 第一个工作表的数据" sap:VirtualizedContainerService.HintSize="349,129" sap2010:WorkflowViewState.IdRef="OfficeExcelReadRangeActivity_7" PreserveFormat="False" RepeatedColumn="False" UseFilter="False">
                            <boa:OfficeExcelReadRangeActivity.Data>
                              <OutArgument x:TypeArguments="sd:DataTable">
                                <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_62">[allToDoEx2oDT]</mca:CSharpReference>
                              </OutArgument>
                            </boa:OfficeExcelReadRangeActivity.Data>
                            <boa:OfficeExcelReadRangeActivity.SheetName>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_210">[System.Convert.ToString(allSheetNames[0])]</mca:CSharpValue>
                              </InArgument>
                            </boa:OfficeExcelReadRangeActivity.SheetName>
                          </boa:OfficeExcelReadRangeActivity>
                          <ecaac:InvokeCSharpCodeActivity ActivityName="执行C#代码" sap2010:Annotation.AnnotationText="1、验证上传的文件是否符合要求&#xA;2、只挑选当前开启客户的pending订单" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 - 选择ei_sent=-1的当前active客户的订单" sap:VirtualizedContainerService.HintSize="349,135" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeActivity_11">
                            <ecaac:InvokeCSharpCodeActivity.CodeFilePath>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_77">.code\CSharp\执行CSharp代码-选择pending的订单.cs</Literal>
                              </InArgument>
                            </ecaac:InvokeCSharpCodeActivity.CodeFilePath>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ecaac:InvokeCSharpCodeActivity>
                          <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 传文件符合要求 为假，抛出异常)" sap:VirtualizedContainerService.HintSize="349,53" sap2010:WorkflowViewState.IdRef="If_29" IsIgnore="False">
                            <bfa:If.Condition>
                              <InArgument x:TypeArguments="x:Boolean">
                                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_216">[!上传文件符合要求]</mca:CSharpValue>
                              </InArgument>
                            </bfa:If.Condition>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <bfa:If.Then>
                              <bfa:Throw DisplayName="抛出异常 - 文件不符合要求" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_7">
                                <InArgument x:TypeArguments="s:Exception">
                                  <mca:CSharpValue x:TypeArguments="s:Exception" sap2010:WorkflowViewState.IdRef="CSharpValue`1_217">[new Exception("低代上传的文件不符合要求")]</mca:CSharpValue>
                                </InArgument>
                              </bfa:Throw>
                            </bfa:If.Then>
                          </bfa:If>
                        </Sequence>
                      </ActivityAction>
                    </boa:OfficeExcelOpenOrCreateActivity.Body>
                    <boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_206">[System.Convert.ToString(pending订单路径)]</mca:CSharpValue>
                      </InArgument>
                    </boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </boa:OfficeExcelOpenOrCreateActivity>
                </Sequence>
              </bfa:If.Then>
            </bfa:If>
            <bfa:If ActivityName="条件（If）" sap2010:Annotation.AnnotationText="build EDI CSV file" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 存在 allToDoEx2oDT）" sap:VirtualizedContainerService.HintSize="650,1142" sap2010:WorkflowViewState.IdRef="If_12" IsIgnore="False">
              <bfa:If.Condition>
                <InArgument x:TypeArguments="x:Boolean">
                  <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_102">[allToDoEx2oDT!=null &amp;&amp; allToDoEx2oDT.Rows.Count &gt; 0]</mca:CSharpValue>
                </InArgument>
              </bfa:If.Condition>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <bfa:If.Then>
                <Sequence DisplayName="序列 - 存在EX2O数据" sap:VirtualizedContainerService.HintSize="472,929" sap2010:WorkflowViewState.IdRef="Sequence_15">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <bfa:If ActivityName="条件（If）" sap2010:Annotation.AnnotationText="测试环境，准备测试sold to, ship to 和物料假数据" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If  测试环境）" sap:VirtualizedContainerService.HintSize="450,95" sap2010:WorkflowViewState.IdRef="If_17" IsIgnore="False">
                    <bfa:If.Condition>
                      <InArgument x:TypeArguments="x:Boolean">
                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_155">[!is_edi_production]</mca:CSharpValue>
                      </InArgument>
                    </bfa:If.Condition>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <bfa:If.Then>
                      <boa:OfficeExcelOpenOrCreateActivity OfficeVersion="{x:Null}" Password="{x:Null}" SaveAs="{x:Null}" ActivityName="打开/新建" AutoSave="True" ContinueOnError="No" CreateNewFile="False" DelayAfter="0" DelayBefore="0" DisplayName="打开- 测试文件" EnableMacro="False" sap:VirtualizedContainerService.HintSize="472,1548" sap2010:WorkflowViewState.IdRef="OfficeExcelOpenOrCreateActivity_1" ReadOnly="False" Visible="False" needRestoreKey="False">
                        <boa:OfficeExcelOpenOrCreateActivity.Body>
                          <ActivityAction x:TypeArguments="x:Object">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="x:Object" Name="XlWorkbook" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="序列 - 打开测试数据" sap:VirtualizedContainerService.HintSize="378,1440" sap2010:WorkflowViewState.IdRef="Sequence_22">
                              <Sequence.Variables>
                                <Variable x:TypeArguments="x:String" Name="shipToSheetName">
                                  <Variable.Default>
                                    <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_46">shipToSoldTo</Literal>
                                  </Variable.Default>
                                </Variable>
                                <Variable x:TypeArguments="x:String" Name="materialSheetName">
                                  <Variable.Default>
                                    <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_47">material code</Literal>
                                  </Variable.Default>
                                </Variable>
                              </Sequence.Variables>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Sequence DisplayName="序列 - soldToShipTo 读取区域" sap:VirtualizedContainerService.HintSize="356,638" sap2010:WorkflowViewState.IdRef="Sequence_23">
                                <Sequence.Variables>
                                  <Variable x:TypeArguments="x:Int32" Name="lastRowNum" />
                                  <Variable x:TypeArguments="x:String" Name="lastColName" />
                                </Sequence.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <boa:OfficeExcelGetLastRowIndexActivity ColumnIndex="{x:Null}" LettersColumnIndex="{x:Null}" ActivityName="获取末行号" ColumnType="NumberColumn" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="获取末行号" sap:VirtualizedContainerService.HintSize="334,139" sap2010:WorkflowViewState.IdRef="OfficeExcelGetLastRowIndexActivity_1">
                                  <boa:OfficeExcelGetLastRowIndexActivity.ColumnNo>
                                    <InArgument x:TypeArguments="x:Int32">
                                      <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_158">[1]</mca:CSharpValue>
                                    </InArgument>
                                  </boa:OfficeExcelGetLastRowIndexActivity.ColumnNo>
                                  <boa:OfficeExcelGetLastRowIndexActivity.LastRowIndex>
                                    <OutArgument x:TypeArguments="x:Int32">
                                      <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_40">[lastRowNum]</mca:CSharpReference>
                                    </OutArgument>
                                  </boa:OfficeExcelGetLastRowIndexActivity.LastRowIndex>
                                  <boa:OfficeExcelGetLastRowIndexActivity.SheetName>
                                    <InArgument x:TypeArguments="x:String">
                                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_157">[System.Convert.ToString(shipToSheetName)]</mca:CSharpValue>
                                    </InArgument>
                                  </boa:OfficeExcelGetLastRowIndexActivity.SheetName>
                                </boa:OfficeExcelGetLastRowIndexActivity>
                                <boa:OfficeExcelGetLastColIndexActivity LastColumnIndex="{x:Null}" ActivityName="获取末列号" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="获取末列号" sap:VirtualizedContainerService.HintSize="334,166" sap2010:WorkflowViewState.IdRef="OfficeExcelGetLastColIndexActivity_1">
                                  <boa:OfficeExcelGetLastColIndexActivity.LastColumnLetter>
                                    <OutArgument x:TypeArguments="x:String">
                                      <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_41">[lastColName]</mca:CSharpReference>
                                    </OutArgument>
                                  </boa:OfficeExcelGetLastColIndexActivity.LastColumnLetter>
                                  <boa:OfficeExcelGetLastColIndexActivity.RowIndex>
                                    <InArgument x:TypeArguments="x:Int32">
                                      <Literal x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="Literal`1_50" Value="1" />
                                    </InArgument>
                                  </boa:OfficeExcelGetLastColIndexActivity.RowIndex>
                                  <boa:OfficeExcelGetLastColIndexActivity.SheetName>
                                    <InArgument x:TypeArguments="x:String">
                                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_159">[System.Convert.ToString(shipToSheetName)]</mca:CSharpValue>
                                    </InArgument>
                                  </boa:OfficeExcelGetLastColIndexActivity.SheetName>
                                </boa:OfficeExcelGetLastColIndexActivity>
                                <boa:OfficeExcelReadRangeActivity ActivityName="读取区域" AddHeaders="True" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="读取区域 - soldToshipTo 数据" sap:VirtualizedContainerService.HintSize="334,129" sap2010:WorkflowViewState.IdRef="OfficeExcelReadRangeActivity_1" PreserveFormat="False" RepeatedColumn="False" UseFilter="False">
                                  <boa:OfficeExcelReadRangeActivity.Data>
                                    <OutArgument x:TypeArguments="sd:DataTable">
                                      <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_44">[soldToShipToTestDT]</mca:CSharpReference>
                                    </OutArgument>
                                  </boa:OfficeExcelReadRangeActivity.Data>
                                  <boa:OfficeExcelReadRangeActivity.Range>
                                    <InArgument x:TypeArguments="x:String">
                                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_160">[System.Convert.ToString("A1:" + lastColName+lastRowNum)]</mca:CSharpValue>
                                    </InArgument>
                                  </boa:OfficeExcelReadRangeActivity.Range>
                                  <boa:OfficeExcelReadRangeActivity.SheetName>
                                    <InArgument x:TypeArguments="x:String">
                                      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_51">shipToSoldTo</Literal>
                                    </InArgument>
                                  </boa:OfficeExcelReadRangeActivity.SheetName>
                                </boa:OfficeExcelReadRangeActivity>
                              </Sequence>
                              <Sequence DisplayName="序列 - material code读取区域" sap:VirtualizedContainerService.HintSize="356,638" sap2010:WorkflowViewState.IdRef="Sequence_24">
                                <Sequence.Variables>
                                  <Variable x:TypeArguments="x:Int32" Name="lastRowNum" />
                                  <Variable x:TypeArguments="x:String" Name="lastColName" />
                                </Sequence.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <boa:OfficeExcelGetLastRowIndexActivity ColumnIndex="{x:Null}" LettersColumnIndex="{x:Null}" ActivityName="获取末行号" ColumnType="NumberColumn" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="获取末行号" sap:VirtualizedContainerService.HintSize="334,139" sap2010:WorkflowViewState.IdRef="OfficeExcelGetLastRowIndexActivity_3">
                                  <boa:OfficeExcelGetLastRowIndexActivity.ColumnNo>
                                    <InArgument x:TypeArguments="x:Int32">
                                      <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_162">[1]</mca:CSharpValue>
                                    </InArgument>
                                  </boa:OfficeExcelGetLastRowIndexActivity.ColumnNo>
                                  <boa:OfficeExcelGetLastRowIndexActivity.LastRowIndex>
                                    <OutArgument x:TypeArguments="x:Int32">
                                      <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_42">[lastRowNum]</mca:CSharpReference>
                                    </OutArgument>
                                  </boa:OfficeExcelGetLastRowIndexActivity.LastRowIndex>
                                  <boa:OfficeExcelGetLastRowIndexActivity.SheetName>
                                    <InArgument x:TypeArguments="x:String">
                                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_161">[System.Convert.ToString(materialSheetName)]</mca:CSharpValue>
                                    </InArgument>
                                  </boa:OfficeExcelGetLastRowIndexActivity.SheetName>
                                </boa:OfficeExcelGetLastRowIndexActivity>
                                <boa:OfficeExcelGetLastColIndexActivity LastColumnIndex="{x:Null}" ActivityName="获取末列号" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="获取末列号" sap:VirtualizedContainerService.HintSize="334,166" sap2010:WorkflowViewState.IdRef="OfficeExcelGetLastColIndexActivity_2">
                                  <boa:OfficeExcelGetLastColIndexActivity.LastColumnLetter>
                                    <OutArgument x:TypeArguments="x:String">
                                      <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_43">[lastColName]</mca:CSharpReference>
                                    </OutArgument>
                                  </boa:OfficeExcelGetLastColIndexActivity.LastColumnLetter>
                                  <boa:OfficeExcelGetLastColIndexActivity.RowIndex>
                                    <InArgument x:TypeArguments="x:Int32">
                                      <Literal x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="Literal`1_53" Value="1" />
                                    </InArgument>
                                  </boa:OfficeExcelGetLastColIndexActivity.RowIndex>
                                  <boa:OfficeExcelGetLastColIndexActivity.SheetName>
                                    <InArgument x:TypeArguments="x:String">
                                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_163">[System.Convert.ToString(materialSheetName)]</mca:CSharpValue>
                                    </InArgument>
                                  </boa:OfficeExcelGetLastColIndexActivity.SheetName>
                                </boa:OfficeExcelGetLastColIndexActivity>
                                <boa:OfficeExcelReadRangeActivity ActivityName="读取区域" AddHeaders="True" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="读取区域 - material code 数据" sap:VirtualizedContainerService.HintSize="334,129" sap2010:WorkflowViewState.IdRef="OfficeExcelReadRangeActivity_4" PreserveFormat="False" RepeatedColumn="False" UseFilter="False">
                                  <boa:OfficeExcelReadRangeActivity.Data>
                                    <OutArgument x:TypeArguments="sd:DataTable">
                                      <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_45">[materialCodeTestDT]</mca:CSharpReference>
                                    </OutArgument>
                                  </boa:OfficeExcelReadRangeActivity.Data>
                                  <boa:OfficeExcelReadRangeActivity.Range>
                                    <InArgument x:TypeArguments="x:String">
                                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_165">[System.Convert.ToString("A1:" + lastColName+lastRowNum)]</mca:CSharpValue>
                                    </InArgument>
                                  </boa:OfficeExcelReadRangeActivity.Range>
                                  <boa:OfficeExcelReadRangeActivity.SheetName>
                                    <InArgument x:TypeArguments="x:String">
                                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_164">[System.Convert.ToString(materialSheetName)]</mca:CSharpValue>
                                    </InArgument>
                                  </boa:OfficeExcelReadRangeActivity.SheetName>
                                </boa:OfficeExcelReadRangeActivity>
                              </Sequence>
                            </Sequence>
                          </ActivityAction>
                        </boa:OfficeExcelOpenOrCreateActivity.Body>
                        <boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                          <InArgument x:TypeArguments="x:String">
                            <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_45">Template\EDI test data.XLSX</Literal>
                          </InArgument>
                        </boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </boa:OfficeExcelOpenOrCreateActivity>
                    </bfa:If.Then>
                  </bfa:If>
                  <ecaac:InvokeCSharpCodeActivity ActivityName="执行C#代码" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码: 执行CSharp代码_buildEditDT-allMapping" sap:VirtualizedContainerService.HintSize="450,93" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeActivity_12">
                    <ecaac:InvokeCSharpCodeActivity.CodeFilePath>
                      <InArgument x:TypeArguments="x:String">
                        <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_124">.code\CSharp\执行CSharp代码_buildEditDT-allMapping.cs</Literal>
                      </InArgument>
                    </ecaac:InvokeCSharpCodeActivity.CodeFilePath>
                  </ecaac:InvokeCSharpCodeActivity>
                  <bfa:ForEach x:TypeArguments="scg:KeyValuePair(x:String, sd:DataTable)" CurrentIndex="{x:Null}" ActivityName="循环操作（For Each)" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="循环操作 - 遍历客户，exceptionDT字典" sap:VirtualizedContainerService.HintSize="450,537" sap2010:WorkflowViewState.IdRef="ForEach`1_2" IsIgnore="False">
                    <bfa:ForEach.Values>
                      <InArgument x:TypeArguments="scg:Dictionary(x:String, sd:DataTable)">
                        <mca:CSharpValue x:TypeArguments="scg:Dictionary(x:String, sd:DataTable)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_231">[customerExceptionDTDic]</mca:CSharpValue>
                      </InArgument>
                    </bfa:ForEach.Values>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ActivityAction x:TypeArguments="scg:KeyValuePair(x:String, sd:DataTable)">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="scg:KeyValuePair(x:String, sd:DataTable)" Name="item" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="序列 - 遍历客户ExceptionDT 字典" sap:VirtualizedContainerService.HintSize="371,432" sap2010:WorkflowViewState.IdRef="Sequence_39">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="x:String" Name="临时Ex2O文件路径" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 临时Ex2O文件路径" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_32" IsIgnore="False">
                          <bfa:Assign.To>
                            <OutArgument x:TypeArguments="x:String">
                              <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_53">[临时Ex2O文件路径]</mca:CSharpReference>
                            </OutArgument>
                          </bfa:Assign.To>
                          <bfa:Assign.Value>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_284">[Path.Combine(Environment.GetEnvironmentVariable("CurrentProjectSourcePath"), string.Format(@"Tmp\{0}exception_edi_{1}.xlsx", item.Key, timeNowTicks))]</mca:CSharpValue>
                            </InArgument>
                          </bfa:Assign.Value>
                        </bfa:Assign>
                        <boa:OfficeExcelOpenOrCreateActivity OfficeVersion="{x:Null}" Password="{x:Null}" SaveAs="{x:Null}" ActivityName="打开/新建" AutoSave="True" ContinueOnError="No" CreateNewFile="True" DelayAfter="0" DelayBefore="0" DisplayName="打开 - 临时Ex2O文件路径 - 异常文件" EnableMacro="False" sap:VirtualizedContainerService.HintSize="349,53" sap2010:WorkflowViewState.IdRef="OfficeExcelOpenOrCreateActivity_3" ReadOnly="False" Visible="False" needRestoreKey="False">
                          <boa:OfficeExcelOpenOrCreateActivity.Body>
                            <ActivityAction x:TypeArguments="x:Object">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="x:Object" Name="XlWorkbook" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="356,486" sap2010:WorkflowViewState.IdRef="Sequence_30">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <boa:OfficeExcelSetRangeActivity ActivityName="写入区域" AddHeaders="True" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入区域 - allExceptionEx2ODT" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="OfficeExcelSetRangeActivity_1">
                                  <boa:OfficeExcelSetRangeActivity.InputDataTable>
                                    <InArgument x:TypeArguments="sd:DataTable">
                                      <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_245">[item.Value]</mca:CSharpValue>
                                    </InArgument>
                                  </boa:OfficeExcelSetRangeActivity.InputDataTable>
                                  <boa:OfficeExcelSetRangeActivity.SheetName>
                                    <InArgument x:TypeArguments="x:String">
                                      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_64">EX2O</Literal>
                                    </InArgument>
                                  </boa:OfficeExcelSetRangeActivity.SheetName>
                                  <boa:OfficeExcelSetRangeActivity.StartCell>
                                    <InArgument x:TypeArguments="x:String">
                                      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_62">A1</Literal>
                                    </InArgument>
                                  </boa:OfficeExcelSetRangeActivity.StartCell>
                                </boa:OfficeExcelSetRangeActivity>
                                <boa:OfficeExcelSetRangeActivity ActivityName="写入区域" AddHeaders="True" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入区域 - allExceptionOrdersDT" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="OfficeExcelSetRangeActivity_2">
                                  <boa:OfficeExcelSetRangeActivity.InputDataTable>
                                    <InArgument x:TypeArguments="sd:DataTable">
                                      <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_246">[customerExceptionDTReasonDic[item.Key]]</mca:CSharpValue>
                                    </InArgument>
                                  </boa:OfficeExcelSetRangeActivity.InputDataTable>
                                  <boa:OfficeExcelSetRangeActivity.SheetName>
                                    <InArgument x:TypeArguments="x:String">
                                      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_66">exception Order</Literal>
                                    </InArgument>
                                  </boa:OfficeExcelSetRangeActivity.SheetName>
                                  <boa:OfficeExcelSetRangeActivity.StartCell>
                                    <InArgument x:TypeArguments="x:String">
                                      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_65">A1</Literal>
                                    </InArgument>
                                  </boa:OfficeExcelSetRangeActivity.StartCell>
                                </boa:OfficeExcelSetRangeActivity>
                                <boa:OfficeExcelDeleteSheetActivity ActivityName="删除工作表" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="删除工作表" sap:VirtualizedContainerService.HintSize="334,58" sap2010:WorkflowViewState.IdRef="OfficeExcelDeleteSheetActivity_1">
                                  <boa:OfficeExcelDeleteSheetActivity.SheetName>
                                    <InArgument x:TypeArguments="x:String">
                                      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_67">Sheet1</Literal>
                                    </InArgument>
                                  </boa:OfficeExcelDeleteSheetActivity.SheetName>
                                </boa:OfficeExcelDeleteSheetActivity>
                              </Sequence>
                            </ActivityAction>
                          </boa:OfficeExcelOpenOrCreateActivity.Body>
                          <boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_183">[System.Convert.ToString(临时Ex2O文件路径)]</mca:CSharpValue>
                            </InArgument>
                          </boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </boa:OfficeExcelOpenOrCreateActivity>
                        <ecaad:AddDictionaryActivity ActivityName="添加键值对" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="添加键值对 - 分客户EDI Exception反馈文件" sap:VirtualizedContainerService.HintSize="349,117" sap2010:WorkflowViewState.IdRef="AddDictionaryActivity_1" KeyValuePairJsonText="[{&quot;Key&quot;:&quot;item.Key&quot;,&quot;KeyTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Value&quot;:&quot;临时Ex2O文件路径&quot;,&quot;ValueTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
                          <ecaad:AddDictionaryActivity.Dictionary>
                            <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)">
                              <mca:CSharpValue x:TypeArguments="scg:Dictionary(x:String, x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_239">[customerExceptionFileDic]</mca:CSharpValue>
                            </InArgument>
                          </ecaad:AddDictionaryActivity.Dictionary>
                          <ecaad:AddDictionaryActivity.KeyValuePairs>
                            <ecam:KeyValueModel Index="1" IsNotFirst="False">
                              <ecam:KeyValueModel.Key>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String">[item.Key]</mca:CSharpValue>
                                </InArgument>
                              </ecam:KeyValueModel.Key>
                              <ecam:KeyValueModel.Value>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String">[临时Ex2O文件路径]</mca:CSharpValue>
                                </InArgument>
                              </ecam:KeyValueModel.Value>
                            </ecam:KeyValueModel>
                          </ecaad:AddDictionaryActivity.KeyValuePairs>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ecaad:AddDictionaryActivity>
                      </Sequence>
                    </ActivityAction>
                  </bfa:ForEach>
                </Sequence>
              </bfa:If.Then>
            </bfa:If>
            <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If allToDoEx2oDT 不为空）" sap:VirtualizedContainerService.HintSize="650,780" sap2010:WorkflowViewState.IdRef="If_39" IsIgnore="False">
              <bfa:If.Condition>
                <InArgument x:TypeArguments="x:Boolean">
                  <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_298">[allToDoEx2oDT !=null &amp;&amp; allToDoEx2oDT.Rows.Count &gt; 0]</mca:CSharpValue>
                </InArgument>
              </bfa:If.Condition>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <bfa:If.Then>
                <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="472,592" sap2010:WorkflowViewState.IdRef="Sequence_47">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <boa:OfficeExcelOpenOrCreateActivity OfficeVersion="{x:Null}" Password="{x:Null}" SaveAs="{x:Null}" ActivityName="打开/新建" AutoSave="True" ContinueOnError="No" CreateNewFile="True" DelayAfter="0" DelayBefore="0" DisplayName="新建 EX2O 原始文件" EnableMacro="False" sap:VirtualizedContainerService.HintSize="450,468" sap2010:WorkflowViewState.IdRef="OfficeExcelOpenOrCreateActivity_8" ReadOnly="False" Visible="False" needRestoreKey="False">
                    <boa:OfficeExcelOpenOrCreateActivity.Body>
                      <ActivityAction x:TypeArguments="x:Object">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="x:Object" Name="XlWorkbook" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="356,360" sap2010:WorkflowViewState.IdRef="Sequence_48">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <boa:OfficeExcelDeleteDataActivity CellName="{x:Null}" Column="{x:Null}" Range="{x:Null}" Row="{x:Null}" ActivityName="删除数据" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DeleteSheet="True" DisplayName="删除数据 - 工作表 &quot;EX2O&quot;" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="OfficeExcelDeleteDataActivity_2" MoveCell="False" MoveMode="CellTop">
                            <boa:OfficeExcelDeleteDataActivity.SheetName>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_117">EX2O</Literal>
                              </InArgument>
                            </boa:OfficeExcelDeleteDataActivity.SheetName>
                          </boa:OfficeExcelDeleteDataActivity>
                          <boa:OfficeExcelSetRangeActivity ActivityName="写入区域" AddHeaders="True" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入区域 - &quot;EX2O&quot;" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="OfficeExcelSetRangeActivity_4">
                            <boa:OfficeExcelSetRangeActivity.InputDataTable>
                              <InArgument x:TypeArguments="sd:DataTable">
                                <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_300">[allToDoEx2oDT]</mca:CSharpValue>
                              </InArgument>
                            </boa:OfficeExcelSetRangeActivity.InputDataTable>
                            <boa:OfficeExcelSetRangeActivity.SheetName>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_119">EX2O</Literal>
                              </InArgument>
                            </boa:OfficeExcelSetRangeActivity.SheetName>
                            <boa:OfficeExcelSetRangeActivity.StartCell>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_118">A1</Literal>
                              </InArgument>
                            </boa:OfficeExcelSetRangeActivity.StartCell>
                          </boa:OfficeExcelSetRangeActivity>
                          <boa:OfficeExcelDeleteDataActivity CellName="{x:Null}" Column="{x:Null}" Range="{x:Null}" Row="{x:Null}" ActivityName="删除数据" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DeleteSheet="True" DisplayName="删除数据 - 工作表 &quot;EX2O&quot;" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="OfficeExcelDeleteDataActivity_3" MoveCell="False" MoveMode="CellTop">
                            <boa:OfficeExcelDeleteDataActivity.SheetName>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_122">Sheet1</Literal>
                              </InArgument>
                            </boa:OfficeExcelDeleteDataActivity.SheetName>
                          </boa:OfficeExcelDeleteDataActivity>
                        </Sequence>
                      </ActivityAction>
                    </boa:OfficeExcelOpenOrCreateActivity.Body>
                    <boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_299">[System.Convert.ToString(ex2O原始文件)]</mca:CSharpValue>
                      </InArgument>
                    </boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </boa:OfficeExcelOpenOrCreateActivity>
                </Sequence>
              </bfa:If.Then>
            </bfa:If>
            <bfa:If ActivityName="条件（If）" sap2010:Annotation.AnnotationText="if ediStatus = true&#xA;  更新order_job_history 表数据&#xA;  发送EDI成功邮件（有、无数据）&#xA;else&#xA;  发送预警邮件" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件  根据 ediStatus判断邮件内容" sap:VirtualizedContainerService.HintSize="574,1706" sap2010:WorkflowViewState.IdRef="If_13" IsIgnore="False">
              <bfa:If.Condition>
                <InArgument x:TypeArguments="x:Boolean">
                  <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_103">[ediStatus]</mca:CSharpValue>
                </InArgument>
              </bfa:If.Condition>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <bfa:If.Then>
                <Sequence sap2010:Annotation.AnnotationText="更新order_job_history 表数据&#xA;发送EDI成功邮件（有、无数据）" DisplayName="序列 - 成功后处理 - EDI SUCCESS" sap:VirtualizedContainerService.HintSize="556,1092" sap2010:WorkflowViewState.IdRef="Sequence_16">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="scg:List(x:String)" Name="附件">
                      <Variable.Default>
                        <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_186">[new List&lt;string&gt;{}]</mca:CSharpValue>
                      </Variable.Default>
                    </Variable>
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 邮件主题 - EDI SUCCESS" sap:VirtualizedContainerService.HintSize="534,58" sap2010:WorkflowViewState.IdRef="Assign_16" IsIgnore="False">
                    <bfa:Assign.To>
                      <OutArgument x:TypeArguments="x:String">
                        <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_23">[邮件主题]</mca:CSharpReference>
                      </OutArgument>
                    </bfa:Assign.To>
                    <bfa:Assign.Value>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_108">["雀巢EDI执行成功"]</mca:CSharpValue>
                      </InArgument>
                    </bfa:Assign.Value>
                  </bfa:Assign>
                  <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If）" sap:VirtualizedContainerService.HintSize="534,506" sap2010:WorkflowViewState.IdRef="If_40" IsIgnore="False">
                    <bfa:If.Condition>
                      <InArgument x:TypeArguments="x:Boolean">
                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_310">[ediMessage == "Edi Success"]</mca:CSharpValue>
                      </InArgument>
                    </bfa:If.Condition>
                    <bfa:If.Then>
                      <Sequence DisplayName="序列 - 存在EDI数据" sap:VirtualizedContainerService.HintSize="371,318" sap2010:WorkflowViewState.IdRef="Sequence_49">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 邮件正文 - EDI SUCCESS" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_45" IsIgnore="False">
                          <bfa:Assign.To>
                            <OutArgument x:TypeArguments="x:String">
                              <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_79">[邮件正文]</mca:CSharpReference>
                            </OutArgument>
                          </bfa:Assign.To>
                          <bfa:Assign.Value>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_311">[String.Format(邮件正文模板成功, ediMessage == "Edi Success" ? "数据传输完成" : "无新增数据", DateTime.Now.ToString(), notMatchedOrdersStr) + string.Format("&lt;br/&gt; 当前开启的客户为：{0}", activeCustomerNames)]</mca:CSharpValue>
                            </InArgument>
                          </bfa:Assign.Value>
                        </bfa:Assign>
                        <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="调用子流程: 发送邮件 - EDI SUCCESS" sap:VirtualizedContainerService.HintSize="349,96" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_25" IsIgnore="False">
                          <bfa:InvokeWorkflow.Arguments>
                            <InArgument x:TypeArguments="scg:List(x:String)" x:Key="附件">
                              <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_312">[附件]</mca:CSharpValue>
                            </InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="邮件正文">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_313">[System.Convert.ToString(邮件正文)]</mca:CSharpValue>
                            </InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="邮件主题">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_314">[System.Convert.ToString(邮件主题)]</mca:CSharpValue>
                            </InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="收件人">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_315">[System.Convert.ToString(ediMailReceiver)]</mca:CSharpValue>
                            </InArgument>
                          </bfa:InvokeWorkflow.Arguments>
                          <bfa:InvokeWorkflow.WorkflowPath>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_129">发送邮件.xaml</Literal>
                            </InArgument>
                          </bfa:InvokeWorkflow.WorkflowPath>
                        </bfa:InvokeWorkflow>
                      </Sequence>
                    </bfa:If.Then>
                  </bfa:If>
                  <eae:CommentActivity DisplayName="注释掉" sap:VirtualizedContainerService.HintSize="534,53" sap2010:WorkflowViewState.IdRef="CommentActivity_6">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <bfa:If ActivityName="条件（If）" sap2010:Annotation.AnnotationText="无异常数据， 附件附上原始EX2O文件" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If  无异常数据）" sap:VirtualizedContainerService.HintSize="200,95" sap2010:WorkflowViewState.IdRef="If_31" IsIgnore="False">
                      <bfa:If.Condition>
                        <InArgument x:TypeArguments="x:Boolean">
                          <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_251">[customerExceptionFileDic.Count == 0]</mca:CSharpValue>
                        </InArgument>
                      </bfa:If.Condition>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <bfa:If.Then>
                        <Sequence DisplayName="序列 - 无异常数据" sap:VirtualizedContainerService.HintSize="371,318" sap2010:WorkflowViewState.IdRef="Sequence_41">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 邮件正文 - EDI SUCCESS" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_38" IsIgnore="False">
                            <bfa:Assign.To>
                              <OutArgument x:TypeArguments="x:String">
                                <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_68">[邮件正文]</mca:CSharpReference>
                              </OutArgument>
                            </bfa:Assign.To>
                            <bfa:Assign.Value>
                              <InArgument x:TypeArguments="x:String">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_306">[String.Format(邮件正文模板成功, ediMessage == "Edi Success" ? "数据传输完成" : "无新增数据", DateTime.Now.ToString(), notMatchedOrdersStr) + string.Format("&lt;br/&gt; 当前开启的客户为：{0}", activeCustomerNames)]</mca:CSharpValue>
                              </InArgument>
                            </bfa:Assign.Value>
                          </bfa:Assign>
                          <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="调用子流程: 发送邮件 - EDI SUCCESS" sap:VirtualizedContainerService.HintSize="349,96" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_19" IsIgnore="False">
                            <bfa:InvokeWorkflow.Arguments>
                              <InArgument x:TypeArguments="scg:List(x:String)" x:Key="附件">
                                <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_247">[附件]</mca:CSharpValue>
                              </InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="邮件正文">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_248">[System.Convert.ToString(邮件正文)]</mca:CSharpValue>
                              </InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="邮件主题">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_249">[System.Convert.ToString(邮件主题)]</mca:CSharpValue>
                              </InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="收件人">
                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_250">[System.Convert.ToString(ediMailReceiver)]</mca:CSharpValue>
                              </InArgument>
                            </bfa:InvokeWorkflow.Arguments>
                            <bfa:InvokeWorkflow.WorkflowPath>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_96">发送邮件.xaml</Literal>
                              </InArgument>
                            </bfa:InvokeWorkflow.WorkflowPath>
                          </bfa:InvokeWorkflow>
                        </Sequence>
                      </bfa:If.Then>
                      <bfa:If.Else>
                        <eae:CommentActivity DisplayName="注释掉" sap:VirtualizedContainerService.HintSize="455,285" sap2010:WorkflowViewState.IdRef="CommentActivity_5">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Sequence sap2010:Annotation.AnnotationText="发送异常邮件" DisplayName="序列 - 分客户发送异常邮件" sap:VirtualizedContainerService.HintSize="222,202" sap2010:WorkflowViewState.IdRef="Sequence_44">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <bfa:ForEach x:TypeArguments="scg:KeyValuePair(x:String, x:String)" CurrentIndex="{x:Null}" ActivityName="循环操作（For Each)" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="循环操作 - 遍历异常文件字典 【客户】=文件" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="ForEach`1_5" IsIgnore="False">
                              <bfa:ForEach.Values>
                                <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)">
                                  <mca:CSharpValue x:TypeArguments="scg:Dictionary(x:String, x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_252">[customerExceptionFileDic]</mca:CSharpValue>
                                </InArgument>
                              </bfa:ForEach.Values>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ActivityAction x:TypeArguments="scg:KeyValuePair(x:String, x:String)">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="scg:KeyValuePair(x:String, x:String)" Name="item" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="序列 - 分客户发送异常邮件" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="Sequence_42">
                                  <Sequence.Variables>
                                    <Variable x:TypeArguments="x:String" Name="customer_name" />
                                    <Variable x:TypeArguments="x:String" Name="exceptionFile" />
                                    <Variable x:TypeArguments="scg:List(x:String)" Name="异常文件附件">
                                      <Variable.Default>
                                        <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_288">[new List&lt;string&gt;{}]</mca:CSharpValue>
                                      </Variable.Default>
                                    </Variable>
                                  </Sequence.Variables>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - customer_name" sap:VirtualizedContainerService.HintSize="534,58" sap2010:WorkflowViewState.IdRef="Assign_39" IsIgnore="False">
                                    <bfa:Assign.To>
                                      <OutArgument x:TypeArguments="x:String">
                                        <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_69">[customer_name]</mca:CSharpReference>
                                      </OutArgument>
                                    </bfa:Assign.To>
                                    <bfa:Assign.Value>
                                      <InArgument x:TypeArguments="x:String">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_254">[item.Key]</mca:CSharpValue>
                                      </InArgument>
                                    </bfa:Assign.Value>
                                  </bfa:Assign>
                                  <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - exceptionFile" sap:VirtualizedContainerService.HintSize="534,58" sap2010:WorkflowViewState.IdRef="Assign_40" IsIgnore="False">
                                    <bfa:Assign.To>
                                      <OutArgument x:TypeArguments="x:String">
                                        <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_70">[exceptionFile]</mca:CSharpReference>
                                      </OutArgument>
                                    </bfa:Assign.To>
                                    <bfa:Assign.Value>
                                      <InArgument x:TypeArguments="x:String">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_255">[item.Value]</mca:CSharpValue>
                                      </InArgument>
                                    </bfa:Assign.Value>
                                  </bfa:Assign>
                                  <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - notMatchedOrdersStr" sap:VirtualizedContainerService.HintSize="534,58" sap2010:WorkflowViewState.IdRef="Assign_42" IsIgnore="False">
                                    <bfa:Assign.To>
                                      <OutArgument x:TypeArguments="x:String">
                                        <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_73">[notMatchedOrdersStr]</mca:CSharpReference>
                                      </OutArgument>
                                    </bfa:Assign.To>
                                    <bfa:Assign.Value>
                                      <InArgument x:TypeArguments="x:String">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_264">[(notMatchedOrders.Count == 0 ? "" : string.Format("&lt;br/&gt; &lt;b&gt;订单跟当前客户中的pending订单不匹配：{0}&lt;/b&gt;", string.Join(", ", notMatchedOrders)))]</mca:CSharpValue>
                                      </InArgument>
                                    </bfa:Assign.Value>
                                  </bfa:Assign>
                                  <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 邮件正文 - EDI SUCCESS" sap:VirtualizedContainerService.HintSize="534,58" sap2010:WorkflowViewState.IdRef="Assign_41" IsIgnore="False">
                                    <bfa:Assign.To>
                                      <OutArgument x:TypeArguments="x:String">
                                        <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_71">[邮件正文]</mca:CSharpReference>
                                      </OutArgument>
                                    </bfa:Assign.To>
                                    <bfa:Assign.Value>
                                      <InArgument x:TypeArguments="x:String">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_265">[String.Format(邮件正文模板成功, ediMessage == "Edi Success" ? "部分数据传输完成" : "无新增数据", DateTime.Now.ToString(), "&lt;br/&gt; 异常数据：请将附件【EX2O】工作表的缺失部分补充完整后重新从低代推送此部分订单，订单缺失详细信息请见【exception Order】工作表" + notMatchedOrdersStr)]</mca:CSharpValue>
                                      </InArgument>
                                    </bfa:Assign.Value>
                                  </bfa:Assign>
                                  <bfa:If ActivityName="条件（If）" sap2010:Annotation.AnnotationText="存在异常订单（数据不完整）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 存在不完整订单）" sap:VirtualizedContainerService.HintSize="534,307" sap2010:WorkflowViewState.IdRef="If_32" IsIgnore="False">
                                    <bfa:If.Condition>
                                      <InArgument x:TypeArguments="x:Boolean">
                                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_257">[!string.IsNullOrEmpty(customer_name)]</mca:CSharpValue>
                                      </InArgument>
                                    </bfa:If.Condition>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <bfa:If.Then>
                                      <ecaac1:AddToCollectionActivity ActivityName="添加对象" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="添加对象 - 添加附件" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollectionActivity_2">
                                        <ecaac1:AddToCollectionActivity.Collection>
                                          <InOutArgument x:TypeArguments="scg:List(x:String)">
                                            <mca:CSharpReference x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_77">[异常文件附件]</mca:CSharpReference>
                                          </InOutArgument>
                                        </ecaac1:AddToCollectionActivity.Collection>
                                        <ecaac1:AddToCollectionActivity.Item>
                                          <InArgument x:TypeArguments="x:String">
                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_258">[exceptionFile]</mca:CSharpValue>
                                          </InArgument>
                                        </ecaac1:AddToCollectionActivity.Item>
                                      </ecaac1:AddToCollectionActivity>
                                    </bfa:If.Then>
                                  </bfa:If>
                                  <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="调用子流程: 发送邮件 - EDI SUCCESS - 存在异常数据" sap:VirtualizedContainerService.HintSize="534,96" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_20" IsIgnore="False">
                                    <bfa:InvokeWorkflow.Arguments>
                                      <InArgument x:TypeArguments="scg:List(x:String)" x:Key="附件">
                                        <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_277">[异常文件附件]</mca:CSharpValue>
                                      </InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="邮件正文">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_260">[System.Convert.ToString(邮件正文)]</mca:CSharpValue>
                                      </InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="邮件主题">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_261">[System.Convert.ToString(邮件主题)]</mca:CSharpValue>
                                      </InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="收件人">
                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_262">[System.Convert.ToString(exceptionEdiEmailDic[customer_name])]</mca:CSharpValue>
                                      </InArgument>
                                    </bfa:InvokeWorkflow.Arguments>
                                    <bfa:InvokeWorkflow.WorkflowPath>
                                      <InArgument x:TypeArguments="x:String">
                                        <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_97">发送邮件.xaml</Literal>
                                      </InArgument>
                                    </bfa:InvokeWorkflow.WorkflowPath>
                                  </bfa:InvokeWorkflow>
                                </Sequence>
                              </ActivityAction>
                            </bfa:ForEach>
                          </Sequence>
                        </eae:CommentActivity>
                      </bfa:If.Else>
                    </bfa:If>
                  </eae:CommentActivity>
                  <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If ex2O原始文件 存在）" sap:VirtualizedContainerService.HintSize="534,53" sap2010:WorkflowViewState.IdRef="If_37" IsIgnore="False">
                    <bfa:If.Condition>
                      <InArgument x:TypeArguments="x:Boolean">
                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_281">[File.Exists(ex2O原始文件)]</mca:CSharpValue>
                      </InArgument>
                    </bfa:If.Condition>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <bfa:If.Then>
                      <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,473" sap2010:WorkflowViewState.IdRef="Sequence_46">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ecaac1:AddToCollectionActivity ActivityName="添加对象" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="添加对象 - 添加原始EX2O文件" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="AddToCollectionActivity_5">
                          <ecaac1:AddToCollectionActivity.Collection>
                            <InOutArgument x:TypeArguments="scg:List(x:String)">
                              <mca:CSharpReference x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_75">[附件]</mca:CSharpReference>
                            </InOutArgument>
                          </ecaac1:AddToCollectionActivity.Collection>
                          <ecaac1:AddToCollectionActivity.Item>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_282">[ex2O原始文件]</mca:CSharpValue>
                            </InArgument>
                          </ecaac1:AddToCollectionActivity.Item>
                        </ecaac1:AddToCollectionActivity>
                        <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If result EDI文件存在）" sap:VirtualizedContainerService.HintSize="349,53" sap2010:WorkflowViewState.IdRef="If_38" IsIgnore="False">
                          <bfa:If.Condition>
                            <InArgument x:TypeArguments="x:Boolean">
                              <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_294">[!string.IsNullOrEmpty(ediFileSentPath) &amp;&amp; File.Exists(ediFileSentPath)]</mca:CSharpValue>
                            </InArgument>
                          </bfa:If.Condition>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <bfa:If.Then>
                            <ecaac1:AddToCollectionActivity ActivityName="添加对象" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="添加对象 - 添加EDI文件" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollectionActivity_6">
                              <ecaac1:AddToCollectionActivity.Collection>
                                <InOutArgument x:TypeArguments="scg:List(x:String)">
                                  <mca:CSharpReference x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_78">[附件]</mca:CSharpReference>
                                </InOutArgument>
                              </ecaac1:AddToCollectionActivity.Collection>
                              <ecaac1:AddToCollectionActivity.Item>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_295">[ediFileSentPath]</mca:CSharpValue>
                                </InArgument>
                              </ecaac1:AddToCollectionActivity.Item>
                            </ecaac1:AddToCollectionActivity>
                          </bfa:If.Then>
                        </bfa:If>
                        <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 邮件正文 - 原始EX2O文件" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_44" IsIgnore="False">
                          <bfa:Assign.To>
                            <OutArgument x:TypeArguments="x:String">
                              <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_76">[邮件正文]</mca:CSharpReference>
                            </OutArgument>
                          </bfa:Assign.To>
                          <bfa:Assign.Value>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_307">[string.Format("Dear all, &lt;br&gt; 附件为EDI原始文件，请查收 &lt;br/&gt;当前开启的客户为：{0}", activeCustomerNames)]</mca:CSharpValue>
                            </InArgument>
                          </bfa:Assign.Value>
                        </bfa:Assign>
                        <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="调用子流程: 发送邮件 - EDI 原始文件" sap:VirtualizedContainerService.HintSize="349,96" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_24" IsIgnore="False">
                          <bfa:InvokeWorkflow.Arguments>
                            <InArgument x:TypeArguments="scg:List(x:String)" x:Key="附件">
                              <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_285">[附件]</mca:CSharpValue>
                            </InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="邮件正文">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_286">[System.Convert.ToString(邮件正文)]</mca:CSharpValue>
                            </InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="邮件主题">
                              <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_113">雀巢EDI原始文件</Literal>
                            </InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="收件人">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_287">[System.Convert.ToString(ediMailReceiver)]</mca:CSharpValue>
                            </InArgument>
                          </bfa:InvokeWorkflow.Arguments>
                          <bfa:InvokeWorkflow.WorkflowPath>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_112">发送邮件.xaml</Literal>
                            </InArgument>
                          </bfa:InvokeWorkflow.WorkflowPath>
                        </bfa:InvokeWorkflow>
                      </Sequence>
                    </bfa:If.Then>
                  </bfa:If>
                  <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行流程 : 执行C_代码_更新edi的状态 - EDI SUCCESS" sap:VirtualizedContainerService.HintSize="534,96" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_18" IsIgnore="False">
                    <bfa:InvokeWorkflow.Arguments>
                      <InArgument x:TypeArguments="x:String" x:Key="sqlConn">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_233">[System.Convert.ToString(数据库连接)]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="sd:DataTable" x:Key="allToDoEx2oDT">
                        <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_234">[allToDoEx2oDT]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="x:Boolean" x:Key="ediStatus">
                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_235">[ediStatus]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="ediMessage">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_236">[System.Convert.ToString(ediMessage)]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="sd:DataTable" x:Key="allExceptionOrdersDT">
                        <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_237">[allExceptionOrdersDT]</mca:CSharpValue>
                      </InArgument>
                    </bfa:InvokeWorkflow.Arguments>
                    <bfa:InvokeWorkflow.WorkflowPath>
                      <InArgument x:TypeArguments="x:String">
                        <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_95">执行C_代码_更新edi的状态.xaml</Literal>
                      </InArgument>
                    </bfa:InvokeWorkflow.WorkflowPath>
                  </bfa:InvokeWorkflow>
                </Sequence>
              </bfa:If.Then>
              <bfa:If.Else>
                <Sequence sap2010:Annotation.AnnotationText="发送预警邮件" DisplayName="序列 - 失败后处理" sap:VirtualizedContainerService.HintSize="200,78" sap2010:WorkflowViewState.IdRef="Sequence_17">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 邮件主题 - EDI FAILED" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_18" IsIgnore="False">
                    <bfa:Assign.To>
                      <OutArgument x:TypeArguments="x:String">
                        <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_25">[邮件主题]</mca:CSharpReference>
                      </OutArgument>
                    </bfa:Assign.To>
                    <bfa:Assign.Value>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_110">["!!!雀巢EDI执行失败"]</mca:CSharpValue>
                      </InArgument>
                    </bfa:Assign.Value>
                  </bfa:Assign>
                  <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 邮件正文 - EDI FAILED" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_19" IsIgnore="False">
                    <bfa:Assign.To>
                      <OutArgument x:TypeArguments="x:String">
                        <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_26">[邮件正文]</mca:CSharpReference>
                      </OutArgument>
                    </bfa:Assign.To>
                    <bfa:Assign.Value>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_111">[String.Format(邮件正文模板失败, ediMessage)]</mca:CSharpValue>
                      </InArgument>
                    </bfa:Assign.Value>
                  </bfa:Assign>
                  <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行流程 : 执行C_代码_更新edi的状态 - EDI FAILED" sap:VirtualizedContainerService.HintSize="349,96" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_14" IsIgnore="False">
                    <bfa:InvokeWorkflow.Arguments>
                      <InArgument x:TypeArguments="x:String" x:Key="sqlConn">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_128">[System.Convert.ToString(数据库连接)]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="sd:DataTable" x:Key="allToDoEx2oDT">
                        <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_129">[allToDoEx2oDT]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="x:Boolean" x:Key="ediStatus">
                        <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_130">[ediStatus]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="ediMessage">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_131">[System.Convert.ToString(ediMessage)]</mca:CSharpValue>
                      </InArgument>
                    </bfa:InvokeWorkflow.Arguments>
                    <bfa:InvokeWorkflow.WorkflowPath>
                      <InArgument x:TypeArguments="x:String">
                        <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_33">执行C_代码_更新edi的状态.xaml</Literal>
                      </InArgument>
                    </bfa:InvokeWorkflow.WorkflowPath>
                  </bfa:InvokeWorkflow>
                  <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="调用子流程: 发送邮件 - EDI FAILED" sap:VirtualizedContainerService.HintSize="349,96" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_15" IsIgnore="False">
                    <bfa:InvokeWorkflow.Arguments>
                      <InArgument x:TypeArguments="scg:List(x:String)" x:Key="附件">
                        <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_132">[new List&lt;string&gt;{}]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="邮件正文">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_133">[System.Convert.ToString(邮件正文)]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="邮件主题">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_134">[System.Convert.ToString(邮件主题)]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="收件人">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_135">[System.Convert.ToString(ediMailReceiver)]</mca:CSharpValue>
                      </InArgument>
                    </bfa:InvokeWorkflow.Arguments>
                    <bfa:InvokeWorkflow.WorkflowPath>
                      <InArgument x:TypeArguments="x:String">
                        <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_34">发送邮件.xaml</Literal>
                      </InArgument>
                    </bfa:InvokeWorkflow.WorkflowPath>
                  </bfa:InvokeWorkflow>
                </Sequence>
              </bfa:If.Else>
            </bfa:If>
          </Sequence>
        </bfa:TryCatch.Try>
        <bfa:TryCatch.Catches>
          <bfa:Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="676,23" sap2010:WorkflowViewState.IdRef="Catch`1_1">
            <bfa:Catch.Action>
              <ActivityAction x:TypeArguments="s:Exception">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                </ActivityAction.Argument>
                <Sequence sap2010:Annotation.AnnotationText="发送预警邮件" DisplayName="序列 - 失败后处理" sap:VirtualizedContainerService.HintSize="371,503" sap2010:WorkflowViewState.IdRef="Sequence_14">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 邮件主题 - EDI FAILED" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_20" IsIgnore="False">
                    <bfa:Assign.To>
                      <OutArgument x:TypeArguments="x:String">
                        <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_27">[邮件主题]</mca:CSharpReference>
                      </OutArgument>
                    </bfa:Assign.To>
                    <bfa:Assign.Value>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_112">["!!!雀巢EDI执行失败"]</mca:CSharpValue>
                      </InArgument>
                    </bfa:Assign.Value>
                  </bfa:Assign>
                  <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 邮件正文 - EDI FAILED" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_21" IsIgnore="False">
                    <bfa:Assign.To>
                      <OutArgument x:TypeArguments="x:String">
                        <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_28">[邮件正文]</mca:CSharpReference>
                      </OutArgument>
                    </bfa:Assign.To>
                    <bfa:Assign.Value>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_113">[String.Format(邮件正文模板失败, exception.Message)]</mca:CSharpValue>
                      </InArgument>
                    </bfa:Assign.Value>
                  </bfa:Assign>
                  <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="调用子流程: 发送邮件 - EDI FAILED" sap:VirtualizedContainerService.HintSize="349,96" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_17" IsIgnore="False">
                    <bfa:InvokeWorkflow.Arguments>
                      <InArgument x:TypeArguments="scg:List(x:String)" x:Key="附件">
                        <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_140">[new List&lt;string&gt;{}]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="邮件正文">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_141">[System.Convert.ToString(邮件正文)]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="邮件主题">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_142">[System.Convert.ToString(邮件主题)]</mca:CSharpValue>
                      </InArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="收件人">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_153">[string.IsNullOrEmpty(ediMailReceiver) ? dev_email : ediMailReceiver]</mca:CSharpValue>
                      </InArgument>
                    </bfa:InvokeWorkflow.Arguments>
                    <bfa:InvokeWorkflow.WorkflowPath>
                      <InArgument x:TypeArguments="x:String">
                        <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_36">发送邮件.xaml</Literal>
                      </InArgument>
                    </bfa:InvokeWorkflow.WorkflowPath>
                  </bfa:InvokeWorkflow>
                  <bfa:Throw DisplayName="抛出异常 - 出错抛异常" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="Throw_5">
                    <InArgument x:TypeArguments="s:Exception">
                      <mca:CSharpValue x:TypeArguments="s:Exception" sap2010:WorkflowViewState.IdRef="CSharpValue`1_154">[new Exception("雀巢EDI运行失败！，错误信息：" + exception.Message)]</mca:CSharpValue>
                    </InArgument>
                  </bfa:Throw>
                </Sequence>
              </ActivityAction>
            </bfa:Catch.Action>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </bfa:Catch>
        </bfa:TryCatch.Catches>
      </bfa:TryCatch>
    </FlowStep>
  </Flowchart>
</Activity>