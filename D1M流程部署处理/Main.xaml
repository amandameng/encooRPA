<Activity mc:Ignorable="sap sap2010 sads" x:Class="EncooWorkflow.Main" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:baast="clr-namespace:BotTime.ActivityLibrary.Activities.System.Tool;assembly=BotTime.ActivityLibrary" xmlns:bda="clr-namespace:BotTime.DataTableActivity.Activities;assembly=BotTime.DataTableActivity" xmlns:bda1="clr-namespace:BotTime.DataBase.Activity;assembly=BotTime.DataBase.Activity" xmlns:bfa="clr-namespace:BotTime.Flow.Activities;assembly=BotTime.Flow.Activities" xmlns:boa="clr-namespace:BotTime.Office.Activity;assembly=BotTime.Office.Activity" xmlns:ecaac="clr-namespace:Encoo.CodeTool.Activity.Activities.Collection;assembly=Encoo.CodeTool.Activity" xmlns:ecaac1="clr-namespace:Encoo.CodeTool.Activity.Activities.CSharp;assembly=Encoo.CodeTool.Activity" xmlns:mca="clr-namespace:Microsoft.CSharp.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:this="clr-namespace:EncooWorkflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:sads="http://schemas.microsoft.com/netfx/2010/xaml/activities/debugger">
  <x:Members>
    <x:Property Name="流程部署mapping文件" Type="InArgument(x:String)" />
    <x:Property Name="平台名称" Type="InArgument(x:String)" />
    <x:Property Name="流程配置目录" Type="InArgument(x:String)" />
    <x:Property Name="yunweiSqlConn" Type="InArgument(x:String)" />
    <x:Property Name="客户名称" Type="InArgument(x:String)" />
  </x:Members>
  <this:Main.流程部署mapping文件>
    <InArgument x:TypeArguments="x:String">
      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_37">D:\RPA客户\D1M\D1M-workFlowItemDT.xlsx</Literal>
    </InArgument>
  </this:Main.流程部署mapping文件>
  <this:Main.平台名称>
    <InArgument x:TypeArguments="x:String">
      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_7">生意参谋</Literal>
    </InArgument>
  </this:Main.平台名称>
  <this:Main.流程配置目录>
    <InArgument x:TypeArguments="x:String">
      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_36">D:\RPA客户\D1M\生意方舟配置\所有一级类目和店铺排行和竞店</Literal>
    </InArgument>
  </this:Main.流程配置目录>
  <this:Main.yunweiSqlConn>
    <InArgument x:TypeArguments="x:String">
      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_9">Server=mid.apps.encoo.com;Database=syfz_op_service;Port=3306;Uid=admin;Pwd=encoo123;</Literal>
    </InArgument>
  </this:Main.yunweiSqlConn>
  <this:Main.客户名称>
    <InArgument x:TypeArguments="x:String">
      <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_24">D1M</Literal>
    </InArgument>
  </this:Main.客户名称>
  <sap2010:ExpressionActivityEditor.ExpressionActivityEditor>C#</sap2010:ExpressionActivityEditor.ExpressionActivityEditor>
  <sap:VirtualizedContainerService.HintSize>654,814</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>EncooWorkflow.Workflow_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="15">
      <x:String>System</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>BotTime.Flow.Activities</x:String>
      <x:String>BotTime.Office.Activity</x:String>
      <x:String>Encoo.CodeTool.Activity.Activities.CSharp</x:String>
      <x:String>Microsoft.CSharp.Activities</x:String>
      <x:String>BotTime.DataTableActivity.Activities</x:String>
      <x:String>System.IO</x:String>
      <x:String>BotTime.DataBase.Activity</x:String>
      <x:String>Encoo.CodeTool.Activity.Activities.Collection</x:String>
      <x:String>BotTime.ActivityLibrary.Activities.System.Tool</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>netstandard</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>BotTime.Office.Activity</AssemblyReference>
      <AssemblyReference>Encoo.CodeTool.Activity</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>BotTime.Flow.Activities</AssemblyReference>
      <AssemblyReference>BotTime.DataTableActivity</AssemblyReference>
      <AssemblyReference>ParallelExtensionsExtras</AssemblyReference>
      <AssemblyReference>BotTime.DataBase.Activity</AssemblyReference>
      <AssemblyReference>BotTime.ActivityLibrary</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.Globalization.Extensions</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.Net.WebSockets.Client.Managed</AssemblyReference>
      <AssemblyReference>System.Memory.Data</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <Flowchart DisplayName="流程图_Root" sap:VirtualizedContainerService.HintSize="614,734" sap2010:WorkflowViewState.IdRef="Flowchart_1">
    <Flowchart.Variables>
      <Variable x:TypeArguments="sd:DataTable" Name="dtTable_Config" />
      <Variable x:TypeArguments="sd:DataTable" Name="workflowMappingDT" />
      <Variable x:TypeArguments="scg:List(x:String)" Name="errorMsgList">
        <Variable.Default>
          <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_8">new List&lt;string&gt;{}</mca:CSharpValue>
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="sd:DataTable" Name="tbCategoryDT" />
      <Variable x:TypeArguments="x:String" Name="平台ID" />
    </Flowchart.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
        <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
        <av:Size x:Key="ShapeSize">80,48</av:Size>
        <av:PointCollection x:Key="ConnectorLocation">310,50.5 310,80.5 0,80.5 0,343.5 330,343.5 330,373.5</av:PointCollection>
        <x:Double x:Key="Height">697.5</x:Double>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart.StartNode>
      <x:Reference>__ReferenceID2</x:Reference>
    </Flowchart.StartNode>
    <FlowStep sap2010:WorkflowViewState.IdRef="FlowStep_5">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">200,253.5</av:Point>
          <av:Size x:Key="ShapeSize">200,53</av:Size>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="调用子流程: 获取配置模板及其他信息" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_1" IsIgnore="False">
        <bfa:InvokeWorkflow.Arguments>
          <scg:Dictionary x:TypeArguments="x:String, Argument" />
        </bfa:InvokeWorkflow.Arguments>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <bfa:InvokeWorkflow.WorkflowPath>
          <InArgument x:TypeArguments="x:String">
            <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_5">获取配置模板及其他信息.xaml</Literal>
          </InArgument>
        </bfa:InvokeWorkflow.WorkflowPath>
      </bfa:InvokeWorkflow>
    </FlowStep>
    <FlowStep x:Name="__ReferenceID0" sap2010:WorkflowViewState.IdRef="FlowStep_1">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">230,463.5</av:Point>
          <av:Size x:Key="ShapeSize">200,53</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">330,516.5 330,556.5</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <boa:OfficeExcelOpenOrCreateActivity OfficeVersion="{x:Null}" Password="{x:Null}" SaveAs="{x:Null}" ActivityName="打开/新建" AutoSave="True" ContinueOnError="No" CreateNewFile="False" DelayAfter="0" DelayBefore="0" DisplayName="打开 - 流程部署mapping文件" EnableMacro="False" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="OfficeExcelOpenOrCreateActivity_2" MultiEngineType="NoOffice" ReadOnly="False" Visible="False" needRestoreKey="False">
        <boa:OfficeExcelOpenOrCreateActivity.Body>
          <ActivityAction x:TypeArguments="x:Object">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="x:Object" Name="XlWorkbook" />
            </ActivityAction.Argument>
            <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="806,6237" sap2010:WorkflowViewState.IdRef="Sequence_3">
              <Sequence.Variables>
                <Variable x:TypeArguments="x:String" Name="remote程配置路径" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <boa:OfficeExcelReadRangeActivity Range="{x:Null}" ActivityName="读取区域" AddHeaders="True" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="读取区域" sap:VirtualizedContainerService.HintSize="784,129" sap2010:WorkflowViewState.IdRef="OfficeExcelReadRangeActivity_2" PreserveFormat="False" RepeatedColumn="False" UseFilter="False">
                <boa:OfficeExcelReadRangeActivity.Data>
                  <OutArgument x:TypeArguments="sd:DataTable">
                    <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_2">workflowMappingDT</mca:CSharpReference>
                  </OutArgument>
                </boa:OfficeExcelReadRangeActivity.Data>
                <boa:OfficeExcelReadRangeActivity.SheetName>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_3">System.Convert.ToString(平台名称)</mca:CSharpValue>
                  </InArgument>
                </boa:OfficeExcelReadRangeActivity.SheetName>
              </boa:OfficeExcelReadRangeActivity>
              <bda:DataTableAddColumnActivity DataColumn="{x:Null}" DefaultValue="{x:Null}" MaxLength="{x:Null}" TargetIndex="{x:Null}" ActivityName="添加数据列" AllowDBNull="True" AutoIncrement="False" ContinueOnError="No" DataType="x:String" DelayAfter="0" DelayBefore="0" DisplayName="添加数据列 - 类目ID" sap:VirtualizedContainerService.HintSize="784,22" sap2010:WorkflowViewState.IdRef="DataTableAddColumnActivity_1" Unique="False">
                <bda:DataTableAddColumnActivity.ColumnName>
                  <InArgument x:TypeArguments="x:String">
                    <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_15">类目id</Literal>
                  </InArgument>
                </bda:DataTableAddColumnActivity.ColumnName>
                <bda:DataTableAddColumnActivity.DataTable>
                  <InArgument x:TypeArguments="sd:DataTable">
                    <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_17">workflowMappingDT</mca:CSharpValue>
                  </InArgument>
                </bda:DataTableAddColumnActivity.DataTable>
              </bda:DataTableAddColumnActivity>
              <bda:ForEach CurrentIndex="{x:Null}" ActivityName="遍历行" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="遍历行" sap:VirtualizedContainerService.HintSize="784,5730" sap2010:WorkflowViewState.IdRef="ForEach_1">
                <bda:ForEach.DataTable>
                  <InArgument x:TypeArguments="sd:DataTable">
                    <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_4">workflowMappingDT</mca:CSharpValue>
                  </InArgument>
                </bda:ForEach.DataTable>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ActivityAction x:TypeArguments="sd:DataRow">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                  </ActivityAction.Argument>
                  <bfa:TryCatch ActivityName="错误捕获（Try Catch）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="错误捕获（Try Catch）" sap:VirtualizedContainerService.HintSize="768,5543" sap2010:WorkflowViewState.IdRef="TryCatch_1" IsIgnore="False">
                    <bfa:TryCatch.Variables>
                      <Variable x:TypeArguments="x:String" Name="流程部署ID" />
                    </bfa:TryCatch.Variables>
                    <bfa:TryCatch.Try>
                      <Sequence DisplayName="序列 - 流程部署遍历行" sap:VirtualizedContainerService.HintSize="750,5306" sap2010:WorkflowViewState.IdRef="Sequence_4">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="x:String" Name="本地配置文件" />
                          <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="moduleConfigDic" />
                          <Variable x:TypeArguments="sd:DataRow" Name="dtRow_ProjectConfig" />
                          <Variable x:TypeArguments="scg:List(x:String)" Name="类目idlist">
                            <Variable.Default>
                              <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_18">new List&lt;string&gt;{}</mca:CSharpValue>
                            </Variable.Default>
                          </Variable>
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 流程配置路径" sap:VirtualizedContainerService.HintSize="728,58" sap2010:WorkflowViewState.IdRef="Assign_1" IsIgnore="False">
                          <bfa:Assign.To>
                            <OutArgument x:TypeArguments="x:String">
                              <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_7">remote程配置路径</mca:CSharpReference>
                            </OutArgument>
                          </bfa:Assign.To>
                          <bfa:Assign.Value>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_11">row["流程配置路径"].ToString()</mca:CSharpValue>
                            </InArgument>
                          </bfa:Assign.Value>
                        </bfa:Assign>
                        <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 流程部署ID" sap:VirtualizedContainerService.HintSize="728,58" sap2010:WorkflowViewState.IdRef="Assign_3" IsIgnore="False">
                          <bfa:Assign.To>
                            <OutArgument x:TypeArguments="x:String">
                              <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_11">流程部署ID</mca:CSharpReference>
                            </OutArgument>
                          </bfa:Assign.To>
                          <bfa:Assign.Value>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_19">row["Id"].ToString()</mca:CSharpValue>
                            </InArgument>
                          </bfa:Assign.Value>
                        </bfa:Assign>
                        <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="调用子流程: 匹配配置文件" sap:VirtualizedContainerService.HintSize="728,96" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_2" IsIgnore="False">
                          <bfa:InvokeWorkflow.Arguments>
                            <InArgument x:TypeArguments="x:String" x:Key="流程配置目录">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_5">System.Convert.ToString(流程配置目录)</mca:CSharpValue>
                            </InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="remote流程配置路径">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_6">System.Convert.ToString(remote程配置路径)</mca:CSharpValue>
                            </InArgument>
                            <OutArgument x:TypeArguments="x:String" x:Key="本地配置文件">
                              <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_3">本地配置文件</mca:CSharpReference>
                            </OutArgument>
                          </bfa:InvokeWorkflow.Arguments>
                          <bfa:InvokeWorkflow.WorkflowPath>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_11">匹配配置文件.xaml</Literal>
                            </InArgument>
                          </bfa:InvokeWorkflow.WorkflowPath>
                        </bfa:InvokeWorkflow>
                        <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 本地配置文件 存在）" sap:VirtualizedContainerService.HintSize="728,4850" sap2010:WorkflowViewState.IdRef="If_1" IsIgnore="False">
                          <bfa:If.Condition>
                            <InArgument x:TypeArguments="x:Boolean">
                              <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_12">!string.IsNullOrEmpty(本地配置文件)</mca:CSharpValue>
                            </InArgument>
                          </bfa:If.Condition>
                          <bfa:If.Then>
                            <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="710,4662" sap2010:WorkflowViewState.IdRef="Sequence_5">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="调用子流程: 配置文件转换输出" sap:VirtualizedContainerService.HintSize="688,96" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_3" IsIgnore="False">
                                <bfa:InvokeWorkflow.Arguments>
                                  <InArgument x:TypeArguments="x:String" x:Key="configFilePath">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_7">System.Convert.ToString(本地配置文件)</mca:CSharpValue>
                                  </InArgument>
                                  <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="moduleConfigDic">
                                    <mca:CSharpReference x:TypeArguments="scg:Dictionary(x:String, x:String)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_4">moduleConfigDic</mca:CSharpReference>
                                  </OutArgument>
                                  <OutArgument x:TypeArguments="sd:DataRow" x:Key="dtRow_ProjectConfig">
                                    <mca:CSharpReference x:TypeArguments="sd:DataRow" sap2010:WorkflowViewState.IdRef="CSharpReference`1_5">dtRow_ProjectConfig</mca:CSharpReference>
                                  </OutArgument>
                                </bfa:InvokeWorkflow.Arguments>
                                <bfa:InvokeWorkflow.WorkflowPath>
                                  <InArgument x:TypeArguments="x:String">
                                    <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_12">配置文件转换输出.xaml</Literal>
                                  </InArgument>
                                </bfa:InvokeWorkflow.WorkflowPath>
                              </bfa:InvokeWorkflow>
                              <bda1:DatabaseConnectActivity ActivityName="连接数据库" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="连接数据库 - 查看workFlow在运维平台是否存在，不存在需要新建" sap:VirtualizedContainerService.HintSize="688,2751" sap2010:WorkflowViewState.IdRef="DatabaseConnectActivity_4" ProviderName="MySql">
                                <bda1:DatabaseConnectActivity.Body>
                                  <ActivityAction x:TypeArguments="x:Object">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="x:Object" Name="DataBaseScope" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="674,2643" sap2010:WorkflowViewState.IdRef="Sequence_15">
                                      <Sequence.Variables>
                                        <Variable x:TypeArguments="x:Int32" Name="affectedRow" />
                                        <Variable x:TypeArguments="sd:DataTable" Name="tbWorkFlowDT" />
                                      </Sequence.Variables>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <bda1:QueryTableActivity ActivityName="查询语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - 运维平台流程部署" sap:VirtualizedContainerService.HintSize="652,22" sap2010:WorkflowViewState.IdRef="QueryTableActivity_4">
                                        <bda1:QueryTableActivity.DataTable>
                                          <OutArgument x:TypeArguments="sd:DataTable">
                                            <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_15">tbWorkFlowDT</mca:CSharpReference>
                                          </OutArgument>
                                        </bda1:QueryTableActivity.DataTable>
                                        <bda1:QueryTableActivity.ExecuteTimeOut>
                                          <InArgument x:TypeArguments="x:TimeSpan">
                                            <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_25" Value="00:00:30" />
                                          </InArgument>
                                        </bda1:QueryTableActivity.ExecuteTimeOut>
                                        <bda1:QueryTableActivity.Sql>
                                          <InArgument x:TypeArguments="x:String">
                                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_36">System.Convert.ToString(string.Format("select * from tb_workflow where id='{0}'", 流程部署ID))</mca:CSharpValue>
                                          </InArgument>
                                        </bda1:QueryTableActivity.Sql>
                                      </bda1:QueryTableActivity>
                                      <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 未查到，则新建）" sap:VirtualizedContainerService.HintSize="652,2457" sap2010:WorkflowViewState.IdRef="If_6" IsIgnore="False">
                                        <bfa:If.Condition>
                                          <InArgument x:TypeArguments="x:Boolean">
                                            <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_37">tbWorkFlowDT.Rows.Count == 0</mca:CSharpValue>
                                          </InArgument>
                                        </bfa:If.Condition>
                                        <bfa:If.Then>
                                          <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="634,2269" sap2010:WorkflowViewState.IdRef="Sequence_11">
                                            <Sequence.Variables>
                                              <Variable x:TypeArguments="sd:DataTable" Name="tbShopDT" />
                                            </Sequence.Variables>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <bda1:QueryTableActivity ActivityName="查询语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - shop" sap:VirtualizedContainerService.HintSize="612,22" sap2010:WorkflowViewState.IdRef="QueryTableActivity_15">
                                              <bda1:QueryTableActivity.DataTable>
                                                <OutArgument x:TypeArguments="sd:DataTable">
                                                  <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_25">tbShopDT</mca:CSharpReference>
                                                </OutArgument>
                                              </bda1:QueryTableActivity.DataTable>
                                              <bda1:QueryTableActivity.ExecuteTimeOut>
                                                <InArgument x:TypeArguments="x:TimeSpan">
                                                  <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_34" Value="00:00:30" />
                                                </InArgument>
                                              </bda1:QueryTableActivity.ExecuteTimeOut>
                                              <bda1:QueryTableActivity.Sql>
                                                <InArgument x:TypeArguments="x:String">
                                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_68" xml:space="preserve">string.Format(@"SELECT * FROM syfz_op_service.tb_shop where tenant_id in (select id from tb_tenant where tenant_name='{0}') 
and platform_id='{1}'
and shop_name='{2}'", 客户名称, 平台ID, row["店铺名"].ToString() )</mca:CSharpValue>
                                                </InArgument>
                                              </bda1:QueryTableActivity.Sql>
                                            </bda1:QueryTableActivity>
                                            <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If）" sap:VirtualizedContainerService.HintSize="612,2083" sap2010:WorkflowViewState.IdRef="If_7" IsIgnore="False">
                                              <bfa:If.Condition>
                                                <InArgument x:TypeArguments="x:Boolean">
                                                  <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_39">tbShopDT.Rows.Count &gt; 0</mca:CSharpValue>
                                                </InArgument>
                                              </bfa:If.Condition>
                                              <bfa:If.Then>
                                                <Sequence DisplayName="序列 - 店铺存在后处理" sap:VirtualizedContainerService.HintSize="594,1895" sap2010:WorkflowViewState.IdRef="Sequence_12">
                                                  <Sequence.Variables>
                                                    <Variable x:TypeArguments="scg:List(x:String)" Name="moduleIdList">
                                                      <Variable.Default>
                                                        <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_50">new List&lt;string&gt;{}</mca:CSharpValue>
                                                      </Variable.Default>
                                                    </Variable>
                                                    <Variable x:TypeArguments="x:String" Name="insertWorkFlowSql" />
                                                  </Sequence.Variables>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <bfa:ForEach x:TypeArguments="scg:KeyValuePair(x:String, x:String)" CurrentIndex="{x:Null}" ActivityName="循环操作（For Each）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="循环操作（For Each）" sap:VirtualizedContainerService.HintSize="572,1513" sap2010:WorkflowViewState.IdRef="ForEach`1_2" IsIgnore="False">
                                                    <bfa:ForEach.Values>
                                                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)">
                                                        <mca:CSharpValue x:TypeArguments="scg:Dictionary(x:String, x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_40">moduleConfigDic</mca:CSharpValue>
                                                      </InArgument>
                                                    </bfa:ForEach.Values>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ActivityAction x:TypeArguments="scg:KeyValuePair(x:String, x:String)">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="scg:KeyValuePair(x:String, x:String)" Name="item" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="序列 - 遍历功能模块" sap:VirtualizedContainerService.HintSize="556,1408" sap2010:WorkflowViewState.IdRef="Sequence_13">
                                                        <Sequence.Variables>
                                                          <Variable x:TypeArguments="sd:DataTable" Name="moduleTemplateDT" />
                                                        </Sequence.Variables>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件 If 是类目就跳过" sap:VirtualizedContainerService.HintSize="534,282" sap2010:WorkflowViewState.IdRef="If_8" IsIgnore="False">
                                                          <bfa:If.Condition>
                                                            <InArgument x:TypeArguments="x:Boolean">
                                                              <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_43">item.Key == "类目"</mca:CSharpValue>
                                                            </InArgument>
                                                          </bfa:If.Condition>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <bfa:If.Then>
                                                            <bfa:Continue ContinueAction="{x:Null}" ActivityName="继续循环" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="继续循环" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_1" IsIgnore="False" />
                                                          </bfa:If.Then>
                                                        </bfa:If>
                                                        <baast:LogActivity ActivityName="写入日志" sap2010:Annotation.AnnotationText="根据module_name和平台id查模板id" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志 - 查模板id" sap:VirtualizedContainerService.HintSize="534,83" sap2010:WorkflowViewState.IdRef="LogActivity_6" Level="Info">
                                                          <baast:LogActivity.LogContent>
                                                            <InArgument x:TypeArguments="x:String">
                                                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_70">System.Convert.ToString(string.Format("select * from tb_module_template where platform_id ='{0}' and module_name ='{1}'", 平台ID, item.Key.Contains("|") ? item.Key.Split('|')[1] : item.Key))</mca:CSharpValue>
                                                            </InArgument>
                                                          </baast:LogActivity.LogContent>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </baast:LogActivity>
                                                        <bda1:QueryTableActivity ActivityName="查询语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - 查询module_template" sap:VirtualizedContainerService.HintSize="534,22" sap2010:WorkflowViewState.IdRef="QueryTableActivity_9">
                                                          <bda1:QueryTableActivity.DataTable>
                                                            <OutArgument x:TypeArguments="sd:DataTable">
                                                              <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_17">moduleTemplateDT</mca:CSharpReference>
                                                            </OutArgument>
                                                          </bda1:QueryTableActivity.DataTable>
                                                          <bda1:QueryTableActivity.ExecuteTimeOut>
                                                            <InArgument x:TypeArguments="x:TimeSpan">
                                                              <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_27" Value="00:00:30" />
                                                            </InArgument>
                                                          </bda1:QueryTableActivity.ExecuteTimeOut>
                                                          <bda1:QueryTableActivity.Sql>
                                                            <InArgument x:TypeArguments="x:String">
                                                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_71">System.Convert.ToString(string.Format("select * from tb_module_template where platform_id ='{0}' and module_name ='{1}'", 平台ID, item.Key.Contains("|") ? item.Key.Split('|')[1] : item.Key))</mca:CSharpValue>
                                                            </InArgument>
                                                          </bda1:QueryTableActivity.Sql>
                                                        </bda1:QueryTableActivity>
                                                        <bfa:If ActivityName="条件（If）" sap2010:Annotation.AnnotationText="插入tb module config" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If）" sap:VirtualizedContainerService.HintSize="534,777" sap2010:WorkflowViewState.IdRef="If_9" IsIgnore="False">
                                                          <bfa:If.Condition>
                                                            <InArgument x:TypeArguments="x:Boolean">
                                                              <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_46">moduleTemplateDT.Rows.Count &gt;= 0</mca:CSharpValue>
                                                            </InArgument>
                                                          </bfa:If.Condition>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <bfa:If.Then>
                                                            <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,564" sap2010:WorkflowViewState.IdRef="Sequence_14">
                                                              <Sequence.Variables>
                                                                <Variable x:TypeArguments="sd:DataTable" Name="tbModuleConfigDT" />
                                                                <Variable x:TypeArguments="x:String" Name="moduleInsertSql" />
                                                              </Sequence.Variables>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - moduleInsertSql" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_7" IsIgnore="False">
                                                                <bfa:Assign.To>
                                                                  <OutArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_22">moduleInsertSql</mca:CSharpReference>
                                                                  </OutArgument>
                                                                </bfa:Assign.To>
                                                                <bfa:Assign.Value>
                                                                  <InArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_63" xml:space="preserve">[string.Format(@"INSERT INTO tb_module_config(`shop_id`, `module_template_id`, `module_config_json`, `module_config_name`)
VALUES ('{0}', '{1}', '{2}', '{3}')", tbShopDT.Rows[0]["id"].ToString(), moduleTemplateDT.Rows[0]["id"].ToString(), item.Value.Replace(@"""", @"\""").Replace("\\\\", "\\\\\\\\"), row["店铺名"].ToString() + "_" + item.Key.Replace("|", "_"))]</mca:CSharpValue>
                                                                  </InArgument>
                                                                </bfa:Assign.Value>
                                                              </bfa:Assign>
                                                              <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志 - 插入module config" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_8" Level="Info">
                                                                <baast:LogActivity.LogContent>
                                                                  <InArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_64">System.Convert.ToString(moduleInsertSql)</mca:CSharpValue>
                                                                  </InArgument>
                                                                </baast:LogActivity.LogContent>
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                              </baast:LogActivity>
                                                              <bda1:ExecuteSqlActivity ActivityName="执行语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行语句 - 插入module config" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="ExecuteSqlActivity_3">
                                                                <bda1:ExecuteSqlActivity.AffectedRows>
                                                                  <OutArgument x:TypeArguments="x:Int32">
                                                                    <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_18">affectedRow</mca:CSharpReference>
                                                                  </OutArgument>
                                                                </bda1:ExecuteSqlActivity.AffectedRows>
                                                                <bda1:ExecuteSqlActivity.ExecuteTimeOut>
                                                                  <InArgument x:TypeArguments="x:TimeSpan">
                                                                    <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_28" Value="00:00:30" />
                                                                  </InArgument>
                                                                </bda1:ExecuteSqlActivity.ExecuteTimeOut>
                                                                <bda1:ExecuteSqlActivity.Sql>
                                                                  <InArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_65" xml:space="preserve">[System.Convert.ToString(string.Format(@"INSERT INTO tb_module_config(`shop_id`, `module_template_id`, `module_config_json`, `module_config_name`)
VALUES ('{0}', '{1}', '{2}', '{3}')", tbShopDT.Rows[0]["id"].ToString(), moduleTemplateDT.Rows[0]["id"].ToString(), item.Value.Replace(@"""", @"\""").Replace("\\\\", "\\\\\\\\"), row["店铺名"].ToString() + "_" + item.Key.Replace("|", "_")))]</mca:CSharpValue>
                                                                  </InArgument>
                                                                </bda1:ExecuteSqlActivity.Sql>
                                                              </bda1:ExecuteSqlActivity>
                                                              <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_9" Level="Info">
                                                                <baast:LogActivity.LogContent>
                                                                  <InArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_49">System.Convert.ToString(affectedRow)</mca:CSharpValue>
                                                                  </InArgument>
                                                                </baast:LogActivity.LogContent>
                                                              </baast:LogActivity>
                                                              <bda1:QueryTableActivity ActivityName="查询语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句-重新查询插入的module ID" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="QueryTableActivity_11">
                                                                <bda1:QueryTableActivity.DataTable>
                                                                  <OutArgument x:TypeArguments="sd:DataTable">
                                                                    <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_19">tbModuleConfigDT</mca:CSharpReference>
                                                                  </OutArgument>
                                                                </bda1:QueryTableActivity.DataTable>
                                                                <bda1:QueryTableActivity.ExecuteTimeOut>
                                                                  <InArgument x:TypeArguments="x:TimeSpan">
                                                                    <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_31" Value="00:00:30" />
                                                                  </InArgument>
                                                                </bda1:QueryTableActivity.ExecuteTimeOut>
                                                                <bda1:QueryTableActivity.Sql>
                                                                  <InArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_53">System.Convert.ToString(string.Format(@"select * from tb_module_config where shop_id='{0}' and module_template_id='{1}'", tbShopDT.Rows[0]["id"].ToString(), moduleTemplateDT.Rows[0]["id"].ToString()))</mca:CSharpValue>
                                                                  </InArgument>
                                                                </bda1:QueryTableActivity.Sql>
                                                              </bda1:QueryTableActivity>
                                                              <ecaac:AddToCollectionActivity ActivityName="添加对象" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="添加对象-moduleID" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="AddToCollectionActivity_3">
                                                                <ecaac:AddToCollectionActivity.Collection>
                                                                  <InOutArgument x:TypeArguments="scg:List(x:String)">
                                                                    <mca:CSharpReference x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_20">moduleIdList</mca:CSharpReference>
                                                                  </InOutArgument>
                                                                </ecaac:AddToCollectionActivity.Collection>
                                                                <ecaac:AddToCollectionActivity.Item>
                                                                  <InArgument x:TypeArguments="x:String">
                                                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_54">tbModuleConfigDT.Rows[0]["id"].ToString()</mca:CSharpValue>
                                                                  </InArgument>
                                                                </ecaac:AddToCollectionActivity.Item>
                                                              </ecaac:AddToCollectionActivity>
                                                            </Sequence>
                                                          </bfa:If.Then>
                                                        </bfa:If>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </bfa:ForEach>
                                                  <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值" sap:VirtualizedContainerService.HintSize="572,58" sap2010:WorkflowViewState.IdRef="Assign_8" IsIgnore="False">
                                                    <bfa:Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">
                                                        <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_21">insertWorkFlowSql</mca:CSharpReference>
                                                      </OutArgument>
                                                    </bfa:Assign.To>
                                                    <bfa:Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_69" xml:space="preserve">string.Format(@"INSERT INTO tb_workflow (`id`, `shop_id`, `workflow_name`, `statistics_date_type`, `platform_id`, `module_ids`, `is_need_update_category`) 
VALUES ('{0}', '{1}', '{2}', '{3}','{4}', '{5}','{6}')", 流程部署ID, tbShopDT.Rows[0]["id"].ToString(), row["Name"].ToString(), "日", 平台ID, string.Join(",", moduleIdList), 0)</mca:CSharpValue>
                                                      </InArgument>
                                                    </bfa:Assign.Value>
                                                  </bfa:Assign>
                                                  <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志 - 新建流程部署语句" sap:VirtualizedContainerService.HintSize="572,58" sap2010:WorkflowViewState.IdRef="LogActivity_10" Level="Info">
                                                    <baast:LogActivity.LogContent>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_61">System.Convert.ToString(insertWorkFlowSql)</mca:CSharpValue>
                                                      </InArgument>
                                                    </baast:LogActivity.LogContent>
                                                  </baast:LogActivity>
                                                  <bda1:ExecuteSqlActivity AffectedRows="{x:Null}" ActivityName="执行语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行语句 - 新建流程部署" sap:VirtualizedContainerService.HintSize="572,22" sap2010:WorkflowViewState.IdRef="ExecuteSqlActivity_4">
                                                    <bda1:ExecuteSqlActivity.ExecuteTimeOut>
                                                      <InArgument x:TypeArguments="x:TimeSpan">
                                                        <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_30" Value="00:00:30" />
                                                      </InArgument>
                                                    </bda1:ExecuteSqlActivity.ExecuteTimeOut>
                                                    <bda1:ExecuteSqlActivity.Sql>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_62">System.Convert.ToString(insertWorkFlowSql)</mca:CSharpValue>
                                                      </InArgument>
                                                    </bda1:ExecuteSqlActivity.Sql>
                                                  </bda1:ExecuteSqlActivity>
                                                </Sequence>
                                              </bfa:If.Then>
                                            </bfa:If>
                                          </Sequence>
                                        </bfa:If.Then>
                                      </bfa:If>
                                    </Sequence>
                                  </ActivityAction>
                                </bda1:DatabaseConnectActivity.Body>
                                <bda1:DatabaseConnectActivity.ConnectionString>
                                  <InArgument x:TypeArguments="x:String">
                                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_35">System.Convert.ToString(yunweiSqlConn)</mca:CSharpValue>
                                  </InArgument>
                                </bda1:DatabaseConnectActivity.ConnectionString>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </bda1:DatabaseConnectActivity>
                              <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If）" sap:VirtualizedContainerService.HintSize="688,1611" sap2010:WorkflowViewState.IdRef="If_2" IsIgnore="False">
                                <bfa:If.Condition>
                                  <InArgument x:TypeArguments="x:Boolean">
                                    <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_14">dtRow_ProjectConfig != null &amp;&amp; dtRow_ProjectConfig.Table.Columns.Contains("类目")</mca:CSharpValue>
                                  </InArgument>
                                </bfa:If.Condition>
                                <bfa:If.Then>
                                  <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="556,1319" sap2010:WorkflowViewState.IdRef="Sequence_7">
                                    <Sequence.Variables>
                                      <Variable x:TypeArguments="x:Int32" Name="validRowsCount" />
                                    </Sequence.Variables>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ecaac1:InvokeCSharpCodeActivity ActivityName="执行C#代码" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行C#代码 - 根据path查找类目id" sap:VirtualizedContainerService.HintSize="534,93" sap2010:WorkflowViewState.IdRef="InvokeCSharpCodeActivity_4">
                                      <ecaac1:InvokeCSharpCodeActivity.CodeFilePath>
                                        <InArgument x:TypeArguments="x:String">
                                          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_16">.code\CSharp\根据path查找类目id.cs</Literal>
                                        </InArgument>
                                      </ecaac1:InvokeCSharpCodeActivity.CodeFilePath>
                                    </ecaac1:InvokeCSharpCodeActivity>
                                    <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If 类目数量都匹配上，则更新流程部署的类目ID，否则抛错）" sap:VirtualizedContainerService.HintSize="534,1062" sap2010:WorkflowViewState.IdRef="If_4" IsIgnore="False">
                                      <bfa:If.Condition>
                                        <InArgument x:TypeArguments="x:Boolean">
                                          <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_32">类目idlist.Count == validRowsCount</mca:CSharpValue>
                                        </InArgument>
                                      </bfa:If.Condition>
                                      <bfa:If.Then>
                                        <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="471,770" sap2010:WorkflowViewState.IdRef="Sequence_10">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 类目id 行赋值" sap:VirtualizedContainerService.HintSize="449,58" sap2010:WorkflowViewState.IdRef="Assign_4" IsIgnore="False">
                                            <bfa:Assign.To>
                                              <OutArgument x:TypeArguments="x:Object">
                                                <mca:CSharpReference x:TypeArguments="x:Object" sap2010:WorkflowViewState.IdRef="CSharpReference`1_14">row["类目id"]</mca:CSharpReference>
                                              </OutArgument>
                                            </bfa:Assign.To>
                                            <bfa:Assign.Value>
                                              <InArgument x:TypeArguments="x:String">
                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_28">string.Join(",", 类目idlist)</mca:CSharpValue>
                                              </InArgument>
                                            </bfa:Assign.Value>
                                          </bfa:Assign>
                                          <bda1:DatabaseConnectActivity ActivityName="连接数据库" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="连接数据库" sap:VirtualizedContainerService.HintSize="449,548" sap2010:WorkflowViewState.IdRef="DatabaseConnectActivity_2" ProviderName="MySql">
                                            <bda1:DatabaseConnectActivity.Body>
                                              <ActivityAction x:TypeArguments="x:Object">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="x:Object" Name="DataBaseScope" />
                                                </ActivityAction.Argument>
                                                <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,440" sap2010:WorkflowViewState.IdRef="Sequence_9">
                                                  <Sequence.Variables>
                                                    <Variable x:TypeArguments="x:Int32" Name="affectedRow" />
                                                    <Variable x:TypeArguments="x:String" Name="更新类目IDsql" />
                                                  </Sequence.Variables>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 流程部署更新更新类目IDsql" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="Assign_10" IsIgnore="False">
                                                    <bfa:Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">
                                                        <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_26">更新类目IDsql</mca:CSharpReference>
                                                      </OutArgument>
                                                    </bfa:Assign.To>
                                                    <bfa:Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_73">string.Format("update tb_workflow set category_ids='{0}' where id='{1}'", string.Join(",", 类目idlist), 流程部署ID)</mca:CSharpValue>
                                                      </InArgument>
                                                    </bfa:Assign.Value>
                                                  </bfa:Assign>
                                                  <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_3" Level="Info">
                                                    <baast:LogActivity.LogContent>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_74">System.Convert.ToString(更新类目IDsql)</mca:CSharpValue>
                                                      </InArgument>
                                                    </baast:LogActivity.LogContent>
                                                  </baast:LogActivity>
                                                  <bda1:ExecuteSqlActivity ActivityName="执行语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行语句 - 类目为空才更新" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="ExecuteSqlActivity_2">
                                                    <bda1:ExecuteSqlActivity.AffectedRows>
                                                      <OutArgument x:TypeArguments="x:Int32">
                                                        <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_13">affectedRow</mca:CSharpReference>
                                                      </OutArgument>
                                                    </bda1:ExecuteSqlActivity.AffectedRows>
                                                    <bda1:ExecuteSqlActivity.ExecuteTimeOut>
                                                      <InArgument x:TypeArguments="x:TimeSpan">
                                                        <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_17" Value="00:00:30" />
                                                      </InArgument>
                                                    </bda1:ExecuteSqlActivity.ExecuteTimeOut>
                                                    <bda1:ExecuteSqlActivity.Sql>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_75">System.Convert.ToString(更新类目IDsql)</mca:CSharpValue>
                                                      </InArgument>
                                                    </bda1:ExecuteSqlActivity.Sql>
                                                  </bda1:ExecuteSqlActivity>
                                                  <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志 - category_ids" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_2" Level="Info">
                                                    <baast:LogActivity.LogContent>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_25">System.Convert.ToString(affectedRow)</mca:CSharpValue>
                                                      </InArgument>
                                                    </baast:LogActivity.LogContent>
                                                  </baast:LogActivity>
                                                </Sequence>
                                              </ActivityAction>
                                            </bda1:DatabaseConnectActivity.Body>
                                            <bda1:DatabaseConnectActivity.ConnectionString>
                                              <InArgument x:TypeArguments="x:String">
                                                <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_22">System.Convert.ToString(yunweiSqlConn)</mca:CSharpValue>
                                              </InArgument>
                                            </bda1:DatabaseConnectActivity.ConnectionString>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </bda1:DatabaseConnectActivity>
                                        </Sequence>
                                      </bfa:If.Then>
                                    </bfa:If>
                                  </Sequence>
                                </bfa:If.Then>
                              </bfa:If>
                            </Sequence>
                          </bfa:If.Then>
                          <bfa:If.Else>
                            <bfa:Throw DisplayName="抛出异常 - 配置文件不匹配" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_1">
                              <InArgument x:TypeArguments="s:Exception">
                                <mca:CSharpValue x:TypeArguments="s:Exception" sap2010:WorkflowViewState.IdRef="CSharpValue`1_34">new Exception(string.Format("指定配置文件未被找到, {0}", remote程配置路径))</mca:CSharpValue>
                              </InArgument>
                            </bfa:Throw>
                          </bfa:If.Else>
                        </bfa:If>
                      </Sequence>
                    </bfa:TryCatch.Try>
                    <bfa:TryCatch.Catches>
                      <bfa:Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="754,23" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                        <bfa:Catch.Action>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                            <ecaac:AddToCollectionActivity ActivityName="添加对象" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="添加对象" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollectionActivity_2">
                              <ecaac:AddToCollectionActivity.Collection>
                                <InOutArgument x:TypeArguments="scg:List(x:String)">
                                  <mca:CSharpReference x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_12">errorMsgList</mca:CSharpReference>
                                </InOutArgument>
                              </ecaac:AddToCollectionActivity.Collection>
                              <ecaac:AddToCollectionActivity.Item>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_20">string.Format("流程部署ID：{0}，错误消息：{1}", 流程部署ID, exception.Message)</mca:CSharpValue>
                                </InArgument>
                              </ecaac:AddToCollectionActivity.Item>
                            </ecaac:AddToCollectionActivity>
                          </ActivityAction>
                        </bfa:Catch.Action>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </bfa:Catch>
                    </bfa:TryCatch.Catches>
                  </bfa:TryCatch>
                </ActivityAction>
              </bda:ForEach>
              <boa:OfficeExcelSetRangeActivity ActivityName="写入区域" AddHeaders="False" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入区域" sap:VirtualizedContainerService.HintSize="784,112" sap2010:WorkflowViewState.IdRef="OfficeExcelSetRangeActivity_1">
                <boa:OfficeExcelSetRangeActivity.InputDataTable>
                  <InArgument x:TypeArguments="sd:DataTable">
                    <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_27">workflowMappingDT</mca:CSharpValue>
                  </InArgument>
                </boa:OfficeExcelSetRangeActivity.InputDataTable>
                <boa:OfficeExcelSetRangeActivity.SheetName>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_29">System.Convert.ToString(平台名称 + "-更新后")</mca:CSharpValue>
                  </InArgument>
                </boa:OfficeExcelSetRangeActivity.SheetName>
                <boa:OfficeExcelSetRangeActivity.StartCell>
                  <InArgument x:TypeArguments="x:String">
                    <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_18">A1</Literal>
                  </InArgument>
                </boa:OfficeExcelSetRangeActivity.StartCell>
              </boa:OfficeExcelSetRangeActivity>
            </Sequence>
          </ActivityAction>
        </boa:OfficeExcelOpenOrCreateActivity.Body>
        <boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
          <InArgument x:TypeArguments="x:String">
            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_2">System.Convert.ToString(流程部署mapping文件)</mca:CSharpValue>
          </InArgument>
        </boa:OfficeExcelOpenOrCreateActivity.ExcelFile>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </boa:OfficeExcelOpenOrCreateActivity>
      <FlowStep.Next>
        <FlowStep x:Name="__ReferenceID1" sap2010:WorkflowViewState.IdRef="FlowStep_6">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">230,556.5</av:Point>
              <av:Size x:Key="ShapeSize">200,53</av:Size>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="条件（If）" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="If_5" IsIgnore="False">
            <bfa:If.Condition>
              <InArgument x:TypeArguments="x:Boolean">
                <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_30">errorMsgList.Count &gt; 0</mca:CSharpValue>
              </InArgument>
            </bfa:If.Condition>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <bfa:If.Then>
              <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_5" Level="Error">
                <baast:LogActivity.LogContent>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_31" xml:space="preserve">System.Convert.ToString("错误消息：" + string.Join(@"
", errorMsgList))</mca:CSharpValue>
                  </InArgument>
                </baast:LogActivity.LogContent>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </baast:LogActivity>
            </bfa:If.Then>
          </bfa:If>
        </FlowStep>
      </FlowStep.Next>
    </FlowStep>
    <FlowStep x:Name="__ReferenceID2" sap2010:WorkflowViewState.IdRef="FlowStep_2">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">230,373.5</av:Point>
          <av:Size x:Key="ShapeSize">200,53</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">330,426.5 330,463.5</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <bda1:DatabaseConnectActivity ActivityName="连接数据库" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="连接数据库" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="DatabaseConnectActivity_1" ProviderName="MySql">
        <bda1:DatabaseConnectActivity.Body>
          <ActivityAction x:TypeArguments="x:Object">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="x:Object" Name="DataBaseScope" />
            </ActivityAction.Argument>
            <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="345,306" sap2010:WorkflowViewState.IdRef="Sequence_16">
              <Sequence.Variables>
                <Variable x:TypeArguments="sd:DataTable" Name="platformDT" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <bda1:QueryTableActivity ActivityName="查询语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - 查询全部的类目" sap:VirtualizedContainerService.HintSize="323,22" sap2010:WorkflowViewState.IdRef="QueryTableActivity_2">
                <bda1:QueryTableActivity.DataTable>
                  <OutArgument x:TypeArguments="sd:DataTable">
                    <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_10">tbCategoryDT</mca:CSharpReference>
                  </OutArgument>
                </bda1:QueryTableActivity.DataTable>
                <bda1:QueryTableActivity.ExecuteTimeOut>
                  <InArgument x:TypeArguments="x:TimeSpan">
                    <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_14" Value="00:00:30" />
                  </InArgument>
                </bda1:QueryTableActivity.ExecuteTimeOut>
                <bda1:QueryTableActivity.Sql>
                  <InArgument x:TypeArguments="x:String">
                    <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_13">select * from tb_category</Literal>
                  </InArgument>
                </bda1:QueryTableActivity.Sql>
              </bda1:QueryTableActivity>
              <bda1:QueryTableActivity ActivityName="查询语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句 - 平台id" sap:VirtualizedContainerService.HintSize="323,22" sap2010:WorkflowViewState.IdRef="QueryTableActivity_13">
                <bda1:QueryTableActivity.DataTable>
                  <OutArgument x:TypeArguments="sd:DataTable">
                    <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_23">platformDT</mca:CSharpReference>
                  </OutArgument>
                </bda1:QueryTableActivity.DataTable>
                <bda1:QueryTableActivity.ExecuteTimeOut>
                  <InArgument x:TypeArguments="x:TimeSpan">
                    <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_33" Value="00:00:30" />
                  </InArgument>
                </bda1:QueryTableActivity.ExecuteTimeOut>
                <bda1:QueryTableActivity.Sql>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_66">System.Convert.ToString(string.Format("select id from tb_platform where platform_name = '{0}'", 平台名称))</mca:CSharpValue>
                  </InArgument>
                </bda1:QueryTableActivity.Sql>
              </bda1:QueryTableActivity>
              <bfa:Assign ActivityName="赋值" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值 - 平台ID" sap:VirtualizedContainerService.HintSize="323,58" sap2010:WorkflowViewState.IdRef="Assign_9" IsIgnore="False">
                <bfa:Assign.To>
                  <OutArgument x:TypeArguments="x:String">
                    <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_24">平台ID</mca:CSharpReference>
                  </OutArgument>
                </bfa:Assign.To>
                <bfa:Assign.Value>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_67">platformDT.Rows[0]["id"].ToString()</mca:CSharpValue>
                  </InArgument>
                </bfa:Assign.Value>
              </bfa:Assign>
            </Sequence>
          </ActivityAction>
        </bda1:DatabaseConnectActivity.Body>
        <bda1:DatabaseConnectActivity.ConnectionString>
          <InArgument x:TypeArguments="x:String">
            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_9">System.Convert.ToString(yunweiSqlConn)</mca:CSharpValue>
          </InArgument>
        </bda1:DatabaseConnectActivity.ConnectionString>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </bda1:DatabaseConnectActivity>
      <FlowStep.Next>
        <x:Reference>__ReferenceID0</x:Reference>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID1</x:Reference>
  </Flowchart>
</Activity>